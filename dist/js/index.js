var app=angular.module("myApp",["ngRoute"]);app.run(["$rootScope","$location","$http","$timeout","$compile",function(e,a,t,n,i){e.localUserName=a.search().username,e.myaccountId=a.search().userId,e.link="http://"+window.location.host+"/gcschat",e.link1="http://"+window.location.host+"/gcschat",e.imgSrc="",e.DownFile="./快捷回复模板.xls",e.DownFileOut="../gcschat/script/downfile";var s=["[微笑]","[撇嘴]","[色]","[发呆]","[得意]","[流泪]","[害羞]","[闭嘴]","[睡]","[大哭]","[尴尬]","[发怒]","[调皮]","[呲牙]","[惊讶]","[难过]","[酷]","[冷汗]","[抓狂]","[吐]","[偷笑]","[愉快]","[白眼]","[傲慢]","[饥饿]","[困]","[惊恐]","[流汗]","[憨笑]","[悠闲]","[奋斗]","[咒骂]","[疑问]","[嘘]","[晕]","[疯了]","[衰]","[骷髅]","[敲打]","[再见]","[擦汗]","[抠鼻]","[鼓掌]","[糗大了]","[坏笑]","[左哼哼]","[右哼哼]","[哈欠]","[鄙视]","[委屈]","[快哭了]","[阴险]","[亲亲]","[吓]","[可怜]","[菜刀]","[啤酒]","[咖啡]","[饭]","[猪头]","[玫瑰]","[凋谢]","[嘴唇]","[爱心]","[心碎]","[蛋糕]","[闪电]","[炸弹]","[刀]","[足球]","[瓢虫]","[便便]","[拥抱]","[强]","[弱]","[握手]","[胜利]","[抱拳]","[勾引]","[拳头]","[差劲]","[爱你]","[NO]","[OK]","[跳跳]","[发抖]","[怄火]","[磕头]","[激动]","[献吻]"];function d(a,t,n,i){var s=window.Notification||window.mozNotification||window.webkitNotification;if(null==n&&(n="./images/Destroy.png"),t.length>=30&&(t=t.slice(0,"30...")),s)if("granted"===s.permission){var d=new s(a,{body:t,icon:n,data:i});d.onclick=function(a){window.focus(),a.preventDefault();for(var t="",n=!1,i=0;i<e.Chatwithfriends[e.lplplpl].length;i++)if(e.Chatwithfriends[e.lplplpl][i].cid==this.data){t=e.Chatwithfriends[e.lplplpl][i],n=!0;break}1==n&&e.NotificationsChat(t.cid,t.nickName||t.noteName,t.profilePhoto,t.id,t.socialaccountId,t.type,t.topNumber)},setTimeout(function(){d.close()},3e3)}else"denied"!==s.permission&&s.requestPermission(function(d){if("granted"===d){var l=new s(a,{body:t,icon:n,data:i});l.onclick=function(a){window.focus(),a.preventDefault();for(var t="",n=!1,i=0;i<e.Chatwithfriends[e.lplplpl].length;i++)if(e.Chatwithfriends[e.lplplpl][i].cid==this.data){t=e.Chatwithfriends[e.lplplpl][i],n=!0;break}1==n&&e.NotificationsChat(t.cid,t.nickName||t.noteName,t.profilePhoto,t.id,t.socialaccountId,t.type,t.topNumber)},setTimeout(function(){l.close()},3e3)}});else alert("浏览器不支持桌面提醒")}window.addEventListener("beforeunload",function(a){var n=new FormData;n.append("accountname",e.localUserName),t({method:"POST",url:e.link1+"/message/colseGcMessageInfo",data:n,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){});var i="确定离开此页吗？本页不需要刷新或后退";return(a||window.event).returnValue=i,i}),e.Myhead="images/test.jpg",e.chatHead="",e.friendStorage={},e.friendHeader={},e.friendAndGroupStorage=[],e.WeChatowner={},e.WeChatownersocialNumber={},e.WeChatownerHeader={},e.WeChatoMembersNickname={},e.Groupmemberheadlibrary={},e.Wasterecovery={},e.Searchhistory_Chatting=[],e.Searchhistory_Maillist=[];var l=new FormData;l.append("accountId",e.myaccountId),t({method:"POST",url:e.link+"/chatroommember/getAllChatroommemberByUserId",data:l,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){if(200==a.code)for(var t=0;t<a.data.chatroommemberList.length;t++)e.WeChatoMembersNickname[a.data.chatroommemberList[t].chatroomMemberWxid]=a.data.chatroommemberList[t].memberName,e.Groupmemberheadlibrary[a.data.chatroommemberList[t].chatroomMemberWxid]=e.imgSrc+a.data.chatroommemberList[t].profilePhoto}),e.firendList=new FormData,e.firendList.append("accountId",e.myaccountId),e.Chatwithfriends=new Array,e.Chatwithfriends[-1]=[],t({method:"POST",url:e.link+"/latelyChatroom/getRecentContactAndChatroom",data:e.firendList,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){if(200==a.code){for(var t=0;t<a.data.list.length;t++)""==a.data.list[t].profilePhoto&&(a.data.list[t].profilePhoto="./images/Destroy.png");for(var n=0;n<a.data.list.length;n++)if(a.data.list[n].Deviceonline=1,"./images/Destroy.png"==a.data.list[n].profilePhoto||(a.data.list[n].profilePhoto=e.imgSrc+a.data.list[n].profilePhoto),a.data.list[n].noReadMessage=n,e.Chatwithfriends[-1].push(a.data.list[n]),a.data.list[n].lastChatrecord==[]||null==a.data.list[n].lastChatrecord)a.data.list[n].newMessage="";else if(1==a.data.list[n].lastChatrecord.length){var i="";if(1==a.data.list[n].type&&10==a.data.list[n].lastChatrecord[0].msgStatus)if(495==a.data.list[n].lastChatrecord[0].msgType){var s=a.data.list[n].lastChatrecord[0].chatMessage.content;a.data.list[n].lastChatrecord[0].chatMessage.chatroommemberwxid;i=s}else{i=(i=a.data.list[n].lastChatrecord[0].chatMessage).split(":<br>")[1]}else 3==a.data.list[n].lastChatrecord[0].msgType?i="[图片]":495==a.data.list[n].lastChatrecord[0].msgType?i="[图文链接]":1==a.data.list[n].lastChatrecord[0].msgType?i=a.data.list[n].lastChatrecord[0].chatMessage:496==a.data.list[n].lastChatrecord[0].msgType&&(i="[文件]");a.data.list[n].newMessage=i}else for(var d=0;d<a.data.list[n].lastChatrecord.length;d++){i="";if(1==a.data.list[n].type&&10==a.data.list[n].lastChatrecord[d].msgStatus){if(495==a.data.list[n].lastChatrecord[0].msgType){s=a.data.list[n].lastChatrecord[0].chatMessage.content,a.data.list[n].lastChatrecord[0].chatMessage.chatroommemberwxid;i=s}else{i=(i=a.data.list[n].lastChatrecord[0].chatMessage).split(":<br>")[1]}a.data.list[n].newMessage=i}else 3==a.data.list[n].lastChatrecord[d].msgType?i="[图片]":495==a.data.list[n].lastChatrecord[d].msgType?i="[图文链接]":1==a.data.list[n].lastChatrecord[d].msgType?i=a.data.list[n].lastChatrecord[d].chatMessage:496==a.data.list[n].lastChatrecord[d].msgType&&(i="[文件]"),a.data.list[n].newMessage=i}e.frienfList=a.data.list,a.data.sumtop>=1?e.TotopNum=a.data.sumtop-1:e.TotopNum=0}}),e.AutomaticReturnSwitch=!1,e.Initializationofsocialnumbers="",setTimeout(function(){$("#single").multiselect({multiple:!1,selectedHtmlValue:"请选择",setWidth:"148px"})},1500);var r=new FormData;r.append("accountId",e.myaccountId),t({method:"POST",url:e.link+"/socialaccount/getSocialaccount",data:r,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){if(e.$watch(function(){e.Initializationofsocialnumbers=a.data.socialaccountList}),200==a.code){for(var n=[],i=0;i<a.data.socialaccountList.length;i++)n.push(a.data.socialaccountList[i].id);var s=new FormData;s.append("ids",JSON.stringify(n)),s.append("accountId",e.myaccountId),t({method:"POST",url:e.link+"/socialaccount/getChatroomAndContact",data:s,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){if(200==a.code){for(var t=0;t<a.data.contactList.length;t++)""==a.data.contactList[t].profilePhoto?a.data.contactList[t].profilePhoto="./images/Destroy.png":a.data.contactList[t].profilePhoto=e.imgSrc+a.data.contactList[t].profilePhoto,e.friendAndGroupStorage.push(a.data.contactList[t]);for(var n=0;n<a.data.contactList.length;n++){var i=a.data.contactList[n].cid;e.friendHeader[i]=a.data.contactList[n].profilePhoto}}})}}),e.Judgingthesendingmessage=new Array,e.Judgingthesendingmessage1=new Array,e.Judgingthesendingmessage2=new Array,e.Judgingthesendingmessage3=new Array,setTimeout(function a(){var n=new FormData;n.append("accountId",e.myaccountId),t({method:"POST",url:e.link1+"/device/devicesStatus",data:n,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(t){if(200==t.code){e.Judgingthesendingmessage=new Array,e.Judgingthesendingmessage2=new Array,e.QueryequipmentAll=[];for(var n=0,i=0;i<t.data.length;i++)0==t.data[i].deviceStatus?(e.QueryequipmentAll.push(e.WeChatowner[t.data[i].socialaccountId]),e.Judgingthesendingmessage.push(t.data[i].socialaccountId),n++):e.Judgingthesendingmessage2.push(t.data[i].socialaccountId);if(e.Judgingthesendingmessage3==e.Judgingthesendingmessage2);else for(var s=0;s<e.Judgingthesendingmessage2.length;s++){for(var d=0;d<e.Chatwithfriends[e.Judgingthesendingmessage2[s]].length;d++)e.Chatwithfriends[e.Judgingthesendingmessage2[s]][d].Deviceonline=1;for(var l=0;l<e.Chatwithfriends[-1].length;l++)e.Chatwithfriends[-1][l].socialaccountId==e.Judgingthesendingmessage2[s]&&(e.Chatwithfriends[-1][l].Deviceonline=1)}if(e.Judgingthesendingmessage1==e.Judgingthesendingmessage);else for(s=0;s<e.Judgingthesendingmessage.length;s++){for(d=0;d<e.Chatwithfriends[e.Judgingthesendingmessage[s]].length;d++)e.Chatwithfriends[e.Judgingthesendingmessage[s]][d].Deviceonline=0;for(l=0;l<e.Chatwithfriends[-1].length;l++)e.Chatwithfriends[-1][l].socialaccountId==e.Judgingthesendingmessage[s]&&(e.Chatwithfriends[-1][l].Deviceonline=0)}e.Judgingthesendingmessage1=e.Judgingthesendingmessage,e.Judgingthesendingmessage3=e.Judgingthesendingmessage2,0==n?$(".querystate").css("display","none"):$(".querystate").css("display","block"),setTimeout(function(){a()},1e4)}else setTimeout(function(){a()},1e4)})},5e3),e.panduankuli=!1;e.chengjie="";var o,c="",p=[],h="",g=!1,m="",u=setTimeout(function a(){t.get(e.link1+"/message/getGcMessage?accountname="+e.localUserName).success(function(n){if(200==n.code)if(1==n.msg){var i=new FormData;i.append("accountname",e.localUserName),t({method:"POST",url:e.link1+"/message/getGcMessageInfo",data:i,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(n){if(c="",h="",200==n.code){for(var i=0;i<n.data.length;i++)if(0!=n.data[i].socialaccountId){var l=!1;c=n.data[i].cid,h=n.data[i].socialaccountId;var r=e.WeChatownerHeader[h],f=n.data[i].group,v=n.data[i].msgType,w=n.data[i].msgId,y=n.data[i].msgContent,b=n.data[i].sendType,C=n.data[i].chatroomMemberWxid,k=n.data[i].socialNumber,I=n.data[i].fromUserName,T="",M="",S="";496==n.data[i].msgType?(T=n.data[i].msgContent.title,M=n.data[i].msgContent.filesize,S=n.data[i].msgId):(T="",M="",S=""),""==n.data[i].isShowDate?(g=!1,m=""):(g=!0,m=n.data[i].isShowDate.slice(10,16),o='<li class="Read"><div class="chatTime_LongTime"><span class="chatTime_LongTime_span">'+m+"</span></div> </li>");var F="";if(1==v){for(var P=!1,L=[".com",".net",".org",".com.cn",".net.cn",".org.cn",".gov","www.","http","https"],_=0;_<L.length;_++)if(y.indexOf(""+L[_])>0){P=!0;break}if(0==P);else{y=y.replace(/((https?|ftp):\/\/)?([-A-Za-z0-9+&@#/%?=~_|!:,.;]+\.[A-Za-z0-9]+[\/=\?%\-&_~`@[\]\':+!]*\w)/gi,function(e,a,t){return'<a class="open-other-url"  target="_blank"  href="'+e+'">'+e+"</a>"})}}if(495==v||496==v);else{if(null==(q=y.match(/\[[^\]]+\]/g))||0==q||null==q);else{for(var x=[],N=[],R=0;R<q.length;R++)for(var A=0;A<s.length;A++)q[R]==s[A]&&(x.push('<img class="emoji_icon" src="images/qq/'+(A+1)+'.gif">'),N.push(s[A]));for(var D=0;D<x.length;D++)y=y.replace(N[D],x[D])}F=y.replace(/<br>/g,"")}if(495==v&&(e.img_text_title=y.title,e.img_text_content=y.content,e.img_text_url=y.url,e.img_text_icon="./images/link.png"),1==f)if(495==v||496==v);else{var q,U=(p=y.split(":<br>"))[1];if(null==U)p[1]="";else if(null==(q=U.match(/\[[^\]]+\]/g))||0==q||null==q)U=p[1].replace(/<br>/g,"");else{for(x=[],N=[],R=0;R<q.length;R++)for(A=0;A<s.length;A++)q[R]==s[A]&&(x.push('<img class="emoji_icon" src="images/qq/'+(A+1)+'.gif">'),N.push(s[A]));for(var H=0;H<x.length;H++)U=U.replace(N[H],x[H]);p[1]=U.replace(/<br>/g,"")}}if(""==C){l=!0;for(var O=!1,j=0;j<e.Chatwithfriends[e.lplplpl].length;j++){if(e.Chatwithfriends[e.lplplpl][j].cid==c){O=!0;break}O=!1}1==O?l=!0:(l=!1,l=null!=e.friendStorage[c])}else{for(j=0;j<e.Chatwithfriends[e.lplplpl].length;j++){if(e.Chatwithfriends[e.lplplpl][j].cid==c){O=!0;break}O=!1}1==O?(l=!0,1==v&&(l=!!e.Groupmemberheadlibrary.hasOwnProperty(C))):l=!1}if(1==l){var G="",B="";if(1==f){G=e.Groupmemberheadlibrary[C];var W=e.WeChatoMembersNickname[C];""!=W&&null!=W&&null!=W||(W=C),B=p[1],1==v?we=p[1]:3==v&&(we=e.imgSrc+p[1]),""!=G&&null!=G||(G="./images/Destroy.png");var z="",J="";0==b?1==v?(z=p[1],J+='<li class="Unread" dataid='+w+'>\n<div class="nesHead">\n<img class="FromUserHeader" src="'+r+'" alt="" >\n                        </div>\n                        <div class="news">\n                            <img class="jiao" src="images/bluejiao.png" alt="">\n                            '+p[1]+"\n                        </div>\n                    </li>"):3==v?(z="[图片]",J+='<li class="Unread" dataid='+w+'>\n                        <div class="nesHead">\n                            <img class="FromUserHeader" src="'+r+'" alt="" >\n                        </div>\n                        <div class="news bigPicture" data="'+w+'" data1='+k+'>\n                            <img class="jiao" src="images/bluejiao.png" alt="">\n                           <img class="up-Img-Add" src='+e.imgSrc+p[1]+' alt="">\n                        </div>\n                    </li>'):495==v?(z="[图文链接]",J+='                        <li class="Unread"  dataid='+w+'>\n                        <div class="nesHead">\n                            <img class="FromUserHeader" src="'+r+'" alt="" >\n                        </div>\n                            <a href='+e.img_text_url+' target="_blank">\n                            <div class="news news-link">\n                                <img class="jiao" src="images/bluejiao.png" alt="">\n                                <div class="defult-Link-Add">\n                                    <span class="defult-Link-title">'+e.img_text_title+'</span>\n                                    <dl>\n                                        <dd>\n                                            <span class="up-file-con">\n                                        '+e.img_text_content+'    </span>\n                                        </dd>\n                                        <dt><img class="up-file-icon" src='+e.img_text_icon+"></dt>\n\n                                    </dl>\n                                </div>\n                            </div>\n                            </a>\n                        </li>"):496==v&&(z="[文件]",J+='                        <li class="Unread" dataid='+w+'>\n                        <div class="nesHead">\n                            <img class="FromUserHeader" src="'+r+'" alt="" >\n                        </div>\n                            <div class="news">\n                                <img class="jiao" src="images/bluejiao.png" alt="">\n                                <div class="up-file-Add">\n                                    <dl>\n                                        <dt><img src="images/defult-File.png"></dt>\n                                        <dd>\n                                            <span class="defult-File-name">\n'+T+'\n                                            </span>\n                                            <br>\n                                            <span class="defult-File-size">\n'+M+'M\n                                            </span>\n                                        </dd>\n                                <div class="up-file-Down" isme="true" file_id='+S+" file_number="+k+" file_title="+T+">下载\n                            </div>\n                                    </dl>\n                                </div>\n                            </div>\n                        </li>"):1==v?(z=p[1],J+='<li class="Unread"  dataid='+w+'>\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+G+'" alt="" >\n                        </div>\n                        <div class="group_meber_name">\n                            '+W+'\n                        </div>\n                        <div class="answers">\n                            <img class="jiao" src="images/whitejiao.png" alt="">\n                            '+p[1]+"\n                        </div>\n                    </li>"):3==v?(z="[图片]",J+='<li class="Unread"  dataid='+w+'>\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+G+'" alt="" >\n                        </div>\n                        <div class="group_meber_name">\n                            '+W+'\n                        </div>\n                        <div class="answers bigPicture"  data="'+w+'" data1='+k+'>\n                            <img class="jiao" src="images/whitejiao.png" alt="">\n                           <img class="up-Img-Add" src='+e.imgSrc+p[1]+' alt="">\n                        </div>\n                    </li>'):495==v?(z="[图文链接]",J+='<li class="Unread" dataid='+w+'>\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+G+'" alt="" >\n                        </div>\n                        <div class="group_meber_name">\n                            '+W+"\n                        </div>\n                            <a href="+e.img_text_url+' target="_blank">\n                            <div class="answers news-link">\n                                <img class="jiao" src="images/whitejiao.png" alt="">\n                                <div class="defult-Link-Add">\n                                    <span class="defult-Link-title">'+e.img_text_title+'</span>\n                                    <dl>\n                                        <dd>\n                                            <span class="up-file-con">\n                                        '+e.img_text_content+'    </span>\n                                        </dd>\n                                        <dt><img class="up-file-icon" src='+e.img_text_icon+"></dt>\n\n                                    </dl>\n                                </div>\n                            </div>\n                            </a>\n                        </li>"):496==v&&(z="[文件]",J+='                        <li class="Unread" dataid='+w+'>\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+G+'" alt="" >\n                        </div>\n                        <div class="group_meber_name">\n                            '+W+'\n                        </div>\n                            <div class="answers">\n                                <img class="jiao" src="images/whitejiao.png" alt="">\n                                <div class="up-file-Add">\n                                    <dl>\n                                        <dt><img src="images/defult-File.png"></dt>\n                                        <dd>\n                                            <span class="defult-File-name">\n'+T+'\n                                            </span>\n                                            <br>\n                                            <span class="defult-File-size">\n'+M+'M\n                                            </span>\n                                        </dd>\n                                <div class="up-file-Down" isme="false" file_id='+S+" file_number="+k+" file_title="+T+">下载\n                            </div>\n                                    </dl>\n                                </div>\n                            </div>\n                        </li>");var E=e.friendStorage[c];e.friendStorage[c]="",e.friendStorage[c]=1==g?E+o+J:E+J;var K=e.friendStorage[c].replace("undefined","");if(e.friendStorage[c]=K,e.friendStorage[c].split("Unread").length-1>=99&&"99+",h==e.lplplpl||-1==e.lplplpl){var Z="";for(R=0;R<e.Chatwithfriends[h].length;R++)e.Chatwithfriends[h][R].cid==c&&(e.Chatwithfriends[h][R].lastChatTime=e.getNowFormatDate());for(A=0;A<e.Chatwithfriends[-1].length;A++)e.Chatwithfriends[-1][A].cid==c&&(e.Chatwithfriends[-1][A].lastChatTime=e.getNowFormatDate());if($(".page1-Maindiv3").attr("data")==c){if(1==g&&$(".newsList").append(o),0==b?1==v?(Z=p[1],$(".newsList").append('     <li class="Unread" dataid='+w+'>\n<div class="nesHead">\n<img class="FromUserHeader" src="'+r+'" alt="" >\n                        </div>\n                        <div class="news">\n                            <img class="jiao" src="images/bluejiao.png" alt="">\n                            '+p[1]+"\n                        </div>\n                    </li>")):3==v?(z="[图片]",Z="[图片]",$(".newsList").append('     <li class="Unread" dataid='+w+'>\n                        <div class="nesHead">\n                            <img class="FromUserHeader" src="'+r+'" alt="" >\n                        </div>\n                        <div class="news bigPicture"  data="'+w+'" data1='+k+'>\n                            <img class="jiao" src="images/bluejiao.png" alt="">\n                           <img class="up-Img-Add" src='+e.imgSrc+p[1]+' alt="">\n                        </div>\n                    </li>')):495==v?(z="[图文链接]",Z="[图文链接]",$(".newsList").append('     <li class="Unread" dataid='+w+'>\n                        <div class="nesHead">\n                            <img class="FromUserHeader" src="'+r+'" alt="" >\n                        </div>\n                            <a href='+e.img_text_url+' target="_blank">\n                            <div class="news news-link">\n                                <img class="jiao" src="images/bluejiao.png" alt="">\n                                <div class="defult-Link-Add">\n                                    <span class="defult-Link-title">'+e.img_text_title+'</span>\n                                    <dl>\n                                        <dd>\n                                            <span class="up-file-con">\n                                        '+e.img_text_content+'    </span>\n                                        </dd>\n                                        <dt><img class="up-file-icon" src='+e.img_text_icon+"></dt>\n\n                                    </dl>\n                                </div>\n                            </div>\n                            </a>\n                        </li>")):496==v&&(z="[文件]",Z="[文件]",$(".newsList").append('                      <li class="Unread"  dataid='+w+'>\n                        <div class="nesHead">\n                            <img class="FromUserHeader" src="'+r+'" alt="" >\n                        </div>\n                            <div class="news">\n                                <img class="jiao" src="images/bluejiao.png" alt="">\n                                <div class="up-file-Add">\n                                    <dl>\n                                        <dt><img src="images/defult-File.png"></dt>\n                                        <dd>\n                                            <span class="defult-File-name">\n'+T+'\n                                            </span>\n                                            <br>\n                                            <span class="defult-File-size">\n'+M+'M\n                                            </span>\n                                        </dd>\n                                <div class="up-file-Down" isme="true" file_id='+S+" file_number="+k+"file_title="+T+">下载\n                            </div>\n                                    </dl>\n                                </div>\n                            </div>\n                        </li>")):1==v?(Z=p[1],$(".newsList").append('     <li class="Unread" dataid='+w+'>\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+G+'" alt="" >\n                        </div>\n                        <div class="group_meber_name">\n                            '+W+'\n                        </div>\n                        <div class="answers">\n                            <img class="jiao" src="images/whitejiao.png" alt="">\n                            '+p[1]+"\n                        </div>\n                    </li>")):3==v?(Z="[图片]",$(".newsList").append('     <li class="Unread" dataid='+w+'>\n                        <div class="answerHead bigPicture">\n                            <img class="FromUserHeader" src="'+G+'" alt="" >\n                        </div>\n                        <div class="group_meber_name">\n                            '+W+'\n                        </div>\n                        <div class="answers bigPicture"  data="'+w+'" data1='+k+'>\n                            <img class="jiao" src="images/whitejiao.png" alt="">\n                           <img class="up-Img-Add" src='+e.imgSrc+p[1]+' alt="">\n                        </div>\n                    </li>')):495==v?(z="[图文链接]",Z="[图文链接]",$(".newsList").append('    <li class="Unread" dataid='+w+'>\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+G+'" alt="" >\n                        </div>\n                        <div class="group_meber_name">\n                            '+W+"\n                        </div>\n                            <a href="+e.img_text_url+' target="_blank">\n                            <div class="answers news-link">\n                                <img class="jiao" src="images/whitejiao.png" alt="">\n                                <div class="defult-Link-Add">\n                                    <span class="defult-Link-title">'+e.img_text_title+'</span>\n                                    <dl>\n                                        <dd>\n                                            <span class="up-file-con">\n                                        '+e.img_text_content+'    </span>\n                                        </dd>\n                                        <dt><img class="up-file-icon" src='+e.img_text_icon+"></dt>\n\n                                    </dl>\n                                </div>\n                            </div>\n                            </a>\n                        </li>")):496==v&&(z="[文件]",Z="[文件]",$(".newsList").append('                     <li class="Unread" dataid='+w+'>\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+G+'" alt="" >\n                        </div>\n                        <div class="group_meber_name">\n                            '+W+'\n                        </div>\n                            <div class="answers">\n                                <img class="jiao" src="images/whitejiao.png" alt="">\n                                <div class="up-file-Add">\n                                    <dl>\n                                        <dt><img src="images/defult-File.png"></dt>\n                                        <dd>\n                                            <span class="defult-File-name">\n'+T+'\n                                            </span>\n                                            <br>\n                                            <span class="defult-File-size">\n'+M+' M\n                                            </span>\n                                        </dd>\n                                <div class="up-file-Down" isme="false" file_id='+S+" file_number="+k+" file_title="+T+">下载\n                            </div>\n                                    </dl>\n                                </div>\n                            </div>\n                        </li>")),e.RightContscrollHeight-e.RightContoffsetHeight==e.RightContscrollTop){var V=$(".RightCont")[0].scrollHeight;$(".RightCont").animate({scrollTop:V},500)}else $(".Newmessagereminding").css("display","block");for(var Y=0,Q=0,X="",ee=!1,ae=0;ae<e.Chatwithfriends[e.lplplpl].length;ae++)e.Chatwithfriends[e.lplplpl][ae].cid==c&&(Y=ae,X=e.Chatwithfriends[e.lplplpl][ae],1==e.Chatwithfriends[e.lplplpl][ae].topNumber&&(ee=!0)),1==e.Chatwithfriends[e.lplplpl][ae].topNumber&&Q++;X.newMessage=Z,1==ee?(e.Chatwithfriends[e.lplplpl].splice(Y,1),e.Chatwithfriends[e.lplplpl].splice(0,0,X)):(e.Chatwithfriends[e.lplplpl].splice(Y,1),e.Chatwithfriends[e.lplplpl].splice(Q,0,X)),e.Chatwithfriends[e.lplplpl].length>50?e.frienfList=e.Chatwithfriends[e.lplplpl].slice(0,50):e.frienfList=e.Chatwithfriends[e.lplplpl],setTimeout(function(){d(I,Z,G,c),$(".page1-Maindiv2-myfriends-search-con-ul1").find(".page1-Maindiv2-myfriends-search-con-ul-tagname1").html(""),$(".page1-Maindiv2-myfriends-search-con-ul1").find(".new-msg-number").css("display","none").html("");var a=e.Chatwithfriends[e.lplplpl].length;a>50&&(a=50);for(var t=0;t<a;t++){var n=e.Chatwithfriends[e.lplplpl][t].cid;""!=e.Chatwithfriends[e.lplplpl][t].newMessage&&$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.Chatwithfriends[e.lplplpl][t].cid+'"]').html(e.Chatwithfriends[e.lplplpl][t].newMessage);var i=0;e.friendStorage.hasOwnProperty(n)?(-1!=e.friendStorage[n].indexOf("Unread")?(i=e.friendStorage[n].split("Unread").length-1)>99&&(i="99+"):i=0,i>0?$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","inline-block").html(i):$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","none").html("")):$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","none").html("")}},0);var te=e.friendStorage[c].replace(/Unread/g,"Read");e.friendStorage[c]=te}else{Z="";0==b?1==v?Z=p[1]:3==v?(z="[图片]",Z="[图片]"):495==v?(z="[图文链接]",Z="[图文链接]"):496==v&&(z="[文件]",Z="[文件]"):1==v?Z=p[1]:3==v?Z="[图片]":495==v?(z="[图文链接]",Z="[图文链接]"):496==v&&(z="[文件]",Z="[文件]");Y=0,Q=0,X="",ee=!1;for(var ne=0;ne<e.Chatwithfriends[e.lplplpl].length;ne++)e.Chatwithfriends[e.lplplpl][ne].cid==c&&(Y=ne,X=e.Chatwithfriends[e.lplplpl][ne],1==e.Chatwithfriends[e.lplplpl][ne].topNumber&&(ee=!0)),1==e.Chatwithfriends[e.lplplpl][ne].topNumber&&Q++;X.newMessage=Z,1==ee?(e.Chatwithfriends[e.lplplpl].splice(Y,1),e.Chatwithfriends[e.lplplpl].splice(0,0,X)):(e.Chatwithfriends[e.lplplpl].splice(Y,1),e.Chatwithfriends[e.lplplpl].splice(Q,0,X)),e.Chatwithfriends[e.lplplpl].length>50?e.frienfList=e.Chatwithfriends[e.lplplpl].slice(0,50):e.frienfList=e.Chatwithfriends[e.lplplpl],setTimeout(function(){d(I,Z,G,c),$(".page1-Maindiv2-myfriends-search-con-ul1").find(".page1-Maindiv2-myfriends-search-con-ul-tagname1").html(""),$(".page1-Maindiv2-myfriends-search-con-ul1").find(".new-msg-number").css("display","none").html("");var a=e.Chatwithfriends[e.lplplpl].length;a>50&&(a=50);for(var t=0;t<a;t++){var n=e.Chatwithfriends[e.lplplpl][t].cid;""!=e.Chatwithfriends[e.lplplpl][t].newMessage&&$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.Chatwithfriends[e.lplplpl][t].cid+'"]').html(e.Chatwithfriends[e.lplplpl][t].newMessage);var i=0;e.friendStorage.hasOwnProperty(n)?(""==e.friendStorage[n]||null==e.friendStorage[n]||(-1!=e.friendStorage[n].indexOf("Unread")?(i=e.friendStorage[n].split("Unread").length-1)>99&&(i="99+"):i=e.friendStorage[n].split("Unread").length-1),i>0?$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","inline-block").html(i):$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","none").html("")):$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","none").html("")}},100)}}else{var ie=!1,se="",de=0;d(I,z,G,c);for(R=0;R<e.Chatwithfriends[h].length;R++){if(e.Chatwithfriends[h][R].cid==c){e.Chatwithfriends[h][R],ie=!0;break}ie=!1}if(1==ie);else{for(R=0;R<e.Chatwithfriends[h].length&&1==e.Chatwithfriends[h][R].topNumber;R++)de++;for(R=0;R<e.friendAndGroupStorage.length;R++)if(e.friendAndGroupStorage[R].cid==c){se=e.friendAndGroupStorage[R];break}se.newMessage=B,se.lastChatTime=e.getNowFormatDate(),1==se.topNumber?e.Chatwithfriends[h].splice(0,0,se):(e.Chatwithfriends[h].splice(de,1),e.Chatwithfriends[h].splice(de,0,se))}}}else{G=e.friendHeader[c],B=F;z="",J="";if(0==b?1==v?(z=B,J='                       <li class="Unread" dataid='+w+'>\n                        <div class="nesHead">\n                            <img class="FromUserHeader" src="'+r+'" alt="" >\n                        </div>\n                        <div class="news">\n                            <img class="jiao" src="images/bluejiao.png" alt="">\n                            '+B+"\n                        </div>\n                    </li>"):3==v?(z="[图片]",J='                       <li class="Unread" dataid='+w+'>\n                        <div class="nesHead">\n                            <img class="FromUserHeader" src="'+r+'" alt="" >\n                        </div>\n                        <div class="news bigPicture"  data="'+w+'" data1='+k+'>\n                            <img class="jiao" src="images/bluejiao.png" alt="">\n                           <img class="up-Img-Add" src='+B+' alt="">\n                        </div>\n                    </li>'):495==v?(z="[图文链接]",J+='                        <li class="Unread" dataid='+w+'>\n                        <div class="nesHead">\n                            <img class="FromUserHeader" src="'+r+'" alt="" >\n                        </div>\n                            <a href='+e.img_text_url+' target="_blank">\n                            <div class="news news-link">\n                                <img class="jiao" src="images/bluejiao.png" alt="">\n                                <div class="defult-Link-Add">\n                                    <span class="defult-Link-title">'+e.img_text_title+'</span>\n                                    <dl>\n                                        <dd>\n                                            <span class="up-file-con">\n                                        '+e.img_text_content+'    </span>\n                                        </dd>\n                                        <dt><img class="up-file-icon" src='+e.img_text_icon+"></dt>\n\n                                    </dl>\n                                </div>\n                            </div>\n                            </a>\n                        </li>"):496==v&&(z="[文件]",J+='                        <li class="Unread" dataid='+w+'>\n                        <div class="nesHead">\n                            <img class="FromUserHeader" src="'+r+'" alt="" >\n                        </div>\n                            <div class="news">\n                                <img class="jiao" src="images/bluejiao.png" alt="">\n                                <div class="up-file-Add">\n                                    <dl>\n                                        <dt><img src="images/defult-File.png"></dt>\n                                        <dd>\n                                            <span class="defult-File-name">\n'+T+'\n                                            </span>\n                                            <br>\n                                            <span class="defult-File-size">\n'+M+'M\n                                            </span>\n                                        </dd>\n                                <div class="up-file-Down" isme="true" file_id='+S+" file_number="+k+" file_title="+T+">下载\n                            </div>\n                                    </dl>\n                                </div>\n                            </div>\n                        </li>"):1==v?(z=B,J='                       <li class="Unread" dataid='+w+'>\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+G+'" alt="" >\n                        </div>\n                        <div class="answers">\n                            <img class="jiao" src="images/whitejiao.png" alt="">\n                            '+B+"\n                        </div>\n                    </li>"):3==v?(z="[图片]",J='                       <li class="Unread" dataid='+w+'>\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+G+'" alt="" >\n                        </div>\n                        <div class="answers bigPicture"  data="'+w+'"data1='+k+'>\n                            <img class="jiao" src="images/whitejiao.png" alt="">\n                           <img class="up-Img-Add" src='+B+' alt="">\n                        </div>\n                    </li>'):495==v?(z="[图文链接]",J+='<li class="Unread" dataid='+w+'>\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+G+'" alt="" >\n                        </div>\n                            <a href='+e.img_text_url+' target="_blank">\n                            <div class="answers news-link">\n                                <img class="jiao" src="images/whitejiao.png" alt="">\n                                <div class="defult-Link-Add">\n                                    <span class="defult-Link-title">'+e.img_text_title+'</span>\n                                    <dl>\n                                        <dd>\n                                            <span class="up-file-con">\n                                        '+e.img_text_content+'    </span>\n                                        </dd>\n                                        <dt><img class="up-file-icon" src='+e.img_text_icon+"></dt>\n\n                                    </dl>\n                                </div>\n                            </div>\n                            </a>\n                        </li>"):496==v&&(z="[文件]",J+='                        <li class="Unread" dataid='+w+'>\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+G+'" alt="" >\n                        </div>\n                            <div class="answers">\n                                <img class="jiao" src="images/whitejiao.png" alt="">\n                                <div class="up-file-Add">\n                                    <dl>\n                                        <dt><img src="images/defult-File.png"></dt>\n                                        <dd>\n                                            <span class="defult-File-name">\n'+T+'\n                                            </span>\n                                            <br>\n                                            <span class="defult-File-size">\n'+M+'M\n                                            </span>\n                                        </dd>\n                                <div class="up-file-Down" isme="false" file_id='+S+" file_number="+k+"file_title="+T+">下载\n                            </div>\n                                    </dl>\n                                </div>\n                            </div>\n                        </li>"),1==g&&(e.friendStorage[c]+=o),e.friendStorage[c],e.friendStorage[c]+=J,e.friendStorage[c].split("Unread").length-1>=99&&"99+",$(".page1-Maindiv3").attr("data")==c){for(R=0;R<e.Chatwithfriends[h].length;R++)if(e.Chatwithfriends[h][R].cid==c){e.Chatwithfriends[h][R].newMessage=z,e.Chatwithfriends[h][R].lastChatTime=e.getNowFormatDate();break}for(A=0;A<e.Chatwithfriends[-1].length;A++)if(e.Chatwithfriends[-1][A].cid==c){e.Chatwithfriends[-1][A].newMessage=z,e.Chatwithfriends[-1][A].lastChatTime=e.getNowFormatDate();break}d(I,z,G,c);de=$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+c+'"]').attr("data1");if(1==g&&$(".newsList").append(o),0==b?1==v?$(".newsList").append('<li class="Unread" dataid='+w+'>\n                        <div class="nesHead">\n                            <img class="FromUserHeader" src="'+r+'" alt="" >\n                        </div>\n                        <div class="news">\n                            <img class="jiao" src="images/bluejiao.png" alt="">\n                            '+B+"\n                        </div>\n                    </li>"):3==v?(z="[图片]",$(".newsList").append('                      <li class="Unread" dataid='+w+'>\n                        <div class="nesHead">\n                            <img class="FromUserHeader" src="'+r+'" alt="" >\n                        </div>\n                        <div class="news bigPicture"  data="'+w+'" data1='+k+'>\n                            <img class="jiao" src="images/bluejiao.png" alt="">\n                           <img class="up-Img-Add" src='+B+' alt="">\n                        </div>\n                    </li>')):495==v?(z="[图文链接]",$(".newsList").append('                     <li class="Unread" dataid='+w+'>\n                        <div class="nesHead">\n                            <img class="FromUserHeader" src="'+r+'" alt="" >\n                        </div>\n                            <a href='+e.img_text_url+' target="_blank">\n                            <div class="news news-link">\n                                <img class="jiao" src="images/bluejiao.png" alt="">\n                                <div class="defult-Link-Add">\n                                    <span class="defult-Link-title">'+e.img_text_title+'</span>\n                                    <dl>\n                                        <dd>\n                                            <span class="up-file-con">\n                                        '+e.img_text_content+'    </span>\n                                        </dd>\n                                        <dt><img class="up-file-icon" src='+e.img_text_icon+"></dt>\n\n                                    </dl>\n                                </div>\n                            </div>\n                            </a>\n                        </li>")):496==v&&(z="[文件]",$(".newsList").append('                      <li class="Unread" dataid='+w+'>\n                        <div class="nesHead">\n                            <img class="FromUserHeader" src="'+r+'" alt="" >\n                        </div>\n                            <div class="news">\n                                <img class="jiao" src="images/bluejiao.png" alt="">\n                                <div class="up-file-Add">\n                                    <dl>\n                                        <dt><img src="images/defult-File.png"></dt>\n                                        <dd>\n                                            <span class="defult-File-name">\n'+T+'\n                                            </span>\n                                            <br>\n                                            <span class="defult-File-size">\n'+M+'M\n                                            </span>\n                                        </dd>\n                                <div class="up-file-Down" isme="true" file_id='+S+" file_number="+k+" file_title="+T+">下载\n                            </div>\n                                    </dl>\n                                </div>\n                            </div>\n                        </li>")):1==v?$(".newsList").append('     <li class="Unread" dataid='+w+'>\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+G+'" alt="" >\n                        </div>\n                        <div class="answers">\n                            <img class="jiao" src="images/whitejiao.png" alt="">\n                            '+B+"\n                        </div>\n                    </li>"):3==v?(z="[图片]",$(".newsList").append('       <li class="Unread" dataid='+w+'>\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+G+'" alt="" >\n                        </div>\n                        <div class="answers bigPicture"  data="'+w+'"data1='+k+'>\n                            <img class="jiao" src="images/whitejiao.png" alt="">\n                           <img class="up-Img-Add" src='+B+' alt="">\n                        </div>\n                    </li>')):495==v?(z="[图文链接]",$(".newsList").append('   <li class="Unread" dataid='+w+'>\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+G+'" alt="" >\n                        </div>\n                            <a href='+e.img_text_url+' target="_blank">\n                            <div class="answers news-link">\n                                <img class="jiao" src="images/whitejiao.png" alt="">\n                                <div class="defult-Link-Add">\n                                    <span class="defult-Link-title">'+e.img_text_title+'</span>\n                                    <dl>\n                                        <dd>\n                                            <span class="up-file-con">\n                                        '+e.img_text_content+'    </span>\n                                        </dd>\n                                        <dt><img class="up-file-icon" src='+e.img_text_icon+"></dt>\n\n                                    </dl>\n                                </div>\n                            </div>\n                            </a>\n                        </li>")):496==v&&(z="[文件]",$(".newsList").append('                 <li class="Unread" dataid='+w+'>\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+G+'" alt="" >\n                        </div>\n                            <div class="answers">\n                                <img class="jiao" src="images/whitejiao.png" alt="">\n                                <div class="up-file-Add">\n                                    <dl>\n                                        <dt><img src="images/defult-File.png"></dt>\n                                        <dd>\n                                            <span class="defult-File-name">\n'+T+'\n                                            </span>\n                                            <br>\n                                            <span class="defult-File-size">\n'+M+'M\n                                            </span>\n                                        </dd>\n                                <div class="up-file-Down" isme="false" file_id='+S+" file_number="+k+" file_title="+T+">下载\n                            </div>\n                                    </dl>\n                                </div>\n                            </div>\n                        </li>")),e.RightContscrollHeight-e.RightContoffsetHeight==e.RightContscrollTop){V=$(".RightCont")[0].scrollHeight;$(".RightCont").animate({scrollTop:V},500)}else $(".Newmessagereminding").css("display","block");Y=0,Q=0,X="",ee=!1;for(var le=0;le<e.Chatwithfriends[e.lplplpl].length;le++)e.Chatwithfriends[e.lplplpl][le].cid==c&&(Y=le,X=e.Chatwithfriends[e.lplplpl][le],1==e.Chatwithfriends[e.lplplpl][le].topNumber&&(ee=!0)),1==e.Chatwithfriends[e.lplplpl][le].topNumber&&Q++;1==ee?(e.Chatwithfriends[e.lplplpl].splice(Y,1),e.Chatwithfriends[e.lplplpl].splice(0,0,X)):(e.Chatwithfriends[e.lplplpl].splice(Y,1),e.Chatwithfriends[e.lplplpl].splice(Q,0,X)),e.Chatwithfriends[e.lplplpl].length>50?e.frienfList=e.Chatwithfriends[e.lplplpl].slice(0,50):e.frienfList=e.Chatwithfriends[e.lplplpl],setTimeout(function(){1==v?$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+c+'"]').html(F):3==v?$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+c+'"]').html("[图片]"):495==v&&$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+c+'"]').html("[图文链接]");var a=e.friendStorage[c].replace(/Unread/g,"Read");e.friendStorage[c]=a},200)}else{for(R=0;R<e.Chatwithfriends[h].length;R++)e.Chatwithfriends[h][R].cid==c&&(e.Chatwithfriends[h][R].newMessage=z,e.Chatwithfriends[h][R].lastChatTime=e.getNowFormatDate());for(A=0;A<e.Chatwithfriends[-1].length;A++)e.Chatwithfriends[-1][A].cid==c&&(e.Chatwithfriends[-1][A].newMessage=z,e.Chatwithfriends[-1][A].lastChatTime=e.getNowFormatDate());for(Y=0,Q=0,X="",ee=!1,_=0;_<e.Chatwithfriends[e.lplplpl].length;_++)e.Chatwithfriends[e.lplplpl][_].cid==c&&(Y=_,X=e.Chatwithfriends[e.lplplpl][_],1==e.Chatwithfriends[e.lplplpl][_].topNumber&&(ee=!0)),1==e.Chatwithfriends[e.lplplpl][_].topNumber&&Q++;""==X||null==X||null==X||(d(I,z,G,c),1==ee?(e.Chatwithfriends[e.lplplpl].splice(Y,1),e.Chatwithfriends[e.lplplpl].splice(0,0,X)):(e.Chatwithfriends[e.lplplpl].splice(Y,1),e.Chatwithfriends[e.lplplpl].splice(Q,0,X)),e.Chatwithfriends[e.lplplpl].length>50?e.frienfList=e.Chatwithfriends[e.lplplpl].slice(0,50):e.frienfList=e.Chatwithfriends[e.lplplpl],setTimeout(function(){$(".page1-Maindiv2-myfriends-search-con-ul1").find(".page1-Maindiv2-myfriends-search-con-ul-tagname1").html(""),$(".page1-Maindiv2-myfriends-search-con-ul1").find(".new-msg-number").css("display","none").html("");var a=e.Chatwithfriends[e.lplplpl].length;a>50&&(a=50);for(var t=0;t<a;t++){var n=e.Chatwithfriends[e.lplplpl][t].cid;""!=e.Chatwithfriends[e.lplplpl][t].newMessage&&$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.Chatwithfriends[e.lplplpl][t].cid+'"]').html(e.Chatwithfriends[e.lplplpl][t].newMessage);var i=0;e.friendStorage.hasOwnProperty(n)?(""==e.friendStorage[n]||null==e.friendStorage[n]||NaN==e.friendStorage[n]||null==e.friendStorage[n]||(-1!=e.friendStorage[n].indexOf("Unread")?(i=e.friendStorage[n].split("Unread").length-1)>99&&(i="99+"):i=0),i>0?$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","inline-block").html(i):$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","none").html("")):$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","none").html("")}},0))}}}else{if(1==f){e.panduankuli=!1;for(var re="",oe=!1,ce=0;ce<e.Chatwithfriends[e.lplplpl].length;ce++){if(e.Chatwithfriends[e.lplplpl][ce].cid==c){re=e.Chatwithfriends[e.lplplpl][ce],oe=!0;break}oe=!1}if(1==oe){var pe="./images/Destroy.png";1==v?we=p[1]:3==v&&(we=e.imgSrc+p[1]);z="";var he="";0==b?1==v?(z=p[1],he='<li class="Unread" dataid='+w+'>\n<div class="nesHead">\n<img class="FromUserHeader" src="'+r+'" alt="" >\n                        </div>\n                        <div class="news">\n                            <img class="jiao" src="images/bluejiao.png" alt="">\n                            '+p[1]+"\n                        </div>\n                    </li>"):3==v?(z="[图片]",he='<li class="Unread" dataid='+w+'>\n                        <div class="nesHead">\n                            <img class="FromUserHeader" src="'+r+'" alt="" >\n                        </div>\n                        <div class="news bigPicture" data="'+w+'"data1='+k+' >\n                            <img class="jiao" src="images/bluejiao.png" alt="">\n                           <img class="up-Img-Add" src='+e.imgSrc+p[1]+' alt="">\n                        </div>\n                    </li>'):495==v?(z="[图文链接]",he+='                        <li class="Unread" dataid='+w+'>\n                        <div class="nesHead">\n                            <img class="FromUserHeader" src="'+r+'" alt="" >\n                        </div>\n                            <a href='+e.img_text_url+' target="_blank">\n                            <div class="news news-link">\n                                <img class="jiao" src="images/bluejiao.png" alt="">\n                                <div class="defult-Link-Add">\n                                    <span class="defult-Link-title">'+e.img_text_title+'</span>\n                                    <dl>\n                                        <dd>\n                                            <span class="up-file-con">\n                                        '+e.img_text_content+'    </span>\n                                        </dd>\n                                        <dt><img class="up-file-icon" src='+e.img_text_icon+"></dt>\n\n                                    </dl>\n                                </div>\n                            </div>\n                            </a>\n                        </li>"):496==v&&(z="[文件]",he+='                        <li class="Unread" dataid='+w+'>\n                        <div class="nesHead">\n                            <img class="FromUserHeader" src="'+r+'" alt="" >\n                        </div>\n                            <div class="news">\n                                <img class="jiao" src="images/bluejiao.png" alt="">\n                                <div class="up-file-Add">\n                                    <dl>\n                                        <dt><img src="images/defult-File.png"></dt>\n                                        <dd>\n                                            <span class="defult-File-name">\n'+T+'\n                                            </span>\n                                            <br>\n                                            <span class="defult-File-size">\n'+M+' M\n                                            </span>\n                                        </dd>\n                                <div class="up-file-Down" isme="true" file_id='+S+" file_number="+k+" file_title="+T+">下载\n                            </div>\n                                    </dl>\n                                </div>\n                            </div>\n                        </li>"):1==v?(z=p[1],he='<li class="Unread" dataid='+w+'>\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+pe+'" alt="" >\n                        </div>\n                        <div class="group_meber_name">\n                            '+C+'\n                        </div>\n                        <div class="answers">\n                            <img class="jiao" src="images/whitejiao.png " alt="">\n                            '+p[1]+"\n                        </div>\n                    </li>"):3==v?(z="[图片]",he='<li class="Unread" dataid='+w+'>\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+pe+'" alt="" >\n                        </div>\n                        <div class="group_meber_name">\n                            '+C+'\n                        </div>\n                        <div class="answers bigPicture"  data="'+w+'"data1='+k+'>\n                            <img class="jiao" src="images/whitejiao.png" alt="">\n                           <img class="up-Img-Add" src='+e.imgSrc+p[1]+' alt="">\n                        </div>\n                    </li>'):495==v?(z="[图文链接]",he+='<li class="Unread" dataid='+w+'>\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+pe+'" alt="" >\n                        </div>\n                        <div class="group_meber_name">\n                            '+C+"\n                        </div>\n                            <a href="+e.img_text_url+' target="_blank">\n                            <div class="answers news-link">\n                                <img class="jiao" src="images/whitejiao.png" alt="">\n                                <div class="defult-Link-Add">\n                                    <span class="defult-Link-title">'+e.img_text_title+'</span>\n                                    <dl>\n                                        <dd>\n                                            <span class="up-file-con">\n                                        '+e.img_text_content+'    </span>\n                                        </dd>\n                                        <dt><img class="up-file-icon" src='+e.img_text_icon+"></dt>\n\n                                    </dl>\n                                </div>\n                            </div>\n                            </a>\n                        </li>"):496==v&&(z="[文件]",he+='                        <li class="Unread" dataid='+w+'>\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+pe+'" alt="" >\n                        </div>\n                        <div class="group_meber_name">\n                            '+C+'\n                        </div>\n                            <div class="answers">\n                                <img class="jiao" src="images/whitejiao.png" alt="">\n                                <div class="up-file-Add">\n                                    <dl>\n                                        <dt><img src="images/defult-File.png"></dt>\n                                        <dd>\n                                            <span class="defult-File-name">\n'+T+'\n                                            </span>\n                                            <br>\n                                            <span class="defult-File-size">\n'+M+'M\n                                            </span>\n                                        </dd>\n                                <div class="up-file-Down" isme="false" file_id='+S+" file_number="+k+" file_title="+T+">下载\n                            </div>\n                                    </dl>\n                                </div>\n                            </div>\n                        </li>"),e.Groupmemberheadlibrary[C]="./images/Destroy.png",1==g&&(e.friendStorage[c]+=o),e.friendStorage[c]+=he;var ge=1;0==(ge=e.friendStorage[c].split("Unread").length-1)&&(ge=1),ge>=99&&(ge="99+");Y=0,Q=0,X="",ee=!1;for(var me=0;me<e.Chatwithfriends[e.lplplpl].length;me++)e.Chatwithfriends[e.lplplpl][me].cid==c&&(Y=me,X=e.Chatwithfriends[e.lplplpl][me],1==e.Chatwithfriends[e.lplplpl][me].topNumber&&(ee=!0)),1==e.Chatwithfriends[e.lplplpl][me].topNumber&&Q++;X.lastChatTime=e.getNowFormatDate(),X.newMessage=z,1==ee?(e.Chatwithfriends[e.lplplpl].splice(Y,1),e.Chatwithfriends[e.lplplpl].splice(0,0)):(e.Chatwithfriends[e.lplplpl].splice(Y,1),e.Chatwithfriends[e.lplplpl].splice(Q,0,X)),e.Chatwithfriends[e.lplplpl].length>50?e.frienfList=e.Chatwithfriends[e.lplplpl].slice(0,50):e.frienfList=e.Chatwithfriends[e.lplplpl],(fe=new FormData).append("chatroommemberwxid",p[0]),fe.append("socialaccountId",h),fe.append("temp",c),t({method:"POST",url:e.link1+"/message/getChatroommemberInfoByWxid",data:fe,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){if(200==a.code){var t=e.imgSrc+a.data.chatroommember.profilePhoto;e.Groupmemberheadlibrary[a.data.chatroommember.chatroomMemberWxid]=e.imgSrc+a.data.chatroommember.profilePhoto,e.WeChatoMembersNickname[a.data.chatroommember.chatroomMemberWxid]=a.data.chatroommember.memberName;var n=e.friendStorage[a.data.temp].replace("./images/Destroy.png",t).replace(a.data.chatroommember.chatroomMemberWxid,a.data.chatroommember.memberName);e.friendStorage[a.data.temp]=n,d(I,z,t,c)}})}else{z="";var ue=!1;1==v?we=p[1]:3==v&&(we=e.imgSrc+p[1]);var fe;pe="./images/Destroy.png";if(0==b)if(1==v){var ve="";z=we,ve+='                       <li class="Unread" dataid='+w+'>\n                        <div class="nesHead">\n                            <img class="FromUserHeader" src="'+r+'" alt="" >\n                        </div>\n                        <div class="news">\n                            <img class="jiao" src="images/bluejiao.png" alt="">\n                            '+we+"\n                        </div>\n                    </li>"}else if(3==v){z="[图片]";ve="";ve+='                       <li class="Unread" dataid='+w+'>\n                        <div class="nesHead">\n                            <img class="FromUserHeader" src="'+r+'" alt="" >\n                        </div>\n                        <div class="news bigPicture"  data="'+w+'"data1='+k+'>\n                            <img class="jiao" src="images/bluejiao.png" alt="">\n                           <img class="up-Img-Add" src='+we+' alt="">\n                        </div>\n                    </li>'}else 495==v?(z="[图文链接]",ve+='                        <li class="Unread" dataid='+w+'>\n                        <div class="nesHead">\n                            <img class="FromUserHeader" src="'+r+'" alt="" >\n                        </div>\n                            <a href='+e.img_text_url+' target="_blank">\n                            <div class="news news-link">\n                                <img class="jiao" src="images/bluejiao.png" alt="">\n                                <div class="defult-Link-Add">\n                                    <span class="defult-Link-title">'+e.img_text_title+'</span>\n                                    <dl>\n                                        <dd>\n                                            <span class="up-file-con">\n                                        '+e.img_text_content+'    </span>\n                                        </dd>\n                                        <dt><img class="up-file-icon" src='+e.img_text_icon+"></dt>\n\n                                    </dl>\n                                </div>\n                            </div>\n                            </a>\n                        </li>"):496==v&&(z="[文件]",ve+='                        <li class="Unread" dataid='+w+'>\n                        <div class="nesHead">\n                            <img class="FromUserHeader" src="'+r+'" alt="" >\n                        </div>\n                            <div class="news">\n                                <img class="jiao" src="images/bluejiao.png" alt="">\n                                <div class="up-file-Add">\n                                    <dl>\n                                        <dt><img src="images/defult-File.png"></dt>\n                                        <dd>\n                                            <span class="defult-File-name">\n'+T+'\n                                            </span>\n                                            <br>\n                                            <span class="defult-File-size">\n'+M+'M\n                                            </span>\n                                        </dd>\n                                <div class="up-file-Down" isme="true" file_id='+S+" file_number="+k+" file_title="+T+">下载\n                            </div>\n                                    </dl>\n                                </div>\n                            </div>\n                        </li>");else if(1==v){ve="";z=we,ve+='                       <li class="Unread" dataid='+w+'>\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+pe+'" alt="" >\n                        </div>\n                        <div class="group_meber_name">\n                            '+C+'\n                        </div>\n                        <div class="answers">\n                            <img class="jiao" src="images/whitejiao.png" alt="">\n                            '+we+"\n                        </div>\n                    </li>"}else if(3==v){ve="";z="[图片]",ve+='                       <li class="Unread" dataid='+w+'>\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+pe+'" alt="" >\n                        </div>\n                        <div class="group_meber_name">\n                            '+C+'\n                        </div>\n                        <div class="answers bigPicture"  data="'+w+'"data1='+k+'>\n                            <img class="jiao" src="images/whitejiao.png" alt="">\n                           <img class="up-Img-Add" src='+we+' alt="">\n                        </div>\n                    </li>'}else 495==v?(z="[图文链接]",ve+='<li class="Unread" dataid='+w+'>\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+pe+'" alt="" >\n                        </div>\n                        <div class="group_meber_name">\n                            '+C+"\n                        </div>\n                            <a href="+e.img_text_url+' target="_blank">\n                            <div class="answers news-link">\n                                <img class="jiao" src="images/whitejiao.png" alt="">\n                                <div class="defult-Link-Add">\n                                    <span class="defult-Link-title">'+e.img_text_title+'</span>\n                                    <dl>\n                                        <dd>\n                                            <span class="up-file-con">\n                                        '+e.img_text_content+'    </span>\n                                        </dd>\n                                        <dt><img class="up-file-icon" src='+e.img_text_icon+"></dt>\n\n                                    </dl>\n                                </div>\n                            </div>\n                            </a>\n                        </li>"):496==v&&(z="[文件]",ve+='                        <li class="Unread" dataid='+w+'>\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+pe+'" alt="" >\n                        </div>\n                        <div class="group_meber_name">\n                            '+C+'\n                        </div>\n                            <div class="answers">\n                                <img class="jiao" src="images/whitejiao.png" alt="">\n                                <div class="up-file-Add">\n                                    <dl>\n                                        <dt><img src="images/defult-File.png"></dt>\n                                        <dd>\n                                            <span class="defult-File-name">\n'+T+'\n                                            </span>\n                                            <br>\n                                            <span class="defult-File-size">\n'+M+'M\n                                            </span>\n                                        </dd>\n                                <div class="up-file-Down" isme="false" file_id='+S+" file_number="+k+" file_title="+T+">下载\n                            </div>\n                                    </dl>\n                                </div>\n                            </div>\n                        </li>");if(1==g&&(e.friendStorage[c]+=o),e.friendStorage[c]+=ve,e.Groupmemberheadlibrary[C]="./images/Destroy.png",(fe=new FormData).append("chatroommemberwxid",p[0]),fe.append("socialaccountId",h),fe.append("temp",c),t({method:"POST",url:e.link1+"/message/getChatroommemberInfoByWxid",data:fe,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){if(200==a.code){if(ue=!0,""==a.data.chatroommember.profilePhoto);else{var t=a.data.chatroommember.profilePhoto;if(""==e.friendStorage[a.data.temp]||null==e.friendStorage[a.data.temp]||null==e.friendStorage[a.data.temp])var n=e.friendStorage[a.data.temp]=t;else n=e.friendStorage[a.data.temp].replace("./images/Destroy.png",t)}var i=a.data.chatroommember.chatroomMemberWxid;e.friendStorage[a.data.temp]=n,e.Groupmemberheadlibrary[i]=e.imgSrc+a.data.chatroommember.profilePhoto,e.WeChatoMembersNickname[a.data.chatroommember.chatroomMemberWxid]=a.data.chatroommember.memberName}}),e.Wasterecovery.hasOwnProperty(c)?e.Wasterecovery[c]=!0:e.Wasterecovery[c]=!1,0==e.Wasterecovery[c])(ye=new FormData).append("Cid",c),ye.append("accountId",e.myaccountId),ye.append("temp",v),t({method:"POST",url:e.link+"/latelychat/getContactByNumber",data:ye,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){if(200==a.code){var t=Number(a.data.tempData);if(1==t?p[1]:3==t?"[图片]":495==t&&"[图文链接]",""==a.data.contactList[0].profilePhoto)var n="./images/Destroy.png";else n=e.imgSrc+a.data.contactList[0].profilePhoto;var i=a.data.contactList[0].cid,s=a.data.contactList[0];s.profilePhoto=n,s.lastChatTime=e.getNowFormatDate(),re=s;var l="";1==t?(p[1],l=p[1]):3==t?(l="[图片]",""==p[1]?"./images/Destroy.png":e.imgSrc+p[1]):495==t?l="[图文链接]":496==t&&(l="[文件]");for(var r=0,o=!1,g=0;g<e.Chatwithfriends[-1].length;g++)e.Chatwithfriends[-1][g].cid==i&&(e.Chatwithfriends[-1][g].newMessage=l,o=!0),1==e.Chatwithfriends[-1][g].topNumber&&r++;1==o||(re.newMessage=l,1==re.topNumber?e.Chatwithfriends[-1].splice(0,0,re):e.Chatwithfriends[-1].splice(r,0,re));for(var m=0,u=!1,f=0;f<e.Chatwithfriends[h].length;f++)e.Chatwithfriends[h][f].cid==i&&(u=!0),1==e.Chatwithfriends[h][f].topNumber&&m++;1==u||(re.newMessage=l,1==re.topNumber?e.Chatwithfriends[h].splice(0,0,re):e.Chatwithfriends[h].splice(m,0,re)),e.frienfList="",e.Chatwithfriends[e.lplplpl].length>50?e.frienfList=e.Chatwithfriends[e.lplplpl].slice(0,50):e.frienfList=e.Chatwithfriends[e.lplplpl],1==ue&&d(I,l,n,c),setTimeout(function(){$(".page1-Maindiv2-myfriends-search-con-ul1").find(".page1-Maindiv2-myfriends-search-con-ul-tagname1").html(""),$(".page1-Maindiv2-myfriends-search-con-ul1").find(".new-msg-number").css("display","none").html("");var a=e.Chatwithfriends[e.lplplpl].length;a>50&&(a=50),$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+i+'"]').next().css("display","inline-block").html(1);for(var t=0;t<a;t++){var n=e.Chatwithfriends[e.lplplpl][t].cid;""!=e.Chatwithfriends[e.lplplpl][t].newMessage&&$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').html(e.Chatwithfriends[e.lplplpl][t].newMessage)}},100)}})}}else{var we="";z="";1==v?we=F:3==v&&(we="[图片]");var ye;pe="./images/Destroy.png";if(0==b)if(1==v){ve="";z=y,ve+='<li class="Unread" dataid='+w+'>\n<div class="nesHead">\n<img class="FromUserHeader" src="'+r+'" alt="" >\n                        </div>\n                        <div class="news">\n                            <img class="jiao" src="images/bluejiao.png" alt="">\n                            '+we+"\n                        </div>\n                    </li>"}else if(3==v){ve="";z="[图片]",ve+='<li class="Unread" dataid='+w+'>\n                        <div class="nesHead">\n                            <img class="FromUserHeader" src="'+r+'" alt="" >\n                        </div>\n                        <div class="news bigPicture"  data="'+w+'"data1='+k+'>\n                            <img class="jiao" src="images/bluejiao.png" alt="">\n                           <img class="up-Img-Add" src='+we+' alt="">\n                        </div>\n                    </li>'}else 495==v?(z="[图文链接]",ve+='                        <li class="Unread" dataid='+w+'>\n                        <div class="nesHead">\n                            <img class="FromUserHeader" src="'+r+'" alt="" >\n                        </div>\n                            <a href='+e.img_text_url+' target="_blank">\n                            <div class="news news-link">\n                                <img class="jiao" src="images/bluejiao.png" alt="">\n                                <div class="defult-Link-Add">\n                                    <span class="defult-Link-title">'+e.img_text_title+'</span>\n                                    <dl>\n                                        <dd>\n                                            <span class="up-file-con">\n                                        '+e.img_text_content+'    </span>\n                                        </dd>\n                                        <dt><img class="up-file-icon" src='+e.img_text_icon+"></dt>\n\n                                    </dl>\n                                </div>\n                            </div>\n                            </a>\n                        </li>"):496==v&&(z="[文件]",ve+='                        <li class="Unread" dataid='+w+'>\n                        <div class="nesHead">\n                            <img class="FromUserHeader" src="'+r+'" alt="" >\n                        </div>\n                            <div class="news">\n                                <img class="jiao" src="images/bluejiao.png" alt="">\n                                <div class="up-file-Add">\n                                    <dl>\n                                        <dt><img src="images/defult-File.png"></dt>\n                                        <dd>\n                                            <span class="defult-File-name">\n'+T+'\n                                            </span>\n                                            <br>\n                                            <span class="defult-File-size">\n'+M+'M\n                                            </span>\n                                        </dd>\n                                <div class="up-file-Down" isme="true" file_id='+S+" file_number="+k+" file_title="+T+">下载\n                            </div>\n                                    </dl>\n                                </div>\n                            </div>\n                        </li>");else if(1==v){ve="";z=y,ve+='<li class="Unread" dataid='+w+'>\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+pe+'" alt="" >\n                        </div>\n                        <div class="answers">\n                            <img class="jiao" src="images/whitejiao.png" alt="">\n                            '+we+"\n                        </div>\n                    </li>"}else if(3==v){ve="";z="[图片]",ve+='<li class="Unread" dataid='+w+'>\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+pe+'" alt="" >\n                        </div>\n                        <div class="answers bigPicture"  data="'+w+'"data1='+k+'>\n                            <img class="jiao" src="images/whitejiao.png" alt="">\n                           <img class="up-Img-Add" src='+we+' alt="">\n                        </div>\n                    </li>'}else 495==v?(z="[图文链接]",ve+='<li class="Unread" dataid='+w+'>\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+pe+'" alt="" >\n                        </div>\n                            <a href='+e.img_text_url+' target="_blank">\n                            <div class="answers news-link">\n                                <img class="jiao" src="images/whitejiao.png" alt="">\n                                <div class="defult-Link-Add">\n                                    <span class="defult-Link-title">'+e.img_text_title+'</span>\n                                    <dl>\n                                        <dd>\n                                            <span class="up-file-con">\n                                        '+e.img_text_content+'    </span>\n                                        </dd>\n                                        <dt><img class="up-file-icon" src='+e.img_text_icon+"></dt>\n\n                                    </dl>\n                                </div>\n                            </div>\n                            </a>\n                        </li>"):496==v&&(z="[文件]",ve+='                        <li class="Unread" dataid='+w+'>\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+pe+'" alt="" >\n                        </div>\n                            <div class="answers">\n                                <img class="jiao" src="images/whitejiao.png" alt="">\n                                <div class="up-file-Add">\n                                    <dl>\n                                        <dt><img src="images/defult-File.png"></dt>\n                                        <dd>\n                                            <span class="defult-File-name">\n'+T+'\n                                            </span>\n                                            <br>\n                                            <span class="defult-File-size">\n'+M+'M\n                                            </span>\n                                        </dd>\n                                <div class="up-file-Down" isme="false" file_id='+S+" file_number="+k+" file_title="+T+">下载\n                            </div>\n                                    </dl>\n                                </div>\n                            </div>\n                        </li>");1==g&&(e.friendStorage[c]+=o),e.friendStorage[c]+=ve,(ye=new FormData).append("Cid",c),ye.append("accountId",e.myaccountId),t({method:"POST",url:e.link+"/latelychat/getContactByNumber",data:ye,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){if(200==a.code){var t=e.imgSrc+a.data.contactList[0].profilePhoto,n=e.friendStorage[a.data.contactList[0].cid].replace("./images/Destroy.png",t);e.friendStorage[a.data.contactList[0].cid]=n;var i=e.imgSrc+a.data.contactList[0].profilePhoto,s=a.data.contactList[0];if(s.profilePhoto=i,s.newMessage=z,s.lastChatTime=e.getNowFormatDate(),1==(re=s).topNumber)if(re.newMessage=z,-1==e.lplplpl)e.Chatwithfriends[-1].splice(0,0,re),e.Chatwithfriends[re.socialaccountId].splice(0,0,re);else{for(var l=!1,r=0;r<e.Chatwithfriends[-1].length;r++){if(e.Chatwithfriends[-1][r].cid==c){e.Chatwithfriends[-1][r].newMessage=z,l=!0;break}l=!1}1==l?e.WeChatownersocialNumber[e.lplplpl]==k||e.Chatwithfriends[re.socialaccountId].splice(0,0,re):(e.WeChatownersocialNumber[e.lplplpl]==k||e.Chatwithfriends[re.socialaccountId].splice(0,0,re),e.Chatwithfriends[-1].splice(0,0,re))}else{re.newMessage=z;for(var o=0,p=0,h=0;h<e.Chatwithfriends[re.socialaccountId].length;h++)1==e.Chatwithfriends[re.socialaccountId][h].topNumber&&o++;for(h=0;h<e.Chatwithfriends[-1].length;h++)1==e.Chatwithfriends[-1][h].topNumber&&p++;if(-1==e.lplplpl)e.Chatwithfriends[-1].splice(p,0,re),e.Chatwithfriends[re.socialaccountId].splice(p,0,re);else{for(l=!1,r=0;r<e.Chatwithfriends[-1].length;r++){if(e.Chatwithfriends[-1][r].cid==c){e.Chatwithfriends[-1][r].newMessage=z,l=!0;break}l=!1}1==l?e.WeChatownersocialNumber[e.lplplpl]==k||e.Chatwithfriends[re.socialaccountId].splice(o,0,re):(e.WeChatownersocialNumber[e.lplplpl]==k||e.Chatwithfriends[re.socialaccountId].splice(o,0,re),e.Chatwithfriends[-1].splice(p,0,re))}}e.WeChatownersocialNumber[e.lplplpl]==k||(1==re.topNumber?e.Chatwithfriends[e.lplplpl].slice(0,0,re):e.Chatwithfriends[e.lplplpl].slice(e.TotopNum,0,re),e.Chatwithfriends[e.lplplpl].length>50?e.frienfList=e.Chatwithfriends[e.lplplpl].slice(0,50):e.frienfList=e.Chatwithfriends[e.lplplpl],setTimeout(function(){d(I,z,t,c),$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+re.cid+'"]').next().css("display","inline-block").html(1)},200))}})}}}setTimeout(function(){a()},2e3)}else 1e3==n.code&&(clearTimeout(u),$(".gray-help").css("display","block"),$(".gray-help-say").css("display","block"),$(".gray-help-say-con-text").html("您已在其他页面发起聊天，当前聊天失效"),$(".sure-nohave-phone").html("重连"))})}else setTimeout(function(){a()},2e3);else clearTimeout(u),$(".gray-help").css("display","block"),$(".gray-help-say").css("display","block"),$(".gray-help-say-con-text").html("登录超时，请再次登录"),$(".sure-nohave-phone").html("重连")})},5e3);e.Setup=!1,e.ChangeColor=function(e,a,t){if(1==a.length&&""==t)n="tageNo";else{var n="";n=e%3==0?"blueTag":e%2==0?"purpleTag":"purseTag"}return n},e.AllcustomerList=function(e){return 1==e?"send-msg":"add-people"},e.NmeSlice=function(e){return e.length>=8?e.slice(0,6)+"...":e},e.NmeSlice1=function(e){return e.length>=15?e.slice(0,15)+"......":e},e.chatrecord2=function(e){return 1==e||10==e?"Page4Nmame1-blue":"Page4Nmame1-green"},e.IstopInit=function(e){var a="";return 1==e&&(a="IstopInitAddColor"),a},e.sex=function(e){return 1==e?"男":2==e?"女":"未知"},e.groupListIsShow=function(e){var a="";return e<=0&&(a="groupListIsShow"),a},e.Characterdiscrimination=function(e,a){var t="";return 0==e?t="我":1==e?t=a:3==e?t="我":10==e&&(t=a),t},e.Getridofthechange=function(e,a){var t=e;return 3==a?t.replace(/<br>/g,"").replace(/&nbsp;/g," "):10==a?t.split(":<br>")[1].replace(/<br>/g,"").replace(/&nbsp;/g," "):t.replace(/<br>/g,"").replace(/&nbsp;/g," ")},e.GetridoftheNbsp=function(e){return e.replace(/&nbsp;/g," ")},e.getUser=function(a){return e.WeChatowner[a]},e.getLastTime=function(e){var a="";""==e||null==e||null==e?a="":":"==(a=e.slice(10,16)).charAt(a.length-1)&&(a=a.substring(0,4)+"0"+a.substring(3,a.length-1));return a},e.break_title_con=function(e){return e.length>=25?e.slice(0,25)+"...":e},e.Time_Slice=function(e){return e.substring(0,10)},e.getNowFormatDate=function(){var e=new Date,a=e.getMonth()+1,t=e.getDate();return a>=1&&a<=9&&(a="0"+a),t>=0&&t<=9&&(t="0"+t),e.getFullYear()+"-"+a+"-"+t+" "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()},e.isOnLine=function(e){return 0==e?"Account-number-logo-no":""}}]),app.config(["$routeProvider",function(e){e.when("/page1",{templateUrl:"view/page1.html",controller:"page1C"}).otherwise({redirectTo:"/page1"})}]),app.filter("orderObjectBy",["$rootScope",function(e){return function(e){var a=[],t=[];return angular.forEach(e,function(e,n){1==e.topNumber&&a.push(e),0==e.topNumber&&t.push(e)}),t.unshift.apply(t,a),t}}]),app.controller("loginC",["$rootScope","$scope","$http","$timeout",function(e,a,t,n){t.get(e.link+"/checkSession").success(function(e){200==e.code&&1==e.data&&(window.location.href="http://"+window.location.host+"/wgcs/#/page34")}),$(".side-bar1").hide(),$(".task-box").hide(),$(".view-box").css("height","60%"),e.mainShow=!1;var i=JSON.parse(localStorage.getItem("remember-me"));null==i||null==i.name||null==i.pas||null==i.name||null==i.pas?($(".remember-me-icon").removeClass("onhaha"),a.indexs=0,a.nameLogin="",a.pasLogin=""):($(".remember-me-icon").addClass("onhaha"),a.nameLogin=i.name,a.pasLogin=i.pas,a.indexs=1),$(".remember-me-icon").click(function(){a.indexs++,a.indexs%2==0?$(".remember-me-icon").removeClass("onhaha"):$(".remember-me-icon").addClass("onhaha")});var s=/^[a-zA-Z0-9_]{4,16}$/;$(".Verification-user").blur(function(){1==s.test(a.nameLogin)?$(".login-tishi").hide():(console.log(11,a.nameLogin),$(".login-tishi").show().html("用户名由4到16位(字母,数字,下划线,减号)组成"))});var d=/^[0-9a-zA-Z]{6,16}$/;$(".Verification-password").blur(function(){1==d.test(a.pasLogin)?$(".login-tishi").hide():(console.log(11,a.nameLogin),$(".login-tishi").show().html("密码由6到16位(字母,数字)组成"))}),a.sendMsg=function(){sessionStorage.getItem("za-session");if(0==d.test(a.pasLogin)||0==s.test(a.nameLogin))$(".login-tishi").show().html("用户名或密码不正确");else{var n=new FormData;n.append("username",a.nameLogin),n.append("password",a.pasLogin),t({method:"POST",url:e.link+"/login",data:n,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){if(200==e.code){if($(".remember-me-icon").hasClass("onhaha")){var t=JSON.stringify({name:a.nameLogin,pas:a.pasLogin});localStorage.setItem("remember-me",t)}else localStorage.removeItem("remember-me");localStorage.setItem("sessionId",e.data),window.location.href="http://"+window.location.host+"/wgcs/#/page34"}else $(".login-tishi").show().html(e.msg)})}}}]),app.controller("mainC",["$rootScope","$scope","$timeout","$location","$anchorScroll","$http",function(e,a,t,n,i,s){a.Exitsystem=function(){localStorage.removeItem("sessionId"),window.location.href="http://"+window.location.host+"/gcsscrm/#/page1?a=0"},a.IsShowSetup=function(a){0==$(a.target).attr("data")?(e.Setup=!0,$(a.target).attr("data",1)):($(a.target).attr("data",0),e.Setup=!1)},$(".page1-Maindiv1-msg").mouseover(function(){$(".page1-Maindiv1-telephonebook-Explain").css("display","inline-block")}),$(".page1-Maindiv1-msg").mouseout(function(){$(".page1-Maindiv1-telephonebook-Explain").css("display","none")}),$(".page1-Maindiv1-telephonebook").mouseover(function(){$(".page1-Maindiv1-group-Explain").css("display","inline-block")}),$(".page1-Maindiv1-telephonebook").mouseout(function(){$(".page1-Maindiv1-group-Explain").css("display","none")}),$(".page1-Maindiv1-group").mouseover(function(){$(".page1-Maindiv1-Setup-Explain").css("display","inline-block")}),$(".page1-Maindiv1-group").mouseout(function(){$(".page1-Maindiv1-Setup-Explain").css("display","none")}),a.ChatShow=function(){$(".page1-Maindiv1-msg").css("background",' url("./images/msg.png") center no-repeat'),$(".page1-Maindiv1-telephonebook").css("background",' url("./images/telephone-book.png") center no-repeat'),e.ChataddressbookswitchingBook=!1,e.ChataddressbookswitchingChat=!0},a.PhoeBookShow=function(){$(".personaldata-data-con-myself-1-input").attr("disabled","disabled").css("border","1px solid transparent"),$(".personaldata-data-con-myself-3-select").css("display","none"),$(".personaldata-data-con-myself-3-span").css("display","inline-block"),$(".personaldata-data-con-myself-5-textarea-whiteMeContent").attr("disabled","disabled").css("border","1px solid  transparent"),$(".edit-personaldata").html("修改资料").attr("data",0),$(".personaldata").css("display","none"),$(".page1-Maindiv1-telephonebook").css("background",' url("./images/telephoneBookCheck.png") center no-repeat'),$(".page1-Maindiv1-msg").css("background",' url("./images/MsgCheck.png") center no-repeat'),e.ChataddressbookswitchingBook=!0,e.ChataddressbookswitchingChat=!1;var t=new FormData;t.append("accountId",e.myaccountId),s({method:"POST",url:e.link+"/socialaccount/getSocialaccount",data:t,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){if(200==a.code){for(var t=0;t<a.data.socialaccountList.length;t++)""==a.data.socialaccountList[t].profilePhoto?a.data.socialaccountList[t].profilePhoto="./images/Destroy.png":a.data.socialaccountList[t].profilePhoto=e.imgSrc+a.data.socialaccountList[t].profilePhoto;if(e.MaillistInitData=a.data.socialaccountList,e.MaillistInitData.length>0){e.MaillistInitId=e.MaillistInitData[0].id,e.MaillistInitCId=e.MaillistInitData[0].cid,e.MaillistInitaccountId=e.MaillistInitData[0].accountId;var n=[];n.push(e.MaillistInitId);var i=new FormData;i.append("ids",JSON.stringify(n)),i.append("accountId",e.myaccountId),s({method:"POST",url:e.link+"/socialaccount/getChatroomAndContact",data:i,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){$(".Maillist-myfriends-li-bottom-line li").eq(0).css("background-color","rgba(68, 186, 246, 0.05)").siblings().css("background-color","rgb(255, 255, 255)"),e.searchReturnList=[[{name:"群"},[]],[{name:"A"},[]],[{name:"B"},[]],[{name:"C"},[]],[{name:"D"},[]],[{name:"E"},[]],[{name:"F"},[]],[{name:"G"},[]],[{name:"H"},[]],[{name:"I"},[]],[{name:"J"},[]],[{name:"K"},[]],[{name:"L"},[]],[{name:"M"},[]],[{name:"N"},[]],[{name:"O"},[]],[{name:"P"},[]],[{name:"Q"},[]],[{name:"R"},[]],[{name:"S"},[]],[{name:"T"},[]],[{name:"U"},[]],[{name:"V"},[]],[{name:"W"},[]],[{name:"X"},[]],[{name:"Y"},[]],[{name:"Z"},[]],[{name:"#"},[]]];for(var t=0;t<a.data.contactList.length;t++){""==a.data.contactList[t].profilePhoto||null==a.data.contactList[t].profilePhoto||null==a.data.contactList[t].profilePhoto?a.data.contactList[t].profilePhoto="./images/Destroy.png":a.data.contactList[t].profilePhoto=e.imgSrc+a.data.contactList[t].profilePhoto;for(var n=0;n<e.searchReturnList.length;n++)a.data.contactList[t].fristWord==e.searchReturnList[n][0].name&&e.searchReturnList[n][1].push(a.data.contactList[t])}})}}}),s({method:"POST",url:e.link+"/groups/getGroups",data:a.MyFrienddata,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){e.PhoneBookInformationGrouping=a.data.groupList,setTimeout(function(){$("#single1").multiselect({multiple:!1,selectedHtmlValue:"请选择",setWidth:"148px"})},0)})}}]),app.controller("page1C",["$rootScope","$scope","$http","$timeout","$compile",function(e,a,t,n,i){e.repeatNums=0,e.Identificationforthefirsttime=!1,e.ChataddressbookswitchingChat=!0,e.ChataddressbookswitchingBook=!1,a.addTag=!1,a.Customerinformation=!0,a.myself1=!0,a.myself=!1,a.quickReply=!1,a.allCustomerList=!1,a.searchCon=!1,a.quickReplyPhrase=!0,a.quickReplylibrary=!1,a.customerRecord=!1,a.chatRecord=!0,a.SearchkeywordsHistory=!1,a.page1Maindiv4Init=!0,$(".whiteMeContent").html("").attr("disabled",!0).css("background","#fff"),a.imgNew="",$(".chat-bottom-write").html(""),a.ChatModule=!1,a.MsgTimes=0,$("#btn1").click(function(){$(".emoji_container").html("").css({border:"none","background-color":"transparent","box-shadow":"none"}),$("#editor1").emoji({button:"#btn1",showTab:!1,animation:"none",icons:[{name:"QQ表情",path:"images/qq/",maxNum:91,file:".gif"}]})}),$(function(){$(".tree").treemenu({delay:300}).openActive()});var s=["[微笑]","[撇嘴]","[色]","[发呆]","[得意]","[流泪]","[害羞]","[闭嘴]","[睡]","[大哭]","[尴尬]","[发怒]","[调皮]","[呲牙]","[惊讶]","[难过]","[酷]","[冷汗]","[抓狂]","[吐]","[偷笑]","[愉快]","[白眼]","[傲慢]","[饥饿]","[困]","[惊恐]","[流汗]","[憨笑]","[悠闲]","[奋斗]","[咒骂]","[疑问]","[嘘]","[晕]","[疯了]","[衰]","[骷髅]","[敲打]","[再见]","[擦汗]","[抠鼻]","[鼓掌]","[糗大了]","[坏笑]","[左哼哼]","[右哼哼]","[哈欠]","[鄙视]","[委屈]","[快哭了]","[阴险]","[亲亲]","[吓]","[可怜]","[菜刀]","[啤酒]","[咖啡]","[饭]","[猪头]","[玫瑰]","[凋谢]","[嘴唇]","[爱心]","[心碎]","[蛋糕]","[闪电]","[炸弹]","[刀]","[足球]","[瓢虫]","[便便]","[拥抱]","[强]","[弱]","[握手]","[胜利]","[抱拳]","[勾引]","[拳头]","[差劲]","[爱你]","[NO]","[OK]","[跳跳]","[发抖]","[怄火]","[磕头]","[激动]","[献吻]"];$(".chat-bottom-write").on("paste",function(e){!function(e){var a;e.preventDefault();var t=(e.originalEvent||e).clipboardData;if(null==t){if(""!==(a=window.clipboardData.getData("text")||""))if(window.getSelection){var n=document.createElement("span");n.innerHTML=a,window.getSelection().getRangeAt(0).insertNode(n)}else document.selection.createRange().pasteHTML(a)}else""!==(a=t.getData("text/plain")||"")&&document.execCommand("insertText",!1,a)}(e)}),$(function(){setTimeout(function(){var e={".chosen-select":{},".chosen-select-deselect":{allow_single_deselect:!0},".chosen-select-no-single":{disable_search_threshold:10},".chosen-select-no-results":{no_results_text:"无匹配结果"},".chosen-select-width":{width:"95%"}};for(var a in e)$(a).chosen(e[a])},500)});var d=[],l=new FormData;l.append("accountId",e.myaccountId),t({method:"POST",url:e.link+"/socialaccount/getShowSocialaccount",data:l,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(t){if(200==t.code){for(var n=0;n<t.data.socialaccountList.length;n++)e.Chatwithfriends[t.data.socialaccountList[n].id]=[],e.WeChatowner[t.data.socialaccountList[n].id]=t.data.socialaccountList[n].nickName,e.WeChatownersocialNumber[t.data.socialaccountList[n].id]=t.data.socialaccountList[n].socialNumber,e.WeChatownerHeader[t.data.socialaccountList[n].id]=e.imgSrc+t.data.socialaccountList[n].profilePhoto,d.push(t.data.socialaccountList[n].id),a["IsP"+t.data.socialaccountList[n].id]=!1;a["Isp-1"]=!0}});var r=new FormData;r.append("accountId",e.myaccountId),t({method:"POST",url:e.link+"/latelychat/getRecentContactAndChatroom2",data:r,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){if(200==a.code)for(var t=0;t<d.length;t++){if(null==a.data[d[t]]||null==a.data[d[t]].length)a.data[d[t]]=[];else for(var n=0;n<a.data[d[t]].length;n++)if(a.data[d[t]][n].Deviceonline=1,""==a.data[d[t]][n].profilePhoto?a.data[d[t]][n].profilePhoto="./images/Destroy.png":a.data[d[t]][n].profilePhoto=e.imgSrc+a.data[d[t]][n].profilePhoto,a.data[d[t]][n].noReadMessage=n,a.data[d[t]][n].lastChatrecord==[]||null==a.data[d[t]][n].lastChatrecord)e.friendStorage[a.data[d[t]][n].cid]="",a.data[d[t]][n].newMessage="";else if(1==a.data[d[t]][n].lastChatrecord.length){var i=a.data[d[t]][n].profilePhoto,s="",l="",r="",o="",c="",p="",h="";if(3==a.data[d[t]][n].lastChatrecord[0].msgType?a.data[d[t]][n].newMessage="[图片]":495==a.data[d[t]][n].lastChatrecord[0].msgType?a.data[d[t]][n].newMessage="[图文链接]":496==a.data[d[t]][n].lastChatrecord[0].msgType&&(a.data[d[t]][n].newMessage="[文件]"),1==a.data[d[t]][n].type)if(10==a.data[d[t]][n].lastChatrecord[0].msgStatus){if(s=""==a.data[d[t]][n].lastChatrecord[0].profilephoto||null==a.data[d[t]][n].lastChatrecord[0].profilephoto?"./images/Destroy.png":e.imgSrc+a.data[d[t]][n].lastChatrecord[0].profilephoto,495==a.data[d[t]][n].lastChatrecord[0].msgType){var g=a.data[d[t]][n].lastChatrecord[0].chatMessage.content,m=a.data[d[t]][n].lastChatrecord[0].chatMessage.chatroommemberwxid;r=g,null==(o=e.WeChatoMembersNickname[m])&&(o=m)}else if(496==a.data[d[t]][n].lastChatrecord[0].msgType)c=a.data[d[t]][n].lastChatrecord[0].chatMessage.title,p=a.data[d[t]][n].lastChatrecord[0].chatMessage.filesize,h=a.data[d[t]][n].lastChatrecord[0].chatMessage.filepath;else if(3==a.data[d[t]][n].lastChatrecord[0].msgType);else if(1==a.data[d[t]][n].lastChatrecord[0].msgType){r=(C=a.data[d[t]][n].lastChatrecord[0].chatMessage.split(":<br>"))[1],a.data[d[t]][n].newMessage=r,null==(o=e.WeChatoMembersNickname[C[0]])&&(o=C[0])}}else 1==a.data[d[t]][n].lastChatrecord[0].msgType&&(1==a.data[d[t]][n].lastChatrecord[0].msgStatus&&(s=""==a.data[d[t]][n].lastChatrecord[0].profilephoto||null==a.data[d[t]][n].lastChatrecord[0].profilephoto?"./images/Destroy.png":e.imgSrc+a.data[d[t]][n].lastChatrecord[0].profilephoto),s=e.WeChatownerHeader[a.data[d[t]][n].socialaccountId],r=a.data[d[t]][n].lastChatrecord[0].chatMessage,a.data[d[t]][n].newMessage=r);else 496==a.data[d[t]][n].lastChatrecord[0].msgType&&(c=a.data[d[t]][n].lastChatrecord[0].chatMessage.title,p=a.data[d[t]][n].lastChatrecord[0].chatMessage.filesize,h=a.data[d[t]][n].lastChatrecord[0].chatMessage.filepath),1==a.data[d[t]][n].lastChatrecord[0].msgStatus||10==a.data[d[t]][n].lastChatrecord[0].msgStatus?""!=(s=i)&&null!=s||(s="./images/Destroy.png"):s=e.WeChatownerHeader[a.data[d[t]][n].socialaccountId],1==a.data[d[t]][n].lastChatrecord[0].msgType&&(r=a.data[d[t]][n].lastChatrecord[0].chatMessage,a.data[d[t]][n].newMessage=r),r=a.data[d[t]][n].lastChatrecord[0].chatMessage;var u=a.data[d[t]][n].lastChatrecord[0].msgStatus,f=a.data[d[t]][n].lastChatrecord[0].msgType,v=a.data[d[t]][n].lastChatrecord[0].msgid;a.data[d[t]][n].lastChatrecord[0].contactNickname;if(0==u||3==u)if(1==f)l+='<li class="Read" dataId="'+v+'"  isNew="false">\n<div class="nesHead">\n<img class="FromUserHeader" src="'+s+'" alt="" >\n                        </div>\n                        <div class="news">\n                            <img class="jiao" src="images/bluejiao.png" alt="">\n                            '+r+"\n                        </div>\n                    </li>";else if(3==f)l+='<li class="Read" dataId="'+v+'" isNew="false">\n                        <div class="nesHead">\n                            <img class="FromUserHeader" src="'+s+'" alt="" >\n                        </div>\n                        <div class="news bigPicture" data="" data1="">\n                            <img class="jiao" src="images/bluejiao.png" alt="">\n                           <img class="up-Img-Add" src='+r+' alt="">\n                        </div>\n                    </li>';else if(495==f){l+='                        <li class="Read" dataId="'+v+'" isNew="false">\n                            <div class="nesHead">\n                                <img src='+s+' alt="">\n                            </div>\n                            <a href='+(k=a.data[d[t]][n].lastChatrecord[0].chatMessage).url+' target="_blank">\n                            <div class="news news-link">\n                                <img class="jiao" src="images/bluejiao.png" alt="">\n                                <div class="defult-Link-Add">\n                                    <span class="defult-Link-title">'+k.title+'</span>\n                                    <dl>\n                                        <dd>\n                                            <span class="up-file-con">\n                                        '+k.content+'    </span>\n                                        </dd>\n                                        <dt><img class="up-file-icon" src="./images/link.png"></dt>\n\n                                    </dl>\n                                </div>\n                            </div>\n                            </a>\n                        </li>'}else 496==f&&(l+='                        <li class="Read" dataId="'+v+'" isNew="false">\n                        <div class="nesHead">\n                            <img class="FromUserHeader" src="'+s+'" alt="" >\n                        </div>\n                            <div class="news">\n                                <img class="jiao" src="images/bluejiao.png" alt="">\n                                <div class="up-file-Add">\n                                    <dl>\n                                        <dt><img src="images/defult-File.png"></dt>\n                                        <dd>\n                                            <span class="defult-File-name">\n'+c+'\n                                            </span>\n                                            <br>\n                                            <span class="defult-File-size">\n'+p+'M\n                                            </span>\n                                        </dd>\n                                <div class="up-file-Down" isNew="false"  isme="true"  file_id='+v+" file_title="+c+"  file_path="+h+">下载\n                            </div>\n                                    </dl>\n                                </div>\n                            </div>\n                        </li>");else if(10==u)if(1==f)l+='<li class="Read" dataId="'+v+'" isNew="false">\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+s+'" alt="" >\n                        </div>\n                        <div class="group_meber_name">\n                            '+o+'\n                        </div>\n                        <div class="answers">\n                            <img class="jiao" src="images/whitejiao.png" alt="">\n                            '+r+"\n                        </div>\n                    </li>";else if(3==f)l+='<li class="Read" dataId="'+v+'" isNew="false">\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+s+'" alt="" >\n                        </div>\n                        <div class="group_meber_name">\n                            '+o+'\n                        </div>\n                        <div class="answers bigPicture" data="" data1="">\n                            <img class="jiao" src="images/whitejiao.png" alt="">\n                           <img class="up-Img-Add" src='+r+' alt="">\n                        </div>\n                    </li>';else if(495==f){l+='                        <li class="Read" dataId="'+v+'" isNew="false">\n                            <div class="answerHead">\n                                <img  class="FromUserHeader" src='+s+' alt="">\n                            </div>\n                        <div class="group_meber_name">\n                            '+o+"\n                        </div>\n                            <a href="+(k=a.data[d[t]][n].lastChatrecord[0].chatMessage).url+' target="_blank">\n                            <div class="answers news-link">\n                                <img class="jiao" src="images/whitejiao.png" alt="">\n                                <div class="defult-Link-Add">\n                                    <span class="defult-Link-title">'+k.title+'</span>\n                                    <dl>\n                                        <dd>\n                                            <span class="up-file-con">\n                                        '+k.content+'    </span>\n                                        </dd>\n                                        <dt><img class="up-file-icon" src="./images/link.png"></dt>\n\n                                    </dl>\n                                </div>\n                            </div>\n                            </a>\n                        </li>'}else 496==f&&(l+='                        <li class="Read" dataId="'+v+'" isNew="false">\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+s+'" alt="" >\n                        </div>\n                            <div class="answers">\n                                <img class="jiao" src="images/whitejiao.png" alt="">\n                                <div class="up-file-Add">\n                                    <dl>\n                                        <dt><img src="images/defult-File.png"></dt>\n                                        <dd>\n                                            <span class="defult-File-name">\n'+c+'\n                                            </span>\n                                            <br>\n                                            <span class="defult-File-size">\n'+p+'M\n                                            </span>\n                                        </dd>\n                                <div class="up-file-Down" isNew="false" isme="false" file_id='+v+"  file_title="+c+" file_path="+h+" >下载\n                            </div>\n                                    </dl>\n                                </div>\n                            </div>\n                        </li>");else if(1==f)l+='<li class="Read" dataId="'+v+'" isNew="false">\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+s+'" alt="" >\n                        </div>\n                        <div class="answers">\n                            <img class="jiao" src="images/whitejiao.png" alt="">\n                            '+r+"\n                        </div>\n                    </li>";else if(3==f)l+='<li class="Read" dataId="'+v+'" isNew="false">\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+s+'" alt="" >\n                        </div>\n                        <div class="answers bigPicture" data="" data1="">\n                            <img class="jiao" src="images/whitejiao.png" alt="">\n                           <img class="up-Img-Add" src='+r+' alt="">\n                        </div>\n                    </li>';else if(495==f){l+='                        <li class="answerHead" dataId="'+v+'" isNew="false">\n                            <div class="FromUserHeader">\n                                <img src='+s+' alt="">\n                            </div>\n                            <a href='+(k=a.data[d[t]][n].lastChatrecord[0].chatMessage).url+' target="_blank">\n                            <div class="answers news-link">\n                                <img class="jiao" src="images/whitejiao.png" alt="">\n                                <div class="defult-Link-Add">\n                                    <span class="defult-Link-title">'+k.title+'</span>\n                                    <dl>\n                                        <dd>\n                                            <span class="up-file-con">\n                                        '+k.content+'    </span>\n                                        </dd>\n                                        <dt><img class="up-file-icon" src="./images/link.png"></dt>\n\n                                    </dl>\n                                </div>\n                            </div>\n                            </a>\n                        </li>'}else 496==f&&(l+='                        <li class="Read" dataId="'+v+'" isNew="false">\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+s+'" alt="" >\n                        </div>\n                            <div class="answers">\n                                <img class="jiao" src="images/whitejiao.png" alt="">\n                                <div class="up-file-Add">\n                                    <dl>\n                                        <dt><img src="images/defult-File.png"></dt>\n                                        <dd>\n                                            <span class="defult-File-name">\n'+c+'\n                                            </span>\n                                            <br>\n                                            <span class="defult-File-size">\n'+p+'M\n                                            </span>\n                                        </dd>\n                                <div class="up-file-Down" isNew="false" isme="false" file_id='+v+"  file_title="+c+"  file_path="+h+" >下载\n                            </div>\n                                    </dl>\n                                </div>\n                            </div>\n                        </li>");e.friendStorage[a.data[d[t]][n].cid]+=l}else{var w=!1,y=(s="",o="",a.data[d[t]][n].lastChatrecord.length);c="",p="",h="";if(y>20){var b=y-20;w=!0}else w=!1;for(var $=0;$<a.data[d[t]][n].lastChatrecord.length;$++){i=a.data[d[t]][n].profilePhoto,r="";if(3==a.data[d[t]][n].lastChatrecord[$].msgType?a.data[d[t]][n].newMessage="[图片]":495==a.data[d[t]][n].lastChatrecord[$].msgType?a.data[d[t]][n].newMessage="[图文链接]":496==a.data[d[t]][n].lastChatrecord[$].msgType&&(a.data[d[t]][n].newMessage="[文件]"),1==a.data[d[t]][n].type)if(10==a.data[d[t]][n].lastChatrecord[$].msgStatus){if(s=""==a.data[d[t]][n].lastChatrecord[$].profilephoto||null==a.data[d[t]][n].lastChatrecord[$].profilephoto?"./images/Destroy.png":e.imgSrc+a.data[d[t]][n].lastChatrecord[$].profilephoto,495==a.data[d[t]][n].lastChatrecord[$].msgType){g=a.data[d[t]][n].lastChatrecord[$].chatMessage.content,m=a.data[d[t]][n].lastChatrecord[$].chatMessage.chatroommemberwxid;r=g,null==(o=e.WeChatoMembersNickname[m])&&(o=m)}else if(496==a.data[d[t]][n].lastChatrecord[$].msgType)c=a.data[d[t]][n].lastChatrecord[$].chatMessage.title,p=a.data[d[t]][n].lastChatrecord[$].chatMessage.filesize,h=a.data[d[t]][n].lastChatrecord[$].chatMessage.filepath;else if(1==a.data[d[t]][n].lastChatrecord[$].msgType){var C;r=(C=a.data[d[t]][n].lastChatrecord[$].chatMessage.split(":<br>"))[1],a.data[d[t]][n].newMessage=r,null==(o=e.WeChatoMembersNickname[C[0]])&&(o=C[0])}}else 1==a.data[d[t]][n].lastChatrecord[$].msgType&&(10==a.data[d[t]][n].lastChatrecord[$].msgStatus&&(s=""==a.data[d[t]][n].lastChatrecord[$].profilephoto||null==a.data[d[t]][n].lastChatrecord[$].profilephoto?"./images/Destroy.png":e.imgSrc+a.data[d[t]][n].lastChatrecord[$].profilephoto),s=e.WeChatownerHeader[a.data[d[t]][n].socialaccountId],r=a.data[d[t]][n].lastChatrecord[$].chatMessage,a.data[d[t]][n].newMessage=r);else 496==a.data[d[t]][n].lastChatrecord[$].msgType&&(c=a.data[d[t]][n].lastChatrecord[$].chatMessage.title,p=a.data[d[t]][n].lastChatrecord[$].chatMessage.filesize,h=a.data[d[t]][n].lastChatrecord[$].chatMessage.filepath),1==a.data[d[t]][n].lastChatrecord[$].msgStatus||10==a.data[d[t]][n].lastChatrecord[$].msgStatus?""!=(s=i)&&null!=s||(s="./images/Destroy.png"):s=e.WeChatownerHeader[a.data[d[t]][n].socialaccountId],1==a.data[d[t]][n].lastChatrecord[$].msgType&&(r=a.data[d[t]][n].lastChatrecord[$].chatMessage,a.data[d[t]][n].newMessage=r),r=a.data[d[t]][n].lastChatrecord[$].chatMessage;l="",u=a.data[d[t]][n].lastChatrecord[$].msgStatus,f=a.data[d[t]][n].lastChatrecord[$].msgType,v=a.data[d[t]][n].lastChatrecord[$].msgid;if(0==w)if(0==u||3==u)if(1==f)l+='<li class="Read" dataId="'+v+'" isNew="false">\n<div class="nesHead">\n<img class="FromUserHeader" src="'+s+'" alt="" >\n                        </div>\n                        <div class="news">\n                            <img class="jiao" src="images/bluejiao.png" alt="">\n                            '+r+"\n                        </div>\n                    </li>";else if(3==f)l+='<li class="Read" dataId="'+v+'" isNew="false">\n                        <div class="nesHead">\n                            <img class="FromUserHeader" src="'+s+'" alt="" >\n                        </div>\n                        <div class="news bigPicture" data="" data1="">\n                            <img class="jiao" src="images/bluejiao.png" alt="">\n                           <img class="up-Img-Add" src='+r+">\n                        </div>\n                    </li>";else if(495==f){l+='                        <li class="Read" dataId="'+v+'" isNew="false">\n                            <div class="nesHead">\n                                <img class="FromUserHeader"  alt="" src="'+s+'">\n                            </div>\n                            <a href='+(k=a.data[d[t]][n].lastChatrecord[$].chatMessage).url+' target="_blank">\n                            <div class="news news-link">\n                                <img class="jiao" src="images/bluejiao.png" alt="">\n                                <div class="defult-Link-Add">\n                                    <span class="defult-Link-title">'+k.title+'</span>\n                                    <dl>\n                                        <dd>\n                                            <span class="up-file-con">\n                                        '+k.content+'    </span>\n                                        </dd>\n                                        <dt><img class="up-file-icon" src="./images/link.png"></dt>\n\n                                    </dl>\n                                </div>\n                            </div>\n                            </a>\n                        </li>'}else 496==f&&(l+='                        <li class="Read" dataId="'+v+'" isNew="false">\n                        <div class="nesHead">\n                            <img class="FromUserHeader" src="'+s+'" alt="" >\n                        </div>\n                            <div class="news">\n                                <img class="jiao" src="images/bluejiao.png" alt="">\n                                <div class="up-file-Add">\n                                    <dl>\n                                        <dt><img src="images/defult-File.png"></dt>\n                                        <dd>\n                                            <span class="defult-File-name">\n'+c+'\n                                            </span>\n                                            <br>\n                                            <span class="defult-File-size">\n'+p+'M\n                                            </span>\n                                        </dd>\n                                <div class="up-file-Down" isNew="false" isme="true" file_id='+v+"  file_title="+c+" file_path="+h+" >下载\n                            </div>\n                                    </dl>\n                                </div>\n                            </div>\n                        </li>");else if(10==u)if(1==f)l+='<li class="Read" dataId="'+v+'" isNew="false">\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+s+'" alt="" >\n                        </div>\n                        <div class="group_meber_name">\n                            '+o+'\n                        </div>\n                        <div class="answers">\n                            <img class="jiao" src="images/whitejiao.png" alt="">\n                            '+r+"\n                        </div>\n                    </li>";else if(3==f)l+='<li class="Read" dataId="'+v+'" isNew="false">\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+s+'" alt="" >\n                        </div>\n                        <div class="group_meber_name">\n                            '+o+'\n                        </div>\n                        <div class="answers bigPicture" data="" data1="">\n                            <img class="jiao" src="images/whitejiao.png" alt="">\n                           <img class="up-Img-Add" src='+r+">\n                        </div>\n                    </li>";else if(495==f){l+='                        <li class="Read" dataId="'+v+'" isNew="false">\n                            <div class="answerHead">\n                                <img class="FromUserHeader" alt="" src="'+s+'">\n                            </div>\n                        <div class="group_meber_name">\n                            '+o+"\n                        </div>\n                            <a href="+(k=a.data[d[t]][n].lastChatrecord[$].chatMessage).url+' target="_blank">\n                            <div class="answers news-link">\n                                <img class="jiao" src="images/whitejiao.png" alt="">\n                                <div class="defult-Link-Add">\n                                    <span class="defult-Link-title">'+k.title+'</span>\n                                    <dl>\n                                        <dd>\n                                            <span class="up-file-con">\n                                        '+k.content+'    </span>\n                                        </dd>\n                                        <dt><img class="up-file-icon" src="./images/link.png"></dt>\n\n                                    </dl>\n                                </div>\n                            </div>\n                            </a>\n                        </li>'}else 496==f&&(l+='                        <li class="Read" dataId="'+v+'" isNew="false">\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+s+'" alt="" >\n                        </div>\n                            <div class="answers">\n                                <img class="jiao" src="images/whitejiao.png" alt="">\n                                <div class="up-file-Add">\n                                    <dl>\n                                        <dt><img src="images/defult-File.png"></dt>\n                                        <dd>\n                                            <span class="defult-File-name">\n'+c+'\n                                            </span>\n                                            <br>\n                                            <span class="defult-File-size">\n'+p+'M\n                                            </span>\n                                        </dd>\n                                <div class="up-file-Down" isNew="false" isme="false" file_id='+v+" file_path="+h+"   file_title="+c+">下载\n                            </div>\n                                    </dl>\n                                </div>\n                            </div>\n                        </li>");else if(1==f)l+='<li class="Read" dataId="'+v+'" isNew="false">\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+s+'" alt="" >\n                        </div>\n                        <div class="answers">\n                            <img class="jiao" src="images/whitejiao.png" alt="">\n                            '+r+"\n                        </div>\n                    </li>";else if(3==f)l+='<li class="Read" dataId="'+v+'" isNew="false">\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+s+'" alt="" >\n                        </div>\n                        <div class="answers bigPicture" data="" data1="">\n                            <img class="jiao" src="images/whitejiao.png" alt="">\n                         <img class="up-Img-Add" src='+r+"  >\n                        </div>\n                    </li>";else if(495==f){l+='                        <li class="Read" dataId="'+v+'" isNew="false">\n                            <div class="answerHead">\n                                <img class="FromUserHeader" src="'+s+'" alt="">\n                            </div>\n                            <a href='+(k=a.data[d[t]][n].lastChatrecord[$].chatMessage).url+' target="_blank">\n                            <div class="answers news-link">\n                                <img class="jiao" src="images/bluejiao.png" alt="">\n                                <div class="defult-Link-Add">\n                                    <span class="defult-Link-title">'+k.title+'</span>\n                                    <dl>\n                                        <dd>\n                                            <span class="up-file-con">\n                                        '+k.content+'    </span>\n                                        </dd>\n                                        <dt><img class="up-file-icon" src="./images/link.png"></dt>\n\n                                    </dl>\n                                </div>\n                            </div>\n                            </a>\n                        </li>'}else 496==f&&(l+='                        <li class="Read" dataId="'+v+'" isNew="false">\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+s+'" alt="" >\n                        </div>\n                            <div class="answers">\n                                <img class="jiao" src="images/whitejiao.png" alt="">\n                                <div class="up-file-Add">\n                                    <dl>\n                                        <dt><img src="images/defult-File.png"></dt>\n                                        <dd>\n                                            <span class="defult-File-name">\n'+c+'\n                                            </span>\n                                            <br>\n                                            <span class="defult-File-size">\n'+p+'M\n                                            </span>\n                                        </dd>\n                                <div class="up-file-Down" isNew="false" isme="false" file_id='+v+"   file_title="+c+" file_path="+h+" >下载\n                            </div>\n                                    </dl>\n                                </div>\n                            </div>\n                        </li>");else if($>=b)if(0==u||3==u)if(1==f)l+='<li class="Read" dataId="'+v+'" isNew="false">\n<div class="nesHead">\n<img class="FromUserHeader" src="'+s+'" alt="" >\n                        </div>\n                        <div class="news">\n                            <img class="jiao" src="images/bluejiao.png" alt="">\n                            '+r+"\n                        </div>\n                    </li>";else if(3==f)l+='<li class="Read" dataId="'+v+'" isNew="false">\n                        <div class="nesHead">\n                            <img class="FromUserHeader" src="'+s+'" alt="" >\n                        </div>\n                        <div class="news bigPicture" data="" data1="">\n                            <img class="jiao" src="images/bluejiao.png" alt="">\n                          <img class="up-Img-Add" src= '+r+">\n                         </div>\n                    </li>";else if(495==f){l+='                        <li class="Read" dataId="'+v+'" isNew="false">\n                            <div class="nesHead">\n                                <img class="FromUserHeader" src="'+s+'" alt="">\n                            </div>\n                            <a href='+(k=a.data[d[t]][n].lastChatrecord[$].chatMessage).url+' target="_blank">\n                            <div class="news news-link">\n                                <img class="jiao" src="images/bluejiao.png" alt="">\n                                <div class="defult-Link-Add">\n                                    <span class="defult-Link-title">'+k.title+'</span>\n                                    <dl>\n                                        <dd>\n                                            <span class="up-file-con">\n                                        '+k.content+'    </span>\n                                        </dd>\n                                        <dt><img class="up-file-icon" src="./images/link.png"></dt>\n\n                                    </dl>\n                                </div>\n                            </div>\n                            </a>\n                        </li>'}else 496==f&&(l+='                        <li class="Read" dataId="'+v+'" isNew="false">\n                        <div class="nesHead">\n                            <img class="FromUserHeader" src="'+s+'" alt="" >\n                        </div>\n                            <div class="news">\n                                <img class="jiao" src="images/bluejiao.png" alt="">\n                                <div class="up-file-Add">\n                                    <dl>\n                                        <dt><img src="images/defult-File.png"></dt>\n                                        <dd>\n                                            <span class="defult-File-name">\n'+c+'\n                                            </span>\n                                            <br>\n                                            <span class="defult-File-size">\n'+p+'M\n                                            </span>\n                                        </dd>\n                                <div class="up-file-Down" isNew="false" isme="true" file_id='+v+" file_path="+h+"   file_title="+c+">下载\n                            </div>\n                                    </dl>\n                                </div>\n                            </div>\n                        </li>");else if(10==u)if(1==f)l+='<li class="Read" dataId="'+v+'" isNew="false">\n                        <div class="answerHead">\n                            <img class="FromUserHeader"  alt=""src="'+s+'"  >\n                        </div>\n                        <div class="group_meber_name">\n                            '+o+'\n                        </div>\n                        <div class="answers">\n                            <img class="jiao" src="images/whitejiao.png" alt="">\n                            '+r+"\n                        </div>\n                    </li>";else if(3==f)l+='<li class="Read" dataId="'+v+'" isNew="false">\n                        <div class="answerHead">\n                            <img class="FromUserHeader" alt="" src="'+s+'" >\n                        </div>\n                        <div class="group_meber_name">\n                            '+o+'\n                        </div>\n                        <div class="answers bigPicture" data="" data1="">\n                            <img class="jiao" src="images/whitejiao.png" alt="">\n                         <img class="up-Img-Add" src= '+r+">\n                         </div>\n                    </li>";else if(495==f){l+='                        <li class="Read" dataId="'+v+'" isNew="false">\n                            <div class="answerHead">\n                                <img class="FromUserHeader" alt="" src="'+s+'">\n                            </div>\n                        <div class="group_meber_name">\n                            '+o+"\n                        </div>\n                            <a href="+(k=a.data[d[t]][n].lastChatrecord[$].chatMessage).url+' target="_blank">\n                            <div class="answers news-link">\n                                <img class="jiao" src="images/whitejiao.png" alt="">\n                                <div class="defult-Link-Add">\n                                    <span class="defult-Link-title">'+k.title+'</span>\n                                    <dl>\n                                        <dd>\n                                            <span class="up-file-con">\n                                        '+k.content+'    </span>\n                                        </dd>\n                                        <dt><img class="up-file-icon" src="./images/link.png"></dt>\n\n                                    </dl>\n                                </div>\n                            </div>\n                            </a>\n                        </li>'}else 496==f&&(l+='                        <li class="Read" dataId="'+v+'" isNew="false">\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+s+'" alt="" >\n                        </div>\n                            <div class="answers">\n                                <img class="jiao" src="images/whitejiao.png" alt="">\n                                <div class="up-file-Add">\n                                    <dl>\n                                        <dt><img src="images/defult-File.png"></dt>\n                                        <dd>\n                                            <span class="defult-File-name">\n'+c+'\n                                            </span>\n                                            <br>\n                                            <span class="defult-File-size">\n'+p+'M\n                                            </span>\n                                        </dd>\n                                <div class="up-file-Down" isNew="false" isme="false" file_id='+v+"   file_path="+h+"   file_title="+c+">下载\n                            </div>\n                                    </dl>\n                                </div>\n                            </div>\n                        </li>");else if(1==f)l+='<li class="Read" dataId="'+v+'" isNew="false">\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+s+'" alt="" >\n                        </div>\n                        <div class="answers">\n                            <img class="jiao" src="images/whitejiao.png" alt="">\n                            '+r+"\n                        </div>\n                    </li>";else if(3==f)l+='<li class="Read" dataId="'+v+'" isNew="false">\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+s+'" alt="" >\n                        </div>\n                        <div class="answers bigPicture" data="" data1="">\n                            <img class="jiao" src="images/whitejiao.png" alt="">\n                         <img class="up-Img-Add" src= '+r+">\n                         </div>\n                    </li>";else if(495==f){l+='                        <li class="Read" dataId="'+v+'" isNew="false">\n                            <div class="answerHead">\n                                <img class="FromUserHeader"  src="'+s+'" alt="">\n                            </div>\n                            <a href='+(k=a.data[d[t]][n].lastChatrecord[$].chatMessage).url+' target="_blank">\n                            <div class="answers news-link">\n                                <img class="jiao" src="images/whitejiao.png" alt="">\n                                <div class="defult-Link-Add">\n                                    <span class="defult-Link-title">'+k.title+'</span>\n                                    <dl>\n                                        <dd>\n                                            <span class="up-file-con">\n                                        '+k.content+'    </span>\n                                        </dd>\n                                        <dt><img class="up-file-icon" src="./images/link.png"></dt>\n\n                                    </dl>\n                                </div>\n                            </div>\n                            </a>\n                        </li>'}else 496==f&&(l+='                        <li class="Read" dataId="'+v+'" isNew="false">\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+s+'" alt="" >\n                        </div>\n                            <div class="answers">\n                                <img class="jiao" src="images/whitejiao.png" alt="">\n                                <div class="up-file-Add">\n                                    <dl>\n                                        <dt><img src="images/defult-File.png"></dt>\n                                        <dd>\n                                            <span class="defult-File-name">\n'+c+'\n                                            </span>\n                                            <br>\n                                            <span class="defult-File-size">\n'+p+'M\n                                            </span>\n                                        </dd>\n                                <div class="up-file-Down" isNew="false" isme="false" file_id='+v+"   file_title="+c+" file_path="+h+">下载\n                            </div>\n                                    </dl>\n                                </div>\n                            </div>\n                        </li>");else if(0==u||3==u)if(1==f)l+='<li class="Read initNone" dataId="'+v+'" isNew="false">\n<div class="nesHead">\n<img class="FromUserHeader" src="'+s+'" alt="" >\n                        </div>\n                        <div class="news">\n                            <img class="jiao" src="images/bluejiao.png" alt="">\n                            '+r+"\n                        </div>\n                    </li>";else if(3==f)l+='<li class="Read initNone" dataId="'+v+'" isNew="false">\n                        <div class="nesHead">\n                            <img class="FromUserHeader" src="'+s+'" alt="" >\n                        </div>\n                        <div class="news bigPicture" data="" data1="">\n                            <img class="jiao" src="images/bluejiao.png" alt="">\n                         <img class="up-Img-Add" src='+r+">\n                         </div>\n                    </li>";else if(495==f){l+='                        <li class="Read initNone" dataId="'+v+'" isNew="false">\n                            <div class="nesHead">\n                                <img class="FromUserHeader" src="'+s+'" alt="">\n                            </div>\n                            <a href='+(k=a.data[d[t]][n].lastChatrecord[$].chatMessage).url+' target="_blank">\n                            <div class="news news-link">\n                                <img class="jiao" src="images/bluejiao.png" alt="">\n                                <div class="defult-Link-Add">\n                                    <span class="defult-Link-title">'+k.title+'</span>\n                                    <dl>\n                                        <dd>\n                                            <span class="up-file-con">\n                                        '+k.content+'    </span>\n                                        </dd>\n                                        <dt><img class="up-file-icon" src="./images/link.png"></dt>\n\n                                    </dl>\n                                </div>\n                            </div>\n                            </a>\n                        </li>'}else 496==f&&(l+='                        <li class="Read" dataId="'+v+'" isNew="false">\n                        <div class="nesHead">\n                            <img class="FromUserHeader" src="'+s+'" alt="" >\n                        </div>\n                            <div class="news">\n                                <img class="jiao" src="images/bluejiao.png" alt="">\n                                <div class="up-file-Add">\n                                    <dl>\n                                        <dt><img src="images/defult-File.png"></dt>\n                                        <dd>\n                                            <span class="defult-File-name">\n'+c+'\n                                            </span>\n                                            <br>\n                                            <span class="defult-File-size">\n'+p+'M\n                                            </span>\n                                        </dd>\n                                <div class="up-file-Down" isNew="false" isme="true" file_id='+v+"  file_title="+c+"  file_path="+h+">下载1\n                            </div>\n                                    </dl>\n                                </div>\n                            </div>\n                        </li>");else if(10==u)if(1==f)l+='<li class="Read" dataId="'+v+'" isNew="false">\n                        <div class="answerHead">\n                            <img class="FromUserHeader" alt="" src="'+s+'"  >\n                        </div>\n                        <div class="group_meber_name">\n                            '+o+'\n                        </div>\n                        <div class="answers">\n                            <img class="jiao" src="images/whitejiao.png" alt="">\n                            '+r+"\n                        </div>\n                    </li>";else if(3==f)l+='<li class="Read" dataId="'+v+'" isNew="false">\n                        <div class="answerHead">\n                            <img class="FromUserHeader"  alt="" src="'+s+'" >\n                        </div>\n                        <div class="group_meber_name">\n                            '+o+'\n                        </div>\n                        <div class="answers bigPicture" data="" data1="">\n                            <img class="jiao" src="images/whitejiao.png" alt="">\n                          <img class="up-Img-Add" src= '+r+" >\n                         </div>\n                    </li>";else if(495==f){l+='                        <li class="Read" dataId="'+v+'" isNew="false">\n                            <div class="answerHead">\n                                <img class="FromUserHeader"  alt=""  src="'+s+'">\n                            </div>\n                        <div class="group_meber_name">\n                            '+o+"\n                        </div>\n                            <a href="+(k=a.data[d[t]][n].lastChatrecord[$].chatMessage).url+' target="_blank">\n                            <div class="answers news-link">\n                                <img class="jiao" src="images/whitejiao.png" alt="">\n                                <div class="defult-Link-Add">\n                                    <span class="defult-Link-title">'+k.title+'</span>\n                                    <dl>\n                                        <dd>\n                                            <span class="up-file-con">\n                                        '+k.content+'    </span>\n                                        </dd>\n                                        <dt><img class="up-file-icon" src="./images/link.png"></dt>\n\n                                    </dl>\n                                </div>\n                            </div>\n                            </a>\n                        </li>'}else 496==f&&(l+='                        <li class="Read" dataId="'+v+'" isNew="false">\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+s+'" alt="" >\n                        </div>\n                            <div class="answers">\n                                <img class="jiao" src="images/whitejiao.png" alt="">\n                                <div class="up-file-Add">\n                                    <dl>\n                                        <dt><img src="images/defult-File.png"></dt>\n                                        <dd>\n                                            <span class="defult-File-name">\n'+c+'\n                                            </span>\n                                            <br>\n                                            <span class="defult-File-size">\n'+p+'M\n                                            </span>\n                                        </dd>\n                                <div class="up-file-Down" isNew="false" isme="false" file_id='+v+"file_title="+c+" file_path="+h+">下载\n                            </div>\n                                    </dl>\n                                </div>\n                            </div>\n                        </li>");else if(1==f)l+='<li class="Read initNone" dataId="'+v+'" isNew="false">\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+s+'" alt="" >\n                        </div>\n                        <div class="answers">\n                            <img class="jiao" src="images/whitejiao.png" alt="">\n                            '+r+"\n                        </div>\n                    </li>";else if(3==f)l+='<li class="Read initNone" dataId="'+v+'" isNew="false">\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+s+'" alt="" >\n                        </div>\n                        <div class="answers bigPicture" data="" data1="">\n                            <img class="jiao" src="images/whitejiao.png" alt="">\n                          <img class="up-Img-Add" src= '+r+">\n                        </div>\n                    </li>";else if(495==f){var k;l+='                        <li class="Read initNone" dataId="'+v+'"  isNew="false">\n                            <div class="answerHead">\n                                <img class="FromUserHeader"  alt="" src="'+s+'">\n                            </div>\n                            <a href='+(k=a.data[d[t]][n].lastChatrecord[$].chatMessage).url+' target="_blank">\n                            <div class="answers news-link">\n                                <img class="jiao" src="images/whitejiao.png" alt="">\n                                <div class="defult-Link-Add">\n                                    <span class="defult-Link-title">'+k.title+'</span>\n                                    <dl>\n                                        <dd>\n                                            <span class="up-file-con">\n                                        '+k.content+'    </span>\n                                        </dd>\n                                        <dt><img class="up-file-icon" src="./images/link.png"></dt>\n\n                                    </dl>\n                                </div>\n                            </div>\n                            </a>\n                        </li>'}else 496==f&&(l+='                        <li class="Read" dataId="'+v+'" isNew="false">\n                        <div class="answerHead">\n                            <img class="FromUserHeader" src="'+s+'" alt="" >\n                        </div>\n                            <div class="answers">\n                                <img class="jiao" src="images/whitejiao.png" alt="">\n                                <div class="up-file-Add">\n                                    <dl>\n                                        <dt><img src="images/defult-File.png"></dt>\n                                        <dd>\n                                            <span class="defult-File-name">\n'+c+'\n                                            </span>\n                                            <br>\n                                            <span class="defult-File-size">\n'+p+'M\n                                            </span>\n                                        </dd>\n                                <div class="up-file-Down" isNew="false" isme="false" file_id='+v+" file_title="+c+" file_path="+h+">下载\n                            </div>\n                                    </dl>\n                                </div>\n                            </div>\n                        </li>");e.friendStorage[a.data[d[t]][n].cid]+=l}}e.Chatwithfriends[d[t]]=a.data[d[t]]}}),a.Initializationandpostoperationrecords=!0,a.iNtadsa=!0,e.lplplpl=-1;var o="";$(".page1-Maindiv2").on("click",".newSelect",function(){$(".page1-Maindiv3").attr("data",""),$(".page1-Maindiv2-myfriends-search-con-ul-tagname1").html(""),!1,e.watchThis=$(".page1-Maindiv2 .newSelectTitle span").html(),e.watchThis;for(var n,i=$(".page1-Maindiv2 .select1"),d=0;d<i.length;d++)$(".select1").eq(d).html()==e.watchThis&&(o=$(".select1").eq(d).attr("data-value"),e.lplplpl=o);-1==o?(a.Initializationandpostoperationrecords=!0,a.page1Maindiv4Init=!0,a.ChatModule=!1,$(".chat-bottom-write").html(""),$(".page1-Maindiv3").css("background",'url("../images/chatBg.png") center no-repeat'),0==a["Isp-1"]?(e.firendList=new FormData,e.firendList.append("accountId",e.myaccountId),t({method:"POST",url:e.link+"/latelyChatroom/getRecentContactAndChatroom",data:e.firendList,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){e.TotopNum=a.data.sumtop-1}),a.$apply(function(){e.frienfList=e.Chatwithfriends[-1],$(".page1-Maindiv2-myfriends-search-con-ul1 li").removeClass("click-background-color")}),a["Isp-1"]=!0):(e.Identificationforthefirsttime=!0,e.lpkn=new FormData,e.lpkn.append("accountId",e.myaccountId),t({method:"POST",url:e.link+"/latelyChatroom/getRecentContactAndChatroom",data:e.lpkn,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){e.TotopNum=a.data.sumtop-1,$(".newAdds").remove(),e.frienfList=[],e.frienfList=e.Chatwithfriends[o],setTimeout(function(){for(var a=0;a<e.Chatwithfriends[o].length;a++){var t=e.Chatwithfriends[o][a].cid;e.Chatwithfriends[o][a].newMessage;if(""!=e.Chatwithfriends[o][a].newMessage&&null!=e.Chatwithfriends[o][a].newMessage){var n=e.Chatwithfriends[o][a].newMessage;if(null==n||""==n)$(".page1-Maindiv2 .wechatList .moveFriendList").find('span[data^="'+t+'"]').html("");else{var i=n.match(/\[[^\]]+\]/g);if(null==i||0==i||null==i)e.Chatwithfriends[o][a].newMessage=e.Chatwithfriends[o][a].newMessage.replace(/<br>/g,"");else{for(var d=[],l=[],r=0;r<i.length;r++)for(var c=0;c<s.length;c++)i[r]==s[c]&&(d.push('<img class="emoji_icon" src="images/qq/'+(c+1)+'.gif">'),l.push(s[c]));for(var p=0;p<d.length;p++)n=n.replace(l[p],d[p]);e.Chatwithfriends[o][a].newMessage=n.replace(/<br>/g,"")}$(".page1-Maindiv2 .wechatList .moveFriendList").find('span[data^="'+t+'"]').html(e.Chatwithfriends[o][a].newMessage)}}else $(".page1-Maindiv2 .wechatList .moveFriendList").find('span[data^="'+t+'"]').html("");if(e.friendStorage.hasOwnProperty(t)){var h=e.friendStorage[t].split("Unread").length-1;h>0?$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+t+'"]').next().css("display","inline-block").html(h):$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+t+'"]').next().css("display","none").html("")}else $(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+t+'"]').next().css("display","none").html("")}$(".page1-Maindiv2-myfriends-search-con-ul1 li").removeClass("click-background-color")},150)}))):(a.Initializationandpostoperationrecords=!1,a.page1Maindiv4Init=!0,a.ChatModule=!1,$(".chat-bottom-write").html(""),$(".page1-Maindiv3").css("background",'url("../images/chatBg.png") center no-repeat'),0==a["IsP"+o]?(e.frienfList=[],a["IsP"+o]=!0,(n=new FormData).append("accountId",e.myaccountId),n.append("id",o),t({method:"POST",url:e.link+"/latelychat/getRecentContactAndChatroomByTwoId",data:n,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){e.TotopNum=a.data.sumtop-1,e.frienfList=e.Chatwithfriends[o],setTimeout(function(){for(var a=0;a<e.Chatwithfriends[o].length;a++){var t=e.Chatwithfriends[o][a].cid;if(e.friendStorage.hasOwnProperty(t)){var n=e.friendStorage[t].split("Unread").length-1;n>0?$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+t+'"]').next().css("display","inline-block").html(n):$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+t+'"]').next().css("display","none").html("")}else $(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+t+'"]').next().css("display","none").html("");if(""!=e.Chatwithfriends[o][a].newMessage||null!=e.Chatwithfriends[o][a].newMessage){var i=e.Chatwithfriends[o][a].newMessage;if(null==i||""==i)$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.Chatwithfriends[o][a].cid+'"]').html("");else{var d=i.match(/\[[^\]]+\]/g);if(null==d||0==d||null==d)e.Chatwithfriends[o][a].newMessage=e.Chatwithfriends[o][a].newMessage.replace(/<br>/g,"");else{for(var l=[],r=[],c=0;c<d.length;c++)for(var p=0;p<s.length;p++)d[c]==s[p]&&(l.push('<img class="emoji_icon" src="images/qq/'+(p+1)+'.gif">'),r.push(s[p]));for(var h=0;h<l.length;h++)i=i.replace(r[h],l[h]);e.Chatwithfriends[o][a].newMessage=i.replace(/<br>/g,"")}$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.Chatwithfriends[o][a].cid+'"]').html(e.Chatwithfriends[o][a].newMessage)}}else $(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.Chatwithfriends[o][a].cid+'"]').html("")}$(".page1-Maindiv2-myfriends-search-con-ul1 li").removeClass("click-background-color")},150)})):(e.frienfList=[],(n=new FormData).append("accountId",e.myaccountId),n.append("id",o),t({method:"POST",url:e.link+"/latelychat/getRecentContactAndChatroomByTwoId",data:n,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){e.TotopNum=a.data.sumtop-1}),a.$apply(function(){e.frienfList=e.Chatwithfriends[o]}),setTimeout(function(){for(var a=0;a<e.Chatwithfriends[o].length;a++){var t=e.Chatwithfriends[o][a].cid;if(""!=e.Chatwithfriends[o][a].newMessage||null!=e.Chatwithfriends[o][a].newMessage){var n=e.Chatwithfriends[o][a].newMessage;if(null==n||""==n)$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.Chatwithfriends[o][a].cid+'"]').html("");else{var i=n.match(/\[[^\]]+\]/g);if(null==i||0==i||null==i)e.Chatwithfriends[o][a].newMessage=e.Chatwithfriends[o][a].newMessage.replace(/<br>/g,"");else{for(var d=[],l=[],r=0;r<i.length;r++)for(var c=0;c<s.length;c++)i[r]==s[c]&&(d.push('<img class="emoji_icon" src="images/qq/'+(c+1)+'.gif">'),l.push(s[c]));for(var p=0;p<d.length;p++)n=n.replace(l[p],d[p]);e.Chatwithfriends[o][a].newMessage=n.replace(/<br>/g,"")}$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.Chatwithfriends[o][a].cid+'"]').html(e.Chatwithfriends[o][a].newMessage)}}else $(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.Chatwithfriends[o][a].cid+'"]').html("");if(e.friendStorage.hasOwnProperty(t)){var h=e.friendStorage[t].split("Unread").length-1;h>0?$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+t+'"]').next().css("display","inline-block").html(h):$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+t+'"]').next().css("display","none").html("")}else $(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+t+'"]').next().css("display","none").html("")}$(".page1-Maindiv2-myfriends-search-con-ul1 li").removeClass("click-background-color")},150)))}),a.serach_Keyword="",$(".page1-Maindiv2-myfriends-search-input").bind("input propertychange",function(){$(".page1-Maindiv2-myfriends-search-con_history").css("display","none"),$(".tel_history_list").css("display","none");var n,i=$(this).val();1==a.Initializationandpostoperationrecords?((n=new FormData).append("accountId",e.myaccountId),n.append("message",i),t({method:"POST",url:e.link+"/latelychat/getRecentContactAndChatroomById",data:n,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(t){if(200==t.code&&t.data.contactList.length>0){for(var n=0;n<t.data.contactList.length;n++)""==t.data.contactList[n].profilePhoto?t.data.contactList[n].profilePhoto="./images/Destroy.png":t.data.contactList[n].profilePhoto=e.imgSrc+t.data.contactList[n].profilePhoto;a.chatListSEarch=t.data.contactList,$(".page1-Maindiv2-listInit").css("display","block"),a.serach_Keyword=i}else $(".page1-Maindiv2-listInit").css("display","none")})):((n=new FormData).append("accountId",e.myaccountId),n.append("message",i),n.append("id",e.lplplpl),t({method:"POST",url:e.link+"/latelychat/getRecentContactAndChatroomByIdAndName",data:n,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){200==e.code&&e.data.contactList.length>0?(a.chatListSEarch=e.data.contactList,$(".page1-Maindiv2-listInit").css("display","block")):$(".page1-Maindiv2-listInit").css("display","none"),a.serach_Keyword=""}))}),$(".page1-Maindiv3,.page1-Maindiv1,.page1-Maindiv4,.wechatList,.newSelect").click(function(){$(".page1-Maindiv2-listInit").css("display","none"),$(".page1-Maindiv2-myfriends-search-con_history").css("display","none"),$(".tel_history_list").css("display","none"),$(".page1-Maindiv2-myfriends-search-input").val("")}),t({method:"POST",url:e.link+"/tag/getTwoTags",data:"",headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){200==a.code&&(e.Taglibrary=a.data)}),a.addTagIsshow=function(n){if(1==n)if(0==$(".page1-div3-content-title-edit-tag2").attr("data"))$(".page1-div3-content-title-edit-tag2").attr("data",1),$(".page1-div3-content-title-edit-tag2").html("完成"),$(".page1-div3-content-title-edit-tag2").css({display:"inline-block",right:"0px"}),$(".page1-div3-content-title-edit-tag").css("display","none"),$(".add_tag_input_add").css("display","block"),$(".tags-box").css({position:"relative","z-index":-10}),$(".page1-div3-content-tags").css("height","134px");else if(""==$(".add_tag_input_add").val())$(".page1-div3-content-title-edit-tag2").attr("data",0),$(".page1-div3-content-title-edit-tag2").html("自定义"),$(".page1-div3-content-title-edit-tag2").css({display:"inline-block",right:"30px"}),$(".page1-div3-content-title-edit-tag").css("display","inline-block"),$(".tags-box").css({position:"relative","z-index":0}),$(".page1-div3-content-tags").css("height","114px"),$(".add_tag_input_add").css("display","none");else{$(".page1-div3-content-title-edit-tag2").attr("data",0),$(".page1-div3-content-title-edit-tag2").html("自定义"),$(".page1-div3-content-title-edit-tag2").css({display:"inline-block",right:"30px"}),$(".page1-div3-content-title-edit-tag").css("display","inline-block"),$(".tags-box").css({position:"relative","z-index":0}),$(".page1-div3-content-tags").css("height","114px"),$(".add_tag_input_add").css("display","none");var i=$(".add_tag_input_add").val(),s=[],d=[];if(s.push(i.split("，")),0==s[0].length);else{for(var l=0;l<s[0].length;l++)""==s[0][l]||d.push(s[0][l]);$(".search-field");if(1==a.chatGroupOrFriend){var r=$(".page1-div3-content-name-Group-First").attr("data"),o=$(".page1-div3-content-name-Group-First").attr("data1");(g=new FormData).append("id",r),g.append("socialaccountid",o),g.append("tags",d),t({method:"POST",url:e.link+"/contact/addChatroomTags",data:g,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(n){if(200==n.code){$(".add_tag_input_add").val("");var i=new FormData;i.append("socialaccountId",o),i.append("chatroomId",r),t({method:"POST",url:e.link+"/contact/getChatroomById",data:i,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){var t=e.data.tags;a.FriendTags=t.split(",")})}})}else{(g=new FormData).append("id",e.Id),g.append("socialaccountid",e.socialaccountId),g.append("tags",d),t({method:"POST",url:e.link+"/contact/addContactTags",data:g,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(n){if(200==n.code){$(".add_tag_input_add").val("");var i=new FormData;i.append("socialaccountId",e.socialaccountId),i.append("contactId",e.Id),t({method:"POST",url:e.link+"/contact/getContactById",data:i,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){var t=e.data.tags;a.FriendTags=t.split(",")})}})}}}else if(0==$(".page1-div3-content-title-edit-tag").attr("data"))$(".page1-div3-content-title-edit-tag").attr("data",1),$(".page1-div3-content-title-edit-tag").html("完成"),$(".page1-div3-content-title-edit-tag2").css("display","none"),$(".tags-box").css({position:"relative","z-index":-10}),$(".side-by-side").css("display","inline-block"),$(".page1-div3-content-tags").css("height","134px");else{$(".page1-div3-content-title-edit-tag").html("选择"),$(".page1-div3-content-tags").css("height","114px"),$(".page1-div3-content-title-edit-tag2").css("display","inline-block"),$(".tags-box").css({position:"relative","z-index":0}),$(".side-by-side").css("display","none"),$(".page1-div3-content-title-edit-tag").attr("data",0);for(var c=[],p=$(".search-choice"),h=0;h<p.length;h++)c.push(p.eq(h)[0].innerText);if(0==c.length);else{$(".search-field");if(1==a.chatGroupOrFriend){r=$(".page1-div3-content-name-Group-First").attr("data"),o=$(".page1-div3-content-name-Group-First").attr("data1");(g=new FormData).append("id",r),g.append("socialaccountid",o),g.append("tags",c),t({method:"POST",url:e.link+"/contact/addChatroomTags",data:g,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(n){if(200==n.code){var i=new FormData;i.append("socialaccountId",o),i.append("chatroomId",r),t({method:"POST",url:e.link+"/contact/getChatroomById",data:i,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){var t=e.data.tags;a.FriendTags=t.split(",")})}})}else{var g;(g=new FormData).append("id",e.Id),g.append("socialaccountid",e.socialaccountId),g.append("tags",c),t({method:"POST",url:e.link+"/contact/addContactTags",data:g,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(n){if(200==n.code){var i=new FormData;i.append("socialaccountId",e.socialaccountId),i.append("contactId",e.Id),t({method:"POST",url:e.link+"/contact/getContactById",data:i,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){var t=e.data.tags;a.FriendTags=t.split(",")})}})}}}};var c=!1;a.page1TableSwitch=function(n){if(1==n)a.Customerinformation=!0,a.allCustomerList=!1,a.quickReply=!1,a.Graphiclink=!1,a.customerRecord=!1,1==a.type?(a.myself1=!0,a.myself=!1):(a.myself1=!1,a.myself=!0),$(".page1-div3-title-span1").css({color:"rgb(68, 186, 246)","border-bottom":"2px solid rgb(68, 186, 246)"}),$(".page1-div3-title-span2").css({color:"#444444",border:"none"}),$(".page1-div3-title-span3").css({color:"#444444",border:"none"});else if(2==n)a.Graphiclink=!1,a.Customerinformation=!1,a.allCustomerList=!1,a.quickReply=!0,a.customerRecord=!1,a.quickReplyPhrase=!0,a.quickReplylibrary=!1,$(".quick-reply-table-div1").css("border-bottom","2px solid #44baf6"),$(".quick-reply-table-div2").css("border-bottom","2px solid #FFFFFF"),$(".quick-reply-table-div3").css("border-bottom","2px solid #FFFFFF"),$(".page1-div3-title-span2").css({color:"rgb(68, 186, 246)","border-bottom":"2px solid rgb(68, 186, 246)"}),$(".page1-div3-title-span1").css({color:"#444444",border:"none"}),$(".page1-div3-title-span3").css({color:"#444444",border:"none"}),t({method:"POST",url:e.link+"/script/getTwoScript",data:"",headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){200==e.code&&(a.AllShortcutphrase=e.data,0==c&&(c=!0,a.$watch("$viewContentLoaded",function(){$(".tree").treemenu({delay:0}).openActive()})),a.$watch("$viewContentLoaded",function(){$(".tree").treemenu({delay:0}).openActive(),$(".tree").treemenu({delay:0}).openActive()}))});else if(3==n){var i;if(a.Graphiclink=!1,$(".customer-record-table-div").css("display","flex"),$(".customer-record-time").css("display","block"),$(".chat-record-search").val(""),a.SearchkeywordsHistory=!1,a.Customerinformation=!1,a.allCustomerList=!1,a.quickReply=!1,a.customerRecord=!0,a.chatRecord=!0,a.chatRecordImg=!1,$(".customer-record-table-div1").css("border-bottom","2px solid #44baf6"),$(".customer-record-table-div2").css("border-bottom","2px solid #FFFFFF"),$(".page1-div3-title-span3").css({color:"rgb(68, 186, 246)","border-bottom":"2px solid rgb(68, 186, 246)"}),$(".page1-div3-title-span2").css({color:"#444444",border:"none"}),$(".page1-div3-title-span1").css({color:"#444444",border:"none"}),1==e.type)(i=new FormData).append("chatroomId",e.Id),i.append("socialaccountid",e.socialaccountId),t({method:"POST",url:e.link1+"/chatrecord/getChatroomChatrecordPage",data:i,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(t){if(200==t.code){a.Chatrecordpagenumber=t.data.pageindex,a.AllChatrecordpagenumber=t.data.pagesumcount;for(var n=0;n<t.data.chatList.length;n++)3==t.data.chatList[n].msgStatus?(t.data.chatList[n].contactNickname="我",t.data.chatList[n].profilephoto=e.WeChatownerHeader[t.data.chatList[n].socialaccountId]):10==t.data.chatList[n].msgStatus&&""==t.data.chatList[n].profilephoto&&(t.data.chatList[n].profilephoto="./images/Destroy.png");a.Textrecord=t.data.chatList,a.TextrecordTime=t.data.thedate.slice(0,10),0==a.Textrecord.length?$(".chat-record").css("background",'url("../images/noChat.png") center no-repeat'):$(".chat-record").css("background","none")}});else(i=new FormData).append("contactid",e.Id),i.append("socialaccountid",e.socialaccountId),t({method:"POST",url:e.link1+"/chatrecord/getchatrecordpage",data:i,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(t){if(200==t.code){a.Chatrecordpagenumber=t.data.pageindex,a.AllChatrecordpagenumber=t.data.pagesumcount;for(var n=0;n<t.data.chatList.length;n++)0==t.data.chatList[n].msgStatus?(t.data.chatList[n].contactNickname="我",t.data.chatList[n].profilephoto=e.WeChatownerHeader[t.data.chatList[n].socialaccountId]):1==t.data.chatList[n].msgStatus&&(t.data.chatList[n].profilephoto=e.ChatPhoto);a.Textrecord=t.data.chatList,null==t.data.thedate||null==t.data.thedate||""==t.data.thedate||(a.TextrecordTime=t.data.thedate.slice(0,10)),0==a.Textrecord.length?$(".chat-record").css("background",'url("../images/noChat.png") center no-repeat'):$(".chat-record").css("background","none")}})}},$(document).on("click",".quick-reply-treemenu-to-msg",function(){$("#editor1").html($(this).find(".quick-reply-treemenu-list-con").html())}),a.Graphiclink=!1,a.quickRelyTable=function(n){if(1==n)a.quickReplyPhrase=!0,a.quickReplylibrary=!1,a.Graphiclink=!1,$(".quick-reply-table-div1").css("border-bottom","2px solid #44baf6"),$(".quick-reply-table-div2").css("border-bottom","2px solid #FFFFFF"),$(".quick-reply-table-div3").css("border-bottom","2px solid #FFFFFF"),t({method:"POST",url:e.link+"/script/getTwoScript",data:"",headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){200==e.code&&(a.AllShortcutphrase=e.data)});else if(2==n){a.quickReplyPhrase=!1,a.quickReplylibrary=!0,a.Graphiclink=!1,$(".quick-reply-table-div2").css("border-bottom","2px solid #44baf6"),$(".quick-reply-table-div1").css("border-bottom","2px solid #FFFFFF"),$(".quick-reply-table-div3").css("border-bottom","2px solid #FFFFFF");var i=new FormData;t({method:"POST",url:e.link+"/picture/getAllPicture",data:i,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){200==e.code&&(a.Picturelibrary=e.data.pictureList)})}else e.AllGraphiclink="",t({method:"POST",url:e.link+"/imgandlink/queryAllImgAndLink",data:"",headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){200==a.code?e.AllGraphiclink=a.data.imgAndLinkList:e.AllGraphiclink=""}),a.quickReplyPhrase=!1,a.quickReplylibrary=!1,a.Graphiclink=!0,$(".quick-reply-table-div2").css("border-bottom","2px solid #FFFFFF"),$(".quick-reply-table-div1").css("border-bottom","2px solid #FFFFFF"),$(".quick-reply-table-div3").css("border-bottom","2px solid #44baf6")},a.customerRecord1=function(n){var i;1==n?(a.chatRecord=!0,a.chatRecordImg=!1,$(".customer-record-table-div1").css("border-bottom","2px solid #44baf6"),$(".customer-record-table-div2").css("border-bottom","2px solid #FFFFFF"),$(".customer-record-time").css("display","block")):($(".customer-record-time1").css("display","none"),1==e.type?(a.chatRecord=!1,a.chatRecordImg=!0,$(".customer-record-table-div2").css("border-bottom","2px solid #44baf6"),$(".customer-record-table-div1").css("border-bottom","2px solid #FFFFFF"),(i=new FormData).append("chatroomid",e.Id),i.append("socialaccountid",e.socialaccountId),t({method:"POST",url:e.link1+"/chatrecord/getchatrecordChatroomImg",data:i,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){200==e.code&&(a.Imgrecord=e.data.chatList,0==a.Imgrecord.length?$(".chat-record-img").css("background",'url("../images/noImg.png") center no-repeat'):$(".chat-record-img").css("background","none"))})):(a.chatRecord=!1,a.chatRecordImg=!0,$(".customer-record-table-div2").css("border-bottom","2px solid #44baf6"),$(".customer-record-table-div1").css("border-bottom","2px solid #FFFFFF"),(i=new FormData).append("contactid",e.Id),i.append("socialaccountid",e.socialaccountId),t({method:"POST",url:e.link1+"/chatrecord/getchatrecordImg",data:i,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){200==e.code&&(a.Imgrecord=e.data.chatList,0==a.Imgrecord.length?$(".chat-record-img").css("background",'url("../images/noImg.png") center no-repeat'):$(".chat-record-img").css("background","none"))})))},a.editWhitMe=function(){$(".whiteMeContent").attr("disabled",!1).css("border","solid 1px #75aaff"),$(".whiteMeContent").focus()},$(".whiteMeContent").blur(function(){if(1==a.chatGroupOrFriend){$(".whiteMeContent").attr("disabled",!0).css({background:"#fff",border:"1px solid #EFEFEF"});var n=$(".page1-div3-content-name-Group-First").attr("data"),i=$(".page1-div3-content-name-Group-First").html(),s=$(".four-select").val(),d=$(".whiteMeContent").val();(l=new FormData).append("id",n),l.append("groupid",s),l.append("mynickname",i),l.append("chatroomDescription",d),t({method:"POST",url:e.link1+"/contact/modifyChatroomById",data:l,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){e.code})}else{$(".whiteMeContent").attr("disabled",!0).css({background:"#fff",border:"1px solid #EFEFEF"});n=$(".page1-div3-content-name").attr("data"),i=$(".page1-div3-content-name").html();var l,r=$(".page1-div3-content-name1").val();s=$(".page1-div3-content-myself-select").val(),d=$(".whiteMeContent").val();(l=new FormData).append("id",n),l.append("notename",i),l.append("phone",r),l.append("groupid",s),l.append("description",d),t({method:"POST",url:e.link+"/contact/modifyContactById",data:l,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){e.code})}}),$(".four-select").change(function(){var a=$(".page1-div3-content-name-Group-First").attr("data"),n=$(".page1-div3-content-name-Group-First").html(),i=$(".four-select").val(),s=$(".whiteMeContent").val(),d=new FormData;d.append("id",a),d.append("groupid",i),d.append("mynickname",n),d.append("chatroomDescription",s),t({method:"POST",url:e.link1+"/contact/modifyChatroomById",data:d,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){e.code})}),a.editName=function(){$(".page1-div3-content-name").attr("contenteditable",!0).css("border","solid 1px #75aaff"),$(".page1-div3-content-name").focus()},$(".page1-div3-content-name").blur(function(){$(".page1-div3-content-name").attr("contenteditable",!1).css("border"," 1px solid transparent");var a=$(".page1-div3-content-name").attr("data"),n=$(".page1-div3-content-name").html(),i=$(".page1-div3-content-name1").val(),s=$(".page1-div3-content-myself-select").val(),d=$(".whiteMeContent").val(),l=new FormData;l.append("id",a),l.append("notename",n),l.append("phone",i),l.append("groupid",s),l.append("description",d),t({method:"POST",url:e.link+"/contact/modifyContactById",data:l,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){e.code})}),a.editName4=function(){$(".page1-div3-content-name-Group-First").attr("contenteditable",!0).css("border","solid 1px #75aaff"),$(".page1-div3-content-name-Group-First").focus()},$(".page1-div3-content-name-Group-First").blur(function(){$(".page1-div3-content-name-Group-First").attr("contenteditable",!1).css("border"," 1px solid transparent");var a=$(".page1-div3-content-name-Group-First").attr("data"),n=$(".page1-div3-content-name-Group-First").html(),i=$(".four-select").val(),s=$(".whiteMeContent").val(),d=new FormData;d.append("id",a),d.append("mynickname",n),d.append("groupid",i),d.append("chatroomDescription",s),t({method:"POST",url:e.link+"/contact/modifyChatroomById",data:d,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){e.code})}),a.editPhone=function(){$(".page1-div3-content-name1").attr("readonly",!1).css("border","solid 1px #75aaff"),$(".page1-div3-content-name1").focus()},$(".page1-div3-content-name1").keyup(function(){this.value=this.value.replace(/[^0-9-]+/,"")}),$(".page1-div3-content-name1").blur(function(){$(this).attr("readonly",!0).css("border","1px solid transparent");var a=$(this).attr("data"),n=$(this).val(),i=$(".page1-div3-content-name").html(),s=$(".page1-div3-content-myself-select").val(),d=$(".whiteMeContent").val(),l=new FormData;l.append("id",a),l.append("phone",n),l.append("notename",i),l.append("groupid",s),l.append("description",d),t({method:"POST",url:e.link+"/contact/modifyContactById",data:l,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){})}),a.backGroupPage=function(){a.allCustomerList=!1,a.Customerinformation=!0,a.myself1=!0,a.myself=!1,$(".all-customer-search-logo-input").val(""),$(".all-customer-list-ul-li .add-people").css("cursor","pointer")},a.showcusstomList=function(){a.allCustomerList=!0,a.Customerinformation=!1,a.myself1=!1,a.myself=!1;var n=new FormData;n.append("chatroomId",e.Id),n.append("id",e.socialaccountId),t({method:"POST",url:e.link+"/contact/getChatroommenber",data:n,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(t){for(var n=0;n<t.data.chatroommemberList.length;n++)""==t.data.chatroommemberList[n].profilePhoto?t.data.chatroommemberList[n].profilePhoto="./images/Destroy.png":t.data.chatroommemberList[n].profilePhoto=e.imgSrc+t.data.chatroommemberList[n].profilePhoto;a.Listofallgroupmembers=t.data.chatroommemberList})},$(".page1-Maindiv2-myfriends-search-input").focus(function(){$(".newSelect").css({width:"102px",transition:"width 1s","-moz-transition":"width 1s","-webkit-transition":"width 1s","-o-transition":"width 1s"}),$(".page1-Maindiv2-myfriends-search").css({width:"132px",transition:"width 1s","-moz-transition":"width 1s","-webkit-transition":"width 1s","-o-transition":"width 1s"}),$(this).css({width:"90px",transition:"width 1s","-moz-transition":"width 1s","-webkit-transition":"width 1s","-o-transition":"width 1s"}),$(".clearCon").css("display","inline-block"),"1"==$(this).attr("data_two")?e.Searchhistory_Chatting.length>0?$(".page1-Maindiv2-myfriends-search-con_history").css("display","block"):$(".page1-Maindiv2-myfriends-search-con_history").css("display","none"):e.Searchhistory_Maillist.length>0?$(".tel_history_list").css("display","block"):$(".tel_history_list").css("display","none")}),$(".page1-Maindiv2-myfriends-search-input").blur(function(e){$(".newSelect").css({width:"148px",transition:"width 1s","-moz-transition":"width 1s","-webkit-transition":"width 1s","-o-transition":"width 1s"}),$(".page1-Maindiv2-myfriends-search").css({width:"80px",transition:"width 1s","-moz-transition":"width 1s","-webkit-transition":"width 1s","-o-transition":"width 1s"}),$(this).css({width:"30px",transition:"width 1s","-moz-transition":"width 1s","-webkit-transition":"width 1s","-o-transition":"width 1s"}),$(".clearCon").css("display","none"),$(".page1-Maindiv2-myfriends-search-input").val("")}),a.ChoosethisChatrecord=function(n){$(".page1-Maindiv2-myfriends-search-input").focus().val(n);var i=new FormData;i.append("accountId",e.myaccountId),i.append("message",n),t({method:"POST",url:e.link+"/latelychat/getRecentContactAndChatroomById",data:i,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){$(".page1-Maindiv2-myfriends-search-con_history").css("display","none"),200==e.code&&e.data.contactList.length>0?(a.chatListSEarch=e.data.contactList,$(".page1-Maindiv2-listInit").css("display","block")):$(".page1-Maindiv2-listInit").css("display","none")})},a.ChoosethisChatrecord1=function(n){$(".page1-Maindiv2-myfriends-search-input").focus().val(n);var i=new FormData;i.append("accountId",e.myaccountId),i.append("message",n),t({method:"POST",url:e.link+"/socialaccount/getContactByName",data:i,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){$(".tel_history_list").css("display","none"),200==e.code&&e.data.contactList.length>0?(a.DDorTop=e.data.contactList,$(".Phone-book-dropdown-Search-Show").css("display","block")):$(".Phone-book-dropdown-Search-Show").css("display","none")})},a.delete_history=function(a,t,n){t.stopPropagation(),1==n?e.Searchhistory_Chatting.splice(a,1):e.Searchhistory_Maillist.splice(a,1)};var p=$(".newsList li").length,h=($(".newsList li:last").index(),p-5);h%10>5&&($(".ChatRecord").show(),$(".newsList li:lt("+h+")").hide()),a.sengChatMsg=function(){if(""==(o=$(".chat-bottom-write").html()));else{for(var n=o.replace(/<div(([\s\S])*?)<\/div>/g,""),i="",d=!1,l=[".com",".net",".org",".com.cn",".net.cn",".org.cn",".gov","www.","http","https"],r=0;r<l.length;r++)if(o.indexOf(""+l[r])>0){d=!0;break}if(0==d);else var o=o.replace(/((https?|ftp):\/\/)?([-A-Za-z0-9+&@#/%?=~_|!:,.;]+\.[A-Za-z0-9]+[\/=\?%\-&_~`@[\]\':+!]*\w)/gi,function(e,a,t){return'<a class="open-other-url"  target="_blank"  href="'+e+'">'+e+"</a>"});var c=/\/([^\/]*?\.gif)/i,p=o.match(/<img.*?(?:>|\/>)/g);if(null==p);else{var h=[];for(r=0;r<p.length;r++){var g=p[r].match(c);g[1]&&h.push(g[1].substring(0,g[1].indexOf(".")));for(var m=[],u=0;u<h.length;u++)for(var f=0;f<s.length;f++)h[u]==f&&m.push(s[f-1])}var v=o.match(/<img.*?(?:>|\/>)/g);for(r=0;r<v.length;r++)o=o.replace(v[r],m[r])}var w=o.replace(/<\/div>/g,"").replace(/<br>/g,"").replace(/<div>/g,"<br>"),y=Date.parse(new Date)+a.MsgTimes,b=e.getNowFormatDate(),C=new FormData;C.append("clienttype","web"),C.append("accountname",e.localUserName),C.append("cid",e.chatId),C.append("msgid",y),C.append("msgtype",1),C.append("msgcontent",w),C.append("file",""),1==e.type?C.append("group",1):C.append("group",0),C.append("filePath",""),i+="                    <li dataid="+y+'>\n                        <div class="nesHead">\n                            <img src='+e.chatHead+' alt="">\n                        </div>\n                        <div class="news">\n                            <img class="jiao" src="images/bluejiao.png" alt="">\n                           '+$(".chat-bottom-write").html()+"\n                        </div>\n                    </li>",t({method:"POST",url:e.link1+"/message/sendGcMessageInfo",data:C,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(t){if(200==t.code){$(".newsList").append(i);var s=$(".RightCont")[0].scrollHeight;$(".RightCont").animate({scrollTop:s},500),$(".chat-bottom-write").html(""),$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+a.chatId+'"]').html(n);for(var d=0;d<e.Chatwithfriends[e.lplplpl].length;d++)e.Chatwithfriends[e.lplplpl][d].cid==e.chatId&&(e.Chatwithfriends[e.lplplpl][d].newMessage=o,e.Chatwithfriends[e.lplplpl][d].lastChatTime=b);for(var l=0;l<e.Chatwithfriends[e.socialaccountId].length;l++)e.Chatwithfriends[e.socialaccountId][l].cid==e.chatId&&(e.Chatwithfriends[e.socialaccountId][l].newMessage=o,e.Chatwithfriends[e.socialaccountId][l].lastChatTime=b);for(l=0;l<e.Chatwithfriends[-1].length;l++)e.Chatwithfriends[-1][l].cid==e.chatId&&(e.Chatwithfriends[-1][l].newMessage=o,e.Chatwithfriends[-1][l].lastChatTime=b);$(".newsList").html();if(e.friendStorage.hasOwnProperty(a.chatId)?e.friendStorage[a.chatId]+=i:e.friendStorage[a.chatId]=i,$(".chat-bottom-write").html(e.friendStorage),1==e.Topjudge){for(var r=0,c=0;c<e.Chatwithfriends[e.lplplpl].length;c++)if(e.Chatwithfriends[e.lplplpl][c].cid==e.chatId){r=c;var p=e.Chatwithfriends[e.lplplpl][c]}e.Chatwithfriends[e.lplplpl].splice(r,1),e.Chatwithfriends[e.lplplpl].splice(0,0,p),a.$watch(function(){e.frienfList=e.Chatwithfriends[e.lplplpl]}),setTimeout(function(){$(".page1-Maindiv2-myfriends-search-con-ul1 li").find('span[data^="'+e.chatId+'"]').parent().addClass("click-background-color").siblings().removeClass("click-background-color");var a=e.Chatwithfriends[e.lplplpl].length;a>50&&(a=50);for(var t=0;t<a;t++){var n=e.Chatwithfriends[e.lplplpl][t].cid;if(""!=e.Chatwithfriends[e.lplplpl][t].newMessage?$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.Chatwithfriends[e.lplplpl][t].cid+'"]').html(e.Chatwithfriends[e.lplplpl][t].newMessage):$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.Chatwithfriends[e.lplplpl][t].cid+'"]').html(""),e.friendStorage.hasOwnProperty(n)){var i=e.friendStorage[n].split("Unread").length-1;i>0?$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","inline-block").html(i):$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","none").html("")}else $(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","none").html("")}},0)}else{var h=0,g=0;for(c=0;c<e.Chatwithfriends[e.lplplpl].length;c++)if(1==e.Chatwithfriends[e.lplplpl][c].topNumber&&h++,e.Chatwithfriends[e.lplplpl][c].cid==e.chatId){p=e.Chatwithfriends[e.lplplpl][c];g=c}e.Chatwithfriends[e.lplplpl].splice(g,1),e.Chatwithfriends[e.lplplpl].splice(h,0,p),a.$watch(function(){e.frienfList=e.Chatwithfriends[e.lplplpl]}),setTimeout(function(){$(".page1-Maindiv2-myfriends-search-con-ul1 li").find('span[data^="'+e.chatId+'"]').parent().addClass("click-background-color").siblings().removeClass("click-background-color"),$(".page1-Maindiv2-myfriends-search-con-ul1").find(".page1-Maindiv2-myfriends-search-con-ul-tagname1").html(""),$(".page1-Maindiv2-myfriends-search-con-ul1").find(".new-msg-number").css("display","none").html("");var a=e.Chatwithfriends[e.lplplpl].length;a>50&&(a=50);for(var t=0;t<a;t++){var n=e.Chatwithfriends[e.lplplpl][t].cid;if(""!=e.Chatwithfriends[e.lplplpl][t].newMessage?$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.Chatwithfriends[e.lplplpl][t].cid+'"]').html(e.Chatwithfriends[e.lplplpl][t].newMessage):$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.Chatwithfriends[e.lplplpl][t].cid+'"]').html(""),e.friendStorage.hasOwnProperty(n)){var i=e.friendStorage[n].split("Unread").length-1;i>0?$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","inline-block").html(i):$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","none").html("")}else $(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","none").html("")}},0)}}else 1e3==t.code?($(".gray-help").css("display","block"),$(".gray-help-say").css("display","block"),$(".gray-help-say-con-text").html("暂不支持收发消息，请开启营销系统")):1001==t.code?($(".gray-help").css("display","block"),$(".gray-help-say").css("display","block"),$(".gray-help-say-con-text").html("图片大小暂时支持<=10M")):1002==t.code&&($(".gray-help").css("display","block"),$(".gray-help-say").css("display","block"),$(".gray-help-say-con-text").html("文件大小暂时支持<=25M"))})}},$(".image-upfile").on("change",function(){var n=function(e){var a=null;null!=window.createObjectURL?a=window.createObjectURL(e):null!=window.URL?a=window.URL.createObjectURL(e):null!=window.webkitURL&&(a=window.webkitURL.createObjectURL(e));return a}(this.files[0]);if(n)var i=n;var s=Date.parse(new Date),d=e.getNowFormatDate(),l=new FormData,r=s+a.MsgTimes;l.append("clienttype","web"),l.append("accountname",e.localUserName),l.append("cid",e.chatId),l.append("msgid",r),l.append("msgtype",3),l.append("msgcontent",""),1==e.type?l.append("group",1):l.append("group",0),l.append("file",this.files[0]),l.append("filePath",""),t({method:"POST",url:e.link1+"/message/sendGcMessageInfo",data:l,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(t){if(200==t.code){var s="";s+="                    <li dataid="+r+'>\n                        <div class="nesHead">\n                            <img src='+e.chatHead+' alt="">\n                        </div>\n                        <div class="news bigPicture1" data-imgSrc='+n+'>\n                            <img class="jiao " src="images/bluejiao.png" alt="">\n                           <img class="up-Img-Add " src='+i+' alt="">\n                        </div>\n                    </li>',$(".newsList").append(s),e.friendStorage[a.chatId]+=s;for(var l=0;l<e.Chatwithfriends[e.lplplpl].length;l++)e.Chatwithfriends[e.lplplpl][l].cid==a.chatId&&(e.Chatwithfriends[e.lplplpl][l].newMessage="[图片]",e.Chatwithfriends[e.lplplpl][l].lastChatTime=d);for(var o=0;o<e.Chatwithfriends[e.socialaccountId].length;o++)e.Chatwithfriends[e.socialaccountId][o].cid==e.chatId&&(e.Chatwithfriends[e.socialaccountId][o].newMessage="[图片]",e.Chatwithfriends[e.socialaccountId][o].lastChatTime=d);for(o=0;o<e.Chatwithfriends[-1].length;o++)e.Chatwithfriends[-1][o].cid==e.chatId&&(e.Chatwithfriends[-1][o].newMessage="[图片]",e.Chatwithfriends[-1][o].lastChatTime=d);var c=$(".RightCont")[0].scrollHeight;if($(".RightCont").animate({scrollTop:c},500),$(".image-upfile").val(""),1==e.Topjudge){for(var p=0,h=0;h<e.Chatwithfriends[e.lplplpl].length;h++)if(e.Chatwithfriends[e.lplplpl][h].cid==e.chatId){p=h;var g=e.Chatwithfriends[e.lplplpl][h]}e.Chatwithfriends[e.lplplpl].splice(p,1),e.Chatwithfriends[e.lplplpl].splice(0,0,g),a.$watch(function(){e.frienfList=e.Chatwithfriends[e.lplplpl]}),setTimeout(function(){$(".page1-Maindiv2-myfriends-search-con-ul1 li").find('span[data^="'+e.chatId+'"]').parent().addClass("click-background-color").siblings().removeClass("click-background-color");var a=e.Chatwithfriends[e.lplplpl].length;a>50&&(a=50);for(var t=0;t<a;t++){var n=e.Chatwithfriends[e.lplplpl][t].cid;if(""!=e.Chatwithfriends[e.lplplpl][t].newMessage?$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.Chatwithfriends[e.lplplpl][t].cid+'"]').html(e.Chatwithfriends[e.lplplpl][t].newMessage):$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.Chatwithfriends[e.lplplpl][t].cid+'"]').html(""),e.friendStorage.hasOwnProperty(n)){var i=e.friendStorage[n].split("Unread").length-1;i>0?$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","inline-block").html(i):$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","none").html("")}else $(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","none").html("")}},0)}else{var m=0,u=1;for(h=0;h<e.Chatwithfriends[e.lplplpl].length;h++)if(1==e.Chatwithfriends[e.lplplpl][h].topNumber&&m++,e.Chatwithfriends[e.lplplpl][h].cid==e.chatId){g=e.Chatwithfriends[e.lplplpl][h];u=h}e.Chatwithfriends[e.lplplpl].splice(u,1),e.Chatwithfriends[e.lplplpl].splice(m,0,g),a.$watch(function(){e.frienfList=e.Chatwithfriends[e.lplplpl]}),setTimeout(function(){$(".page1-Maindiv2-myfriends-search-con-ul1 li").find('span[data^="'+e.chatId+'"]').parent().addClass("click-background-color").siblings().removeClass("click-background-color"),$(".page1-Maindiv2-myfriends-search-con-ul1").find(".page1-Maindiv2-myfriends-search-con-ul-tagname1").html(""),$(".page1-Maindiv2-myfriends-search-con-ul1").find(".new-msg-number").css("display","none").html("");var a=e.Chatwithfriends[e.lplplpl].length;a>50&&(a=50);for(var t=0;t<a;t++){var n=e.Chatwithfriends[e.lplplpl][t].cid;if(""!=e.Chatwithfriends[e.lplplpl][t].newMessage?$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.Chatwithfriends[e.lplplpl][t].cid+'"]').html(e.Chatwithfriends[e.lplplpl][t].newMessage):$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.Chatwithfriends[e.lplplpl][t].cid+'"]').html(""),e.friendStorage.hasOwnProperty(n)){var i=e.friendStorage[n].split("Unread").length-1;i>0?$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","inline-block").html(i):$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","none").html("")}else $(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","none").html("")}},0)}}else 1e3==t.code?($(".gray-help").css("display","block"),$(".gray-help-say").css("display","block"),$(".gray-help-say-con-text").html("暂不支持收发消息，请开启营销系统")):1001==t.code?($(".gray-help").css("display","block"),$(".gray-help-say").css("display","block"),$(".gray-help-say-con-text").html("图片大小暂时支持<=10M")):1002==t.code&&($(".gray-help").css("display","block"),$(".gray-help-say").css("display","block"),$(".gray-help-say-con-text").html("文件大小暂时支持<=25M"))})}),$(".image-upfile1").on("change",function(){var n=this.files[0],i=n.name,s=(this.files[0].size/1024).toFixed(1),d="";d=s.length>=5?(s/1024).toFixed(1)+"MB":s+"KB";var l=Date.parse(new Date),r=e.getNowFormatDate(),o=new FormData,c=l+a.MsgTimes;o.append("clienttype","web"),o.append("accountname",e.localUserName),o.append("cid",e.chatId),o.append("msgid",c),o.append("msgtype",496),o.append("msgcontent",""),1==e.type?o.append("group",1):o.append("group",0),o.append("file",n),o.append("filePath",""),t({method:"POST",url:e.link1+"/message/sendGcMessageInfo",data:o,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(t){if(200==t.code){var s="";s+="                    <li  dataid="+c+'>\n                        <div class="nesHead">\n                            <img src='+e.chatHead+' alt="">\n                        </div>\n                            <div class="news">\n                                <img class="jiao" src="images/bluejiao.png" alt="">\n                                <div class="up-file-Add">\n                                    <dl>\n                                        <dt><img src="images/defult-File.png"></dt>\n                                        <dd>\n                                            <span class="defult-File-name">\n'+n.name+'\n                                            </span>\n                                            <br>\n                                            <span class="defult-File-size">\n'+d+'\n                                            </span>\n                                        </dd>\n                                <div class="up-file-Down" isnew="true" isme="true" file_id='+c+"  file_title="+i+'  file_path="">下载\n                            </div>\n                                    </dl>\n                                </div>\n                            </div>\n                   </li>',$(".newsList").append(s),e.friendStorage[a.chatId]+=s;for(var l=0;l<e.Chatwithfriends[e.lplplpl].length;l++)e.Chatwithfriends[e.lplplpl][l].cid==a.chatId&&(e.Chatwithfriends[e.lplplpl][l].newMessage="[文件]",e.Chatwithfriends[e.lplplpl][l].lastChatTime=r);for(var o=0;o<e.Chatwithfriends[e.socialaccountId].length;o++)e.Chatwithfriends[e.socialaccountId][o].cid==e.chatId&&(e.Chatwithfriends[e.socialaccountId][o].newMessage="[文件]",e.Chatwithfriends[e.socialaccountId][o].lastChatTime=r);for(o=0;o<e.Chatwithfriends[-1].length;o++)e.Chatwithfriends[-1][o].cid==e.chatId&&(e.Chatwithfriends[-1][o].newMessage="[文件]",e.Chatwithfriends[-1][o].lastChatTime=r);var p=$(".RightCont")[0].scrollHeight;if($(".RightCont").animate({scrollTop:p},500),$(".image-upfile1").val(""),1==e.Topjudge){for(var h=0,g=0;g<e.Chatwithfriends[e.lplplpl].length;g++)if(e.Chatwithfriends[e.lplplpl][g].cid==e.chatId){h=g;var m=e.Chatwithfriends[e.lplplpl][g]}e.Chatwithfriends[e.lplplpl].splice(h,1),e.Chatwithfriends[e.lplplpl].splice(0,0,m),a.$watch(function(){e.frienfList=e.Chatwithfriends[e.lplplpl]}),setTimeout(function(){$(".page1-Maindiv2-myfriends-search-con-ul1 li").find('span[data^="'+e.chatId+'"]').parent().addClass("click-background-color").siblings().removeClass("click-background-color");var a=e.Chatwithfriends[e.lplplpl].length;a>50&&(a=50);for(var t=0;t<a;t++){var n=e.Chatwithfriends[e.lplplpl][t].cid;if(""!=e.Chatwithfriends[e.lplplpl][t].newMessage?$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.Chatwithfriends[e.lplplpl][t].cid+'"]').html(e.Chatwithfriends[e.lplplpl][t].newMessage):$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.Chatwithfriends[e.lplplpl][t].cid+'"]').html(""),e.friendStorage.hasOwnProperty(n)){var i=e.friendStorage[n].split("Unread").length-1;i>0?$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","inline-block").html(i):$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","none").html("")}else $(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","none").html("")}},0)}else{var u=0,f=1;for(g=0;g<e.Chatwithfriends[e.lplplpl].length;g++)if(1==e.Chatwithfriends[e.lplplpl][g].topNumber&&u++,e.Chatwithfriends[e.lplplpl][g].cid==e.chatId){f=g;m=e.Chatwithfriends[e.lplplpl][g]}e.Chatwithfriends[e.lplplpl].splice(f,1),e.Chatwithfriends[e.lplplpl].splice(u,0,m),a.$watch(function(){e.frienfList=e.Chatwithfriends[e.lplplpl]}),setTimeout(function(){$(".page1-Maindiv2-myfriends-search-con-ul1 li").find('span[data^="'+e.chatId+'"]').parent().addClass("click-background-color").siblings().removeClass("click-background-color"),$(".page1-Maindiv2-myfriends-search-con-ul1").find(".page1-Maindiv2-myfriends-search-con-ul-tagname1").html(""),$(".page1-Maindiv2-myfriends-search-con-ul1").find(".new-msg-number").css("display","none").html("");var a=e.Chatwithfriends[e.lplplpl].length;a>50&&(a=50);for(var t=0;t<a;t++){var n=e.Chatwithfriends[e.lplplpl][t].cid;if(""!=e.Chatwithfriends[e.lplplpl][t].newMessage?$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.Chatwithfriends[e.lplplpl][t].cid+'"]').html(e.Chatwithfriends[e.lplplpl][t].newMessage):$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.Chatwithfriends[e.lplplpl][t].cid+'"]').html(""),e.friendStorage.hasOwnProperty(n)){var i=e.friendStorage[n].split("Unread").length-1;i>0?$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","inline-block").html(i):$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","none").html("")}else $(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","none").html("")}},0)}}else 1e3==t.code?($(".gray-help").css("display","block"),$(".gray-help-say").css("display","block"),$(".gray-help-say-con-text").html("暂不支持收发消息，请开启营销系统")):1001==t.code?($(".gray-help").css("display","block"),$(".gray-help-say").css("display","block"),$(".gray-help-say-con-text").html("图片大小暂时支持<=10M")):1002==t.code&&($(".gray-help").css("display","block"),$(".gray-help-say").css("display","block"),$(".gray-help-say-con-text").html("文件大小暂时支持<=25M"))})}),a.Picturelibraryuploadingpictures=function(n){var i=n,s=Date.parse(new Date),d=e.getNowFormatDate(),l=new FormData,r=s+a.MsgTimes;l.append("clienttype","web"),l.append("accountname",e.localUserName),l.append("cid",e.chatId),l.append("msgid",r),l.append("msgtype",3),l.append("msgcontent",""),1==e.type?l.append("group",1):l.append("group",0),l.append("file",""),l.append("filePath",n),t({method:"POST",url:e.link1+"/message/sendGcMessageInfo",data:l,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(t){if(200==t.code){var s="";s+="                    <li dataid="+r+'>\n                        <div class="nesHead">\n                            <img src='+e.chatHead+' alt="">\n                        </div>\n                        <div class="news bigPicture1" data-imgSrc='+i+'>\n                            <img class="jiao" src="images/bluejiao.png" alt="">\n                           <img class="up-Img-Add" src='+n+' alt="">\n                        </div>\n                    </li>',$(".newsList").append(s);for(var l=0;l<e.Chatwithfriends[e.lplplpl].length;l++)e.Chatwithfriends[e.lplplpl][l].cid==a.chatId&&(e.Chatwithfriends[e.lplplpl][l].newMessage="[图片]",e.Chatwithfriends[e.lplplpl][l].lastChatTime=d);for(var o=0;o<e.Chatwithfriends[e.socialaccountId].length;o++)e.Chatwithfriends[e.socialaccountId][o].cid==e.chatId&&(e.Chatwithfriends[e.socialaccountId][o].newMessage="[图片]",e.Chatwithfriends[e.socialaccountId][o].lastChatTime=d);for(o=0;o<e.Chatwithfriends[-1].length;o++)e.Chatwithfriends[-1][o].cid==e.chatId&&(e.Chatwithfriends[-1][o].newMessage="[图片]",e.Chatwithfriends[-1][o].lastChatTime=d);var c=$(".RightCont")[0].scrollHeight;$(".RightCont").animate({scrollTop:c},500),$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+a.chatId+'"]').html("[图片]");$(".newsList").html();if(e.friendStorage.hasOwnProperty(a.chatId)?e.friendStorage[a.chatId]+=s:e.friendStorage[a.chatId]=s,1==e.Topjudge){for(var p=0,h=0;h<e.Chatwithfriends[e.lplplpl].length;h++)if(e.Chatwithfriends[e.lplplpl][h].cid==e.chatId){var g=e.Chatwithfriends[e.lplplpl][h];p=h}e.Chatwithfriends[e.lplplpl].splice(p,1),e.Chatwithfriends[e.lplplpl].splice(0,0,g),a.$watch(function(){e.frienfList=e.Chatwithfriends[e.lplplpl]}),setTimeout(function(){$(".page1-Maindiv2-myfriends-search-con-ul1 li").find('span[data^="'+e.chatId+'"]').parent().addClass("click-background-color").siblings().removeClass("click-background-color");var a=e.Chatwithfriends[e.lplplpl].length;a>50&&(a=50);for(var t=0;t<a;t++){var n=e.Chatwithfriends[e.lplplpl][t].cid;if(""!=e.Chatwithfriends[e.lplplpl][t].newMessage?$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.Chatwithfriends[e.lplplpl][t].cid+'"]').html(e.Chatwithfriends[e.lplplpl][t].newMessage):$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.Chatwithfriends[e.lplplpl][t].cid+'"]').html(""),e.friendStorage.hasOwnProperty(n)){var i=e.friendStorage[n].split("Unread").length-1;i>0?$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","inline-block").html(i):$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","none").html("")}else $(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","none").html("")}},0)}else{var m=0,u=1;for(h=0;h<e.Chatwithfriends[e.lplplpl].length;h++)if(1==e.Chatwithfriends[e.lplplpl][h].topNumber&&m++,e.Chatwithfriends[e.lplplpl][h].cid==e.chatId){g=e.Chatwithfriends[e.lplplpl][h];u=h}e.Chatwithfriends[e.lplplpl].splice(u,1),e.Chatwithfriends[e.lplplpl].splice(m,0,g),a.$watch(function(){e.frienfList=e.Chatwithfriends[e.lplplpl]}),setTimeout(function(){$(".page1-Maindiv2-myfriends-search-con-ul1 li").find('span[data^="'+e.chatId+'"]').parent().addClass("click-background-color").siblings().removeClass("click-background-color"),$(".page1-Maindiv2-myfriends-search-con-ul1").find(".page1-Maindiv2-myfriends-search-con-ul-tagname1").html(""),$(".page1-Maindiv2-myfriends-search-con-ul1").find(".new-msg-number").css("display","none").html("");var a=e.Chatwithfriends[e.lplplpl].length;a>50&&(a=50);for(var t=0;t<a;t++){var n=e.Chatwithfriends[e.lplplpl][t].cid;if(""!=e.Chatwithfriends[e.lplplpl][t].newMessage?$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.Chatwithfriends[e.lplplpl][t].cid+'"]').html(e.Chatwithfriends[e.lplplpl][t].newMessage):$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.Chatwithfriends[e.lplplpl][t].cid+'"]').html(""),e.friendStorage.hasOwnProperty(n)){var i=e.friendStorage[n].split("Unread").length-1;i>0?$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","inline-block").html(i):$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","none").html("")}else $(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","none").html("")}},0)}}else 1e3==t.code?($(".gray-help").css("display","block"),$(".gray-help-say").css("display","block"),$(".gray-help-say-con-text").html("暂不支持收发消息，请开启营销系统")):1001==t.code?($(".gray-help").css("display","block"),$(".gray-help-say").css("display","block"),$(".gray-help-say-con-text").html("图片大小暂时支持<=10M")):1002==t.code&&($(".gray-help").css("display","block"),$(".gray-help-say").css("display","block"),$(".gray-help-say-con-text").html("文件大小暂时支持<=25M"))})},a.defultLinkSend=function(n,i,s,d,l){var r=Date.parse(new Date),o=e.getNowFormatDate(),c=new FormData,p=i,h=s,g=d,m=l;-1==m.indexOf("http")&&-1==m.indexOf("https")&&(m="http://"+m);var u=r+a.MsgTimes;c.append("clienttype","web"),c.append("accountname",e.localUserName),c.append("cid",e.chatId),c.append("msgid",u),c.append("msgtype",495),c.append("imgandlinkid",n),1==e.type?c.append("group",1):c.append("group",0),t({method:"POST",url:e.link1+"/message/sendGcMessageImgAndLink",data:c,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(t){if(200==t.code){var n="";n+="                        <li dataid="+u+'>\n                            <div class="nesHead">\n                                <img src='+e.chatHead+' alt="">\n                            </div>\n                            <a href='+m+' target="_blank">\n                            <div class="news news-link">\n                                <img class="jiao" src="images/bluejiao.png" alt="">\n                                <div class="defult-Link-Add">\n                                    <span class="defult-Link-title">'+p+'</span>\n                                    <dl>\n                                        <dd>\n                                            <span class="up-file-con">\n                                        '+h+'    </span>\n                                        </dd>\n                                        <dt><img class="up-file-icon" src='+g+"></dt>\n\n                                    </dl>\n                                </div>\n                            </div>\n                            </a>\n                        </li>",$(".newsList").append(n);for(var i=0;i<e.Chatwithfriends[e.lplplpl].length;i++)e.Chatwithfriends[e.lplplpl][i].cid==a.chatId&&(e.Chatwithfriends[e.lplplpl][i].newMessage="[图文链接]",e.Chatwithfriends[e.lplplpl][i].lastChatTime=o);for(var s=0;s<e.Chatwithfriends[e.socialaccountId].length;s++)e.Chatwithfriends[e.socialaccountId][s].cid==e.chatId&&(e.Chatwithfriends[e.socialaccountId][s].newMessage="[图文链接]",e.Chatwithfriends[e.socialaccountId][s].lastChatTime=o);for(s=0;s<e.Chatwithfriends[-1].length;s++)e.Chatwithfriends[-1][s].cid==e.chatId&&(e.Chatwithfriends[-1][s].newMessage="[图文链接]",e.Chatwithfriends[-1][s].lastChatTime=o);var d=$(".RightCont")[0].scrollHeight;$(".RightCont").animate({scrollTop:d},500),$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+a.chatId+'"]').html("[图文链接]");$(".newsList").html();if(e.friendStorage.hasOwnProperty(a.chatId)?e.friendStorage[a.chatId]+=n:e.friendStorage[a.chatId]=n,1==e.Topjudge){for(var l="",r=0,c=0;c<e.Chatwithfriends[e.lplplpl].length;c++)e.Chatwithfriends[e.lplplpl][c].cid==e.chatId&&(l=e.Chatwithfriends[e.lplplpl][c],r=c);e.Chatwithfriends[e.lplplpl].splice(r,1),e.Chatwithfriends[e.lplplpl].splice(0,0,l),a.$watch(function(){e.frienfList=e.Chatwithfriends[e.lplplpl]}),setTimeout(function(){$(".page1-Maindiv2-myfriends-search-con-ul1 li").find('span[data^="'+e.chatId+'"]').parent().addClass("click-background-color").siblings().removeClass("click-background-color");var a=e.Chatwithfriends[e.lplplpl].length;a>50&&(a=50);for(var t=0;t<a;t++){var n=e.Chatwithfriends[e.lplplpl][t].cid;if(""!=e.Chatwithfriends[e.lplplpl][t].newMessage?$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.Chatwithfriends[e.lplplpl][t].cid+'"]').html(e.Chatwithfriends[e.lplplpl][t].newMessage):$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.Chatwithfriends[e.lplplpl][t].cid+'"]').html(""),e.friendStorage.hasOwnProperty(n)){var i=e.friendStorage[n].split("Unread").length-1;i>0?$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","inline-block").html(i):$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","none").html("")}else $(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","none").html("")}},0)}else{l="",r=0;var f=0;for(c=0;c<e.Chatwithfriends[e.lplplpl].length;c++)e.Chatwithfriends[e.lplplpl][c].cid==e.chatId&&(l=e.Chatwithfriends[e.lplplpl][c],f=c),1==e.Chatwithfriends[e.lplplpl][c].topNumber&&r++;e.Chatwithfriends[e.lplplpl].splice(f,1),e.Chatwithfriends[e.lplplpl].splice(r,0,l),a.$watch(function(){e.frienfList=e.Chatwithfriends[e.lplplpl]}),setTimeout(function(){$(".page1-Maindiv2-myfriends-search-con-ul1 li").find('span[data^="'+e.chatId+'"]').parent().addClass("click-background-color").siblings().removeClass("click-background-color"),$(".page1-Maindiv2-myfriends-search-con-ul1").find(".page1-Maindiv2-myfriends-search-con-ul-tagname1").html(""),$(".page1-Maindiv2-myfriends-search-con-ul1").find(".new-msg-number").css("display","none").html("");var a=e.Chatwithfriends[e.lplplpl].length;a>50&&(a=50);for(var t=0;t<a;t++){var n=e.Chatwithfriends[e.lplplpl][t].cid;if(""!=e.Chatwithfriends[e.lplplpl][t].newMessage?$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.Chatwithfriends[e.lplplpl][t].cid+'"]').html(e.Chatwithfriends[e.lplplpl][t].newMessage):$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.Chatwithfriends[e.lplplpl][t].cid+'"]').html(""),e.friendStorage.hasOwnProperty(n)){var i=e.friendStorage[n].split("Unread").length-1;i>0?$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","inline-block").html(i):$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","none").html("")}else $(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","none").html("")}},0)}}})},$(".chat-bottom-write").keydown(function(n){var i=window.event?n.keyCode:n.which,d=n||window.event,l=$(this),r=e.getNowFormatDate();if(13==i&&!d.ctrlKey)if(""==(u=$(this).html()));else{for(var o=u.replace(/<div(([\s\S])*?)<\/div>/g,""),c="",p=Date.parse(new Date)+a.MsgTimes,h=!1,g=[".com",".net",".org",".com.cn",".net.cn",".org.cn",".gov","www.","http","https"],m=0;m<g.length;m++)if(u.indexOf(""+g[m])>0){h=!0;break}if(0==h);else var u=u.replace(/((https?|ftp):\/\/)?([-A-Za-z0-9+&@#/%?=~_|!:,.;]+\.[A-Za-z0-9]+[\/=\?%\-&_~`@[\]\':+!]*\w)/gi,function(e,a,t){return'<a class="open-other-url"  target="_blank"  href="'+e+'">'+e+"</a>"});c+="                    <li dataid="+p+'>\n                        <div class="nesHead">\n                            <img src='+e.chatHead+' alt="">\n                        </div>\n                        <div class="news">\n                            <img class="jiao" src="images/bluejiao.png" alt="">\n                           '+u+"\n                        </div>\n                    </li>";var f=/\/([^\/]*?\.gif)/i,v=u.match(/<img.*?(?:>|\/>)/g);if(null==v);else{var w=[];for(m=0;m<v.length;m++){var y=v[m].match(f);y[1]&&w.push(y[1].substring(0,y[1].indexOf(".")));for(var b=[],C=0;C<w.length;C++)for(var k=0;k<s.length;k++)w[C]==k&&b.push(s[k-1])}var I=u.match(/<img.*?(?:>|\/>)/g);for(m=0;m<I.length;m++)u=u.replace(I[m],b[m])}var T=u.replace(/<\/div>/g,"").replace(/<br>/g,"").replace(/<div>/g,"<br>"),M=new FormData;M.append("clienttype","web"),M.append("accountname",e.localUserName),M.append("cid",e.chatId),M.append("msgid",p),M.append("msgtype",1),M.append("msgcontent",T),1==e.type?M.append("group",1):M.append("group",0),M.append("file",""),M.append("filePath",""),t({method:"POST",url:e.link1+"/message/sendGcMessageInfo",data:M,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(t){if(200==t.code){$(".newsList").append(c);for(var i=0;i<e.Chatwithfriends[e.lplplpl].length;i++)e.Chatwithfriends[e.lplplpl][i].cid==a.chatId&&(e.Chatwithfriends[e.lplplpl][i].newMessage=u,e.Chatwithfriends[e.lplplpl][i].lastChatTime=r);for(var s=0;s<e.Chatwithfriends[e.socialaccountId].length;s++)e.Chatwithfriends[e.socialaccountId][s].cid==e.chatId&&(e.Chatwithfriends[e.socialaccountId][s].newMessage=u,e.Chatwithfriends[e.socialaccountId][s].lastChatTime=r);for(s=0;s<e.Chatwithfriends[-1].length;s++)e.Chatwithfriends[-1][s].cid==e.chatId&&(e.Chatwithfriends[-1][s].newMessage=u,e.Chatwithfriends[-1][s].lastChatTime=r);var d=$(".RightCont")[0].scrollHeight;$(".RightCont").animate({scrollTop:d},500),$(".chat-bottom-write").html(""),$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+a.chatId+'"]').html(o);$(".newsList").html();if(e.friendStorage.hasOwnProperty(a.chatId)?e.friendStorage[a.chatId]+=c:e.friendStorage[a.chatId]=c,1==e.Topjudge){for(var l=0,p=0;p<e.Chatwithfriends[e.lplplpl].length;p++)if(e.Chatwithfriends[e.lplplpl][p].cid==e.chatId){var h=e.Chatwithfriends[e.lplplpl][p];l=p}e.Chatwithfriends[e.lplplpl].splice(l,1),e.Chatwithfriends[e.lplplpl].splice(0,0,h),a.$watch(function(){e.frienfList=e.Chatwithfriends[e.lplplpl]}),setTimeout(function(){$(".page1-Maindiv2-myfriends-search-con-ul1 li").find('span[data^="'+e.chatId+'"]').parent().addClass("click-background-color").siblings().removeClass("click-background-color");var a=e.Chatwithfriends[e.lplplpl].length;a>50&&(a=50);for(var t=0;t<a;t++){var n=e.Chatwithfriends[e.lplplpl][t].cid;if(""!=e.Chatwithfriends[e.lplplpl][t].newMessage?$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.Chatwithfriends[e.lplplpl][t].cid+'"]').html(e.Chatwithfriends[e.lplplpl][t].newMessage):$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.Chatwithfriends[e.lplplpl][t].cid+'"]').html(""),e.friendStorage.hasOwnProperty(n)){var i=e.friendStorage[n].split("Unread").length-1;i>0?$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","inline-block").html(i):$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","none").html("")}else $(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","none").html("")}},0)}else{var g=0,m=1,f="";for(p=0;p<e.Chatwithfriends[e.lplplpl].length;p++)1==e.Chatwithfriends[e.lplplpl][p].topNumber&&g++,e.Chatwithfriends[e.lplplpl][p].cid==e.chatId&&(f=e.Chatwithfriends[e.lplplpl][p],m=p);e.Chatwithfriends[e.lplplpl].splice(m,1),e.Chatwithfriends[e.lplplpl].splice(g,0,f),a.$watch(function(){e.frienfList=e.Chatwithfriends[e.lplplpl]}),setTimeout(function(){$(".page1-Maindiv2-myfriends-search-con-ul1 li").find('span[data^="'+e.chatId+'"]').parent().addClass("click-background-color").siblings().removeClass("click-background-color"),$(".page1-Maindiv2-myfriends-search-con-ul1").find(".page1-Maindiv2-myfriends-search-con-ul-tagname1").html(""),$(".page1-Maindiv2-myfriends-search-con-ul1").find(".new-msg-number").css("display","none").html("");var a=e.Chatwithfriends[e.lplplpl].length;a>50&&(a=50);for(var t=0;t<a;t++){var n=e.Chatwithfriends[e.lplplpl][t].cid;if(""!=e.Chatwithfriends[e.lplplpl][t].newMessage?$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.Chatwithfriends[e.lplplpl][t].cid+'"]').html(e.Chatwithfriends[e.lplplpl][t].newMessage):$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.Chatwithfriends[e.lplplpl][t].cid+'"]').html(""),e.friendStorage.hasOwnProperty(n)){var i=e.friendStorage[n].split("Unread").length-1;i>0?$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","inline-block").html(i):$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","none").html("")}else $(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","none").html("")}},0)}return n.preventDefault(),!1}1e3==t.code?($(".gray-help").css("display","block"),$(".gray-help-say").css("display","block"),$(".gray-help-say-con-text").html("暂不支持收发消息，请开启营销系统")):1001==t.code?($(".gray-help").css("display","block"),$(".gray-help-say").css("display","block"),$(".gray-help-say-con-text").html("图片大小暂时支持<=10M")):1002==t.code&&($(".gray-help").css("display","block"),$(".gray-help-say").css("display","block"),$(".gray-help-say-con-text").html("文件大小暂时支持<=25M"))})}if(d.ctrlKey&&13==i)return l.html(l.html()+"<div><br></div>"),function(e){if(e.focus(),void 0!==window.getSelection&&void 0!==document.createRange){var a=document.createRange();a.selectNodeContents(e),a.collapse(!1);var t=window.getSelection();t.removeAllRanges(),t.addRange(a)}else if(void 0!==document.body.createTextRange){var n=document.body.createTextRange();n.moveToElementText(e),n.collapse(!1),n.select()}}(l.get(0)),!1}),a.chatFriendToTop=function(n,i,s,d){var l=new FormData;-1==i?l.append("id",e.Id):l.append("id",i),-1==n?l.append("topnumber",e.Topjudge):l.append("topnumber",n),-1==s?l.append("type",e.type):l.append("type",s);var r="",o="";t({method:"POST",url:e.link1+"/latelychat/updateContactAndChatroomByTop",data:l,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(t){if(200==t.code){var i=0,s=0,l="",c=0,p=0,h="",g=0,m=0,u="",f=!1,v=!1,w="";if(r=-1==n?e.Topjudge:n,o=-1==d?e.chatId:d,0==r){o===e.chatId&&($(".chat-top-totop").css("background",'url("./images/Canceltop.png") center no-repeat'),$(".chat-top-totop").attr("data",1),e.Topjudge=1);for(var y=0;y<e.Chatwithfriends[-1].length;y++)e.Chatwithfriends[-1][y].cid==o&&(i=y,l=e.Chatwithfriends[-1][y],f=!0),1==e.Chatwithfriends[-1][y].topNumber&&s++;for(y=0;y<e.Chatwithfriends[e.lplplpl].length;y++)e.Chatwithfriends[e.lplplpl][y].cid==o&&(c=y,h=e.Chatwithfriends[e.lplplpl][y],w=e.Chatwithfriends[e.lplplpl][y].socialaccountId,v=!0),1==e.Chatwithfriends[e.lplplpl][y].topNumber&&p++;for(y=0;y<e.Chatwithfriends[w].length;y++)e.Chatwithfriends[w][y].cid==o&&(g=y,u=e.Chatwithfriends[w][y]),1==e.Chatwithfriends[w][y].topNumber&&m++;1==f?-1==e.lplplpl?0==v?(e.Chatwithfriends[-1].splice(i,1),e.Chatwithfriends[-1].splice(0,0,l),e.Chatwithfriends[-1][0].topNumber=1):(e.Chatwithfriends[-1].splice(i,1),e.Chatwithfriends[-1].splice(0,0,l),e.Chatwithfriends[-1][0].topNumber=1,e.Chatwithfriends[w].splice(g,1),e.Chatwithfriends[w].splice(0,0,u),e.Chatwithfriends[w][0].topNumber=1):(e.Chatwithfriends[-1].splice(i,1),e.Chatwithfriends[-1].splice(0,0,l),e.Chatwithfriends[-1][0].topNumber=1,e.Chatwithfriends[e.lplplpl].splice(c,1),e.Chatwithfriends[e.lplplpl].splice(0,0,h),e.Chatwithfriends[e.lplplpl][0].topNumber=1):(e.Chatwithfriends[e.lplplpl].splice(p,1),e.Chatwithfriends[e.lplplpl].splice(0,0,h),e.Chatwithfriends[e.lplplpl][0].topNumber=1),a.$watch(function(){e.frienfList=e.Chatwithfriends[e.lplplpl]}),setTimeout(function(){$(".page1-Maindiv2-myfriends-search-con-ul1 li").find('span[data^="'+o+'"]').parent().addClass("click-background-color").siblings().removeClass("click-background-color"),$(".page1-Maindiv2-myfriends-search-con-ul1").find(".page1-Maindiv2-myfriends-search-con-ul-tagname1").html(""),$(".page1-Maindiv2-myfriends-search-con-ul1").find(".new-msg-number").css("display","none").html("");var a=e.Chatwithfriends[e.lplplpl].length;a>50&&(a=50);for(var t=0;t<a;t++){var n=e.Chatwithfriends[e.lplplpl][t].cid;if(""!=e.Chatwithfriends[e.lplplpl][t].newMessage&&$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.Chatwithfriends[e.lplplpl][t].cid+'"]').html(e.Chatwithfriends[e.lplplpl][t].newMessage),e.friendStorage.hasOwnProperty(n)){var i=e.friendStorage[n].split("Unread").length-1;i>0?$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","inline-block").html(i):$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","none").html("")}else $(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","none").html("")}},150),e.TotopNum=e.TotopNum+1}else{o===e.chatId&&($(".chat-top-totop").css("background",'url("./images/toTop.png") center no-repeat'),$(".chat-top-totop").attr("data",0),e.Topjudge=0);for(y=0;y<e.Chatwithfriends[-1].length;y++)e.Chatwithfriends[-1][y].cid==o&&(i=y,l=e.Chatwithfriends[-1][y],e.Chatwithfriends[-1][y].topNumber=0,f=!0),1==e.Chatwithfriends[-1][y].topNumber&&s++;for(y=0;y<e.Chatwithfriends[e.lplplpl].length;y++)e.Chatwithfriends[e.lplplpl][y].cid==o&&(e.Chatwithfriends[e.lplplpl][y].topNumber=0,c=y,h=e.Chatwithfriends[e.lplplpl][y],w=e.Chatwithfriends[e.lplplpl][y].socialaccountId,v=!0),1==e.Chatwithfriends[e.lplplpl][y].topNumber&&p++;for(y=0;y<e.Chatwithfriends[w].length;y++)e.Chatwithfriends[w][y].cid==o&&(g=y,u=e.Chatwithfriends[w][y]),1==e.Chatwithfriends[w][y].topNumber&&m++;1==f?-1==e.lplplpl?0==v?(e.Chatwithfriends[-1].splice(i,1),e.Chatwithfriends[-1].splice(s,0,l),e.Chatwithfriends[-1][s].topNumber=0):(e.Chatwithfriends[-1].splice(i,1),e.Chatwithfriends[-1].splice(s,0,l),e.Chatwithfriends[-1][s].topNumber=0,e.Chatwithfriends[w].splice(g,1),e.Chatwithfriends[w].splice(m,0,u),e.Chatwithfriends[w][m].topNumber=0):(e.Chatwithfriends[-1].splice(i,1),e.Chatwithfriends[-1].splice(s,0,l),e.Chatwithfriends[-1][s].topNumber=0,e.Chatwithfriends[e.lplplpl].splice(c,1),e.Chatwithfriends[e.lplplpl].splice(p,0,h),e.Chatwithfriends[e.lplplpl][p].topNumber=0):(e.Chatwithfriends[e.lplplpl].splice(c,1),e.Chatwithfriends[e.lplplpl].splice(p,0,h),e.Chatwithfriends[e.lplplpl][p].topNumber=0),a.$watch(function(){e.frienfList=e.Chatwithfriends[e.lplplpl]}),e.TotopNum=e.TotopNum-1,setTimeout(function(){$(".page1-Maindiv2-myfriends-search-con-ul1 li").find('span[data^="'+o+'"]').parent().addClass("click-background-color").siblings().removeClass("click-background-color"),$(".page1-Maindiv2-myfriends-search-con-ul1").find(".page1-Maindiv2-myfriends-search-con-ul-tagname1").html(""),$(".page1-Maindiv2-myfriends-search-con-ul1").find(".new-msg-number").css("display","none").html("");var a=e.Chatwithfriends[e.lplplpl].length;a>50&&(a=50);for(var t=0;t<a;t++){var n=e.Chatwithfriends[e.lplplpl][t].cid;if(""!=e.Chatwithfriends[e.lplplpl][t].newMessage&&$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.Chatwithfriends[e.lplplpl][t].cid+'"]').html(e.Chatwithfriends[e.lplplpl][t].newMessage),e.friendStorage.hasOwnProperty(n)){var i=e.friendStorage[n].split("Unread").length-1;i>0?$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","inline-block").html(i):$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","none").html("")}else $(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","none").html("")}},50)}}})},e.groupmemberHeader="";a.gotoChat=function(n,i,d,l,r,o,c,p,h,g){if("search_list"==$(p.target).attr("data1_nickname"))if(e.Searchhistory_Chatting.length>=5)if(e.Searchhistory_Chatting=e.Searchhistory_Chatting.slice(0,4),""==a.serach_Keyword||null==a.serach_Keyword);else{for(var m=!0,u=0;u<e.Searchhistory_Chatting.length;u++)if(u==a.serach_Keyword){m=!1;break}1==m&&e.Searchhistory_Chatting.unshift(a.serach_Keyword)}else if(0==e.Searchhistory_Chatting.length)e.Searchhistory_Chatting.push(a.serach_Keyword);else{for(m=!0,u=0;u<e.Searchhistory_Chatting.length;u++)if(e.Searchhistory_Chatting[u]==a.serach_Keyword){m=!1;break}1==m&&e.Searchhistory_Chatting.unshift(a.serach_Keyword)}$(".personaldata-data-con-myself-1-input").attr("disabled","disabled").css("border","1px solid transparent"),$(".personaldata-data-con-myself-3-select").css("display","none"),$(".personaldata-data-con-myself-3-span").css("display","inline-block"),$(".personaldata-data-con-myself-5-textarea-whiteMeContent").attr("disabled","disabled").css("border","1px solid  transparent"),$(".edit-personaldata").html("修改资料").attr("data",0),$(".personaldata").css("display","none"),$(".chat-bottom-write").html("");var f=!1;$(".all-customer-search-logo-input").val("");for(u=0;u<e.Judgingthesendingmessage.length;u++)if(r==e.Judgingthesendingmessage[u]){f=!0;break}if($(".Newmessagereminding").css("display","none"),e.unreadMessages=0,1==f?($(".Chat-layer").css("display","block"),$(".Chat-layer-say").css("display","block")):($(".Chat-layer").css("display","none"),$(".Chat-layer-say").css("display","none")),$(".page1-div3-title-span1").css({color:"rgb(68, 186, 246)","border-bottom":"2px solid rgb(68, 186, 246)"}),$(".page1-div3-title-span2").css({color:"#444444",border:"none"}),$(".page1-div3-title-span3").css({color:"#444444",border:"none"}),0==$(p.target).attr("distinguish")?$(p.target).addClass("click-background-color").siblings().removeClass("click-background-color"):$(p.target).parent().addClass("click-background-color").siblings().removeClass("click-background-color"),$(".page1-Maindiv2-listInit").css("display","none"),1==c?($(".chat-top-totop").css("background",'url("./images/Canceltop.png") center no-repeat'),$(".chat-top-totop").attr("data",1)):($(".chat-top-totop").css("background",'url("./images/toTop.png") center no-repeat'),$(".chat-top-totop").attr("data",0)),a.page1Maindiv4Init=!1,a.Customerinformation=!0,a.quickReply=!1,a.customerRecord=!1,a.page1Maindiv4Init=!1,a.Customerinformation=!0,a.quickReply=!1,a.customerRecord=!1,1==o?(a.chatGroupOrFriend=1,a.myself1=!0,a.allCustomerList=!1,a.myself=!1,a.groupdata=new FormData,a.groupdata.append("socialaccountId",r),a.groupdata.append("chatroomId",l),t({method:"POST",url:e.link+"/contact/getChatroomById",data:a.groupdata,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(n){var i=n.data.tags;a.FriendTags=i.split(","),a.Mygroupdata=n.data,a.GroupId=n.data.groupId,$(".whiteMeContent").val(n.data.chatroomDescription),$(".chzn-results li").css("display","block"),t({method:"POST",url:e.link+"/groups/getGroups",data:a.MyFrienddata,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){a.InformationGrouping=e.data.groupList,setTimeout(function(){0==a.GroupId?$(".four-select").val(0):$(".four-select").val(a.GroupId)},10)})})):(a.chatGroupOrFriend=0,a.allCustomerList=!1,a.myself=!0,a.myself1=!1,a.MyFrienddata=new FormData,a.MyFrienddata.append("socialaccountId",r),a.MyFrienddata.append("contactId",l),t({method:"POST",url:e.link+"/contact/getContactById",data:a.MyFrienddata,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(n){a.MyFrienddata1=n.data,$(".change-name").html(e.GetridoftheNbsp(n.data.noteName)),e.NameRecord=n.data.noteName,$(".change-phone").val(n.data.phone),$(".whiteMeContent").val(n.data.description);var i=n.data.tags;a.FriendTags=i.split(","),a.GroupId=n.data.groupId,$(".chzn-results li").css("display","block"),t({method:"POST",url:e.link+"/groups/getGroups",data:a.MyFrienddata,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){a.InformationGrouping=e.data.groupList,setTimeout(function(){0==a.GroupId?$(".page1-div3-content-myself-select").val(0):$(".page1-div3-content-myself-select").val(a.GroupId)},10)})})),a.chatName=i,e.chatId=n,e.chatHead=e.WeChatownerHeader[r],e.Id=l,e.socialaccountId=r,e.type=o,e.Topjudge=c,e.ChatPhoto=d,0==h){var v=a.chatListSEarch[g],w=0,y=0,b="",C=0,k=!1,I=!1;for(u=0;u<e.Chatwithfriends[-1].length;u++)e.Chatwithfriends[-1][u].cid==n&&(w=u,b=e.Chatwithfriends[-1][u],k=!0),1==e.Chatwithfriends[-1][u].topNumber&&y++;for(u=0;u<e.Chatwithfriends[e.lplplpl].length;u++)e.Chatwithfriends[e.lplplpl][u].cid==n&&(u,e.Chatwithfriends[e.lplplpl][u],e.Chatwithfriends[e.lplplpl][u].socialaccountId,I=!0,e.Chatwithfriends[-1][u]),1==e.Chatwithfriends[e.lplplpl][u].topNumber&&C++;0==k&&0==I?1==c?(e.Chatwithfriends[-1].splice(0,0,v),e.Chatwithfriends[r].splice(0,0,v)):(e.Chatwithfriends[-1].splice(y,0,v),e.Chatwithfriends[r].splice(C,0,v)):1==k&&1==I?1==c?(e.Chatwithfriends[-1].splice(w,1),e.Chatwithfriends[-1].splice(0,0,v),e.Chatwithfriends[r].splice(0,1),e.Chatwithfriends[r].splice(0,0,v)):(e.Chatwithfriends[-1].splice(w,1),e.Chatwithfriends[-1].splice(y,0,v),e.Chatwithfriends[r].splice(0,1),e.Chatwithfriends[r].splice(C,0,v)):1==k&&0==I&&-1!=e.lplplpl?1==c?(e.Chatwithfriends[-1].splice(w,1),e.Chatwithfriends[-1].splice(0,0,b),e.Chatwithfriends[e.lplplpl].splice(0,0,v)):(e.Chatwithfriends[-1].splice(w,1),e.Chatwithfriends[-1].splice(y,0,b),e.Chatwithfriends[e.lplplpl].splice(C,0,v)):1==k&&0==I&&-1==e.lplplpl?1==c?(e.Chatwithfriends[-1].splice(w,1),e.Chatwithfriends[-1].splice(0,0,b),e.Chatwithfriends[r].splice(0,0,v)):(e.Chatwithfriends[-1].splice(w,1),e.Chatwithfriends[-1].splice(y,0,b),e.Chatwithfriends[r].splice(C,0,v)):0==k&&1==I&&-1==e.lplplpl?1==c?(e.Chatwithfriends[-1].splice(0,0,v),e.Chatwithfriends[r].splice(0,0,v)):(e.Chatwithfriends[-1].splice(y,0,v),e.Chatwithfriends[r].splice(0,1),e.Chatwithfriends[r].splice(0,0,v)):0==k&&1==I&&-1!=e.lplplpl&&(1==c?(e.Chatwithfriends[-1].splice(0,0,v),e.Chatwithfriends[r].splice(0,1),e.Chatwithfriends[r].splice(0,0,v)):(e.Chatwithfriends[-1].splice(y,0,v),e.Chatwithfriends[r].splice(0,1),e.Chatwithfriends[r].splice(0,0,v))),e.frienfList=e.Chatwithfriends[e.lplplpl],setTimeout(function(){$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').parent().addClass("click-background-color").siblings().removeClass("click-background-color")},100)}a.page1Maindiv4Init=!1,$(".page1-Maindiv3").attr("data",n).css("background","none"),$(".newsList").html(""),$(".chat-top-title").html(i),a.ChatModule=!0,$(".forPhone-content").find('span[class^="blue"]').html(e.WeChatowner[e.socialaccountId]);var T=e.friendStorage[e.chatId];if(null==T||null==T);else{var M=T.match(/\[[^\]]+\]/g);if(null==M||0==M||null==M){T=T.replace(/<br>/g,"").replace(/undefined/g,"")}else{for(var S=[],F=[],P=0;P<M.length;P++)for(var L=0;L<s.length;L++)M[P]==s[L]&&(S.push('<img class="emoji_icon" src="images/qq/'+(L+1)+'.gif">'),F.push(s[L]));for(var _=0;_<S.length;_++)T=T.replace(F[_],S[_]);T=T.replace(/<br>/g,"").replace(/undefined/g,"")}}$(".newsList").html(T),setTimeout(function(){if(""==e.friendStorage[n]||null==e.friendStorage[n]?$(".ChatRecord").html("---------------- 更多消息请查看聊天记录 ----------------").css("cursor","default"):e.friendStorage[n].indexOf("initNone")>=0?$(".ChatRecord").html("-------------------- 查看更多消息 --------------------").css("cursor","pointer"):$(".ChatRecord").html("---------------- 更多消息请查看聊天记录 ----------------").css("cursor","default"),$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","none"),""==e.friendStorage[n]||null==e.friendStorage[n]);else{var a=e.friendStorage[n].replace(/Unread/g,"Read");e.friendStorage[n]=a}var t=$(".RightCont")[0].scrollHeight;$(".RightCont").animate({scrollTop:t},400)},50)},a.LoadHistoryRecord=function(a){if("更多消息请查看聊天记录"==$(a.target).html());else{$(".ChatRecord").html("---------------- 更多消息请查看聊天记录 ----------------").css("cursor","default"),$(".newsList li").removeClass("initNone"),$(".RightCont").scrollTop($(".RightCont")[0].scrollHeight-e.RightContscrollHeight);var t=e.friendStorage[e.chatId].replace(/initNone/g,"");e.friendStorage[e.chatId]=t}},e.RightContscrollHeight=0,e.RightContscrollTop=0,e.RightContoffsetHeight=0,a.LookNewMsg=function(){var e=$(".RightCont")[0].scrollHeight;$(".RightCont").animate({scrollTop:e},500),$(".Newmessagereminding").css("display","none")},a.NotLookNewMsg=function(){$(".Newmessagereminding").css("display","none")},$(document).ready(function(){$(".RightCont").scroll(function(){e.RightContscrollHeight=$(this)[0].scrollHeight,e.RightContoffsetHeight=$(this)[0].offsetHeight,e.RightContscrollTop=$(this)[0].scrollTop,e.RightContscrollHeight-e.RightContoffsetHeight==e.RightContscrollTop&&(e.unreadMessages=0,$(".Newmessagereminding").css("display","none"))})});a.CloseChatModule=function(){e.unreadMessages=0,$(".Newmessagereminding").css("display","none"),$(".Chat-layer").css("display","none"),$(".Chat-layer-say").css("display","none"),a.page1Maindiv4Init=!0,a.ChatModule=!1,$(".chat-bottom-write").html(""),$(".page1-Maindiv3").css("background",'url("./images/chatBg.png") center no-repeat'),$(".personaldata-data-con-myself-1-input").attr("disabled","disabled").css("border","1px solid transparent"),$(".personaldata-data-con-myself-3-select").css("display","none"),$(".personaldata-data-con-myself-3-span").css("display","inline-block"),$(".personaldata-data-con-myself-5-textarea-whiteMeContent").attr("disabled","disabled").css("border","1px solid  transparent"),$(".edit-personaldata").html("修改资料").attr("data",0),$(".personaldata").css("display","none")},$(document).on("click",".toggler",function(){"ng-scope tree-closed"==$(this).parent().attr("class")?$(this).find(".tree-icon").css({background:'url("./images/closesay.png")center no-repeat',transition:"0.15s"}):$(this).find(".tree-icon").css({background:'url("./images/opensay.png")center no-repeat',transition:"0.15s"})}),$(document).on("mouseenter",".picture-library-img",function(){$(this).find(".picture-library-img-del-bag").css("display","block")}),$(document).on("mouseleave ",".picture-library-img",function(){$(this).find(".picture-library-img-del-bag").css("display","none")}),a.delPicturelibraryImg=function(n,i){i.stopPropagation();var s=new FormData;s.append("id",n),t({method:"POST",url:e.link+"/picture/delPicture",data:s,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(n){if(200==n.code){var i=new FormData;t({method:"POST",url:e.link+"/picture/getAllPicture",data:i,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){200==e.code&&(a.Picturelibrary=e.data.pictureList)})}})},n(function(){for(var a=0;a<e.Chatwithfriends[-1].length;a++){var t=e.Chatwithfriends[-1][a].cid;e.Chatwithfriends[-1][a].newMessage;if(""!=e.Chatwithfriends[-1][a].newMessage){var n=e.Chatwithfriends[-1][a].newMessage;if(null==n||null==n||""==n);else{var i=n.match(/\[[^\]]+\]/g);if(null==i||0==i||null==i)e.Chatwithfriends[-1][a].newMessage=e.Chatwithfriends[-1][a].newMessage.replace(/<br>/g,"");else{for(var d=[],l=[],r=0;r<i.length;r++)for(var o=0;o<s.length;o++)i[r]==s[o]&&(d.push('<img class="emoji_icon" src="images/qq/'+(o+1)+'.gif">'),l.push(s[o]));for(var c=0;c<d.length;c++)n=n.replace(l[c],d[c]);e.Chatwithfriends[-1][a].newMessage=n.replace(/<br>/g,"")}}$(".page1-Maindiv2 .wechatList .moveFriendList").find('span[data^="'+t+'"]').html(e.Chatwithfriends[-1][a].newMessage)}else $(".page1-Maindiv2 .wechatList .moveFriendList").find('span[data^="'+t+'"]').html("")}},800),$(document).on("click",".picture-library-img-name",function(){$(this).attr("contenteditable",!0).css("border","1px solid #d8d8d8")}),$(document).on("blur",".picture-library-img-name",function(){$(this).attr("contenteditable",!1).css("border","1px solid transparent")}),a.upquickReplyPhrase=function(){},a.downquickReplyPhrase=function(){t.get(e.link+"/script/downfile").success(function(e){e.code})},a.upquickReplylibrary=function(){},$(".page1-div3-content-myself-select").change(function(){var a=$(this).val(),n=$(".page1-div3-content-name1").attr("data"),i=$(".page1-div3-content-name").html(),s=$(".page1-div3-content-name1").val(),d=$(".whiteMeContent").val(),l=new FormData;l.append("id",n),l.append("groupid",a),l.append("notename",i),l.append("phone",s),l.append("description",d),t({method:"POST",url:e.link1+"/contact/modifyContactById",data:l,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){e.code})}),a.Getthehomepage=function(){var n;1==e.type?((n=new FormData).append("chatroomId",e.Id),n.append("socialaccountid",e.socialaccountId),n.append("pagesize",15),n.append("pageindex",1),t({method:"POST",url:e.link1+"/chatrecord/getChatroomChatrecordPage",data:n,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(t){if(200==t.code){a.Chatrecordpagenumber=t.data.pageindex,a.AllChatrecordpagenumber=t.data.pagesumcount;for(var n=0;n<t.data.chatList.length;n++)3==t.data.chatList[n].msgStatus?(t.data.chatList[n].contactNickname="我",t.data.chatList[n].profilephoto=e.WeChatownerHeader[t.data.chatList[n].socialaccountId]):10==t.data.chatList[n].msgStatus&&""==t.data.chatList[n].profilephoto&&(t.data.chatList[n].profilephoto="./images/Destroy.png");a.Textrecord=t.data.chatList,a.TextrecordTime=t.data.thedate.slice(0,10),0==a.Textrecord.length?$(".chat-record").css("background",'url("../images/noChat.png") center no-repeat'):$(".chat-record").css("background","none")}})):((n=new FormData).append("contactid",e.Id),n.append("socialaccountid",e.socialaccountId),n.append("pagesize",15),n.append("pageindex",1),t({method:"POST",url:e.link1+"/chatrecord/getchatrecordpage",data:n,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(t){if(200==t.code){a.Chatrecordpagenumber=t.data.pageindex,a.AllChatrecordpagenumber=t.data.pagesumcount;for(var n=0;n<t.data.chatList.length;n++)0==t.data.chatList[n].msgStatus?(t.data.chatList[n].contactNickname="我",t.data.chatList[n].profilephoto=e.WeChatownerHeader[t.data.chatList[n].socialaccountId]):1==t.data.chatList[n].msgStatus&&(t.data.chatList[n].profilephoto=e.ChatPhoto);a.Textrecord=t.data.chatList,a.TextrecordTime=t.data.thedate.slice(0,10),0==a.Textrecord.length?$(".chat-record").css("background",'url("../images/noChat.png") center no-repeat'):$(".chat-record").css("background","none")}}))},a.Getthelastpage=function(){var n;(1==a.Chatrecordpagenumber?a.Chatrecordpagenumber=1:a.Chatrecordpagenumber=a.Chatrecordpagenumber-1,1==e.type)?((n=new FormData).append("chatroomId",e.Id),n.append("socialaccountid",e.socialaccountId),n.append("pagesize",15),n.append("pageindex",a.Chatrecordpagenumber),t({method:"POST",url:e.link1+"/chatrecord/getChatroomChatrecordPage",data:n,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(t){if(200==t.code){a.Chatrecordpagenumber=t.data.pageindex,a.AllChatrecordpagenumber=t.data.pagesumcount;for(var n=0;n<t.data.chatList.length;n++)3==t.data.chatList[n].msgStatus?(t.data.chatList[n].contactNickname="我",t.data.chatList[n].profilephoto=e.WeChatownerHeader[t.data.chatList[n].socialaccountId]):10==t.data.chatList[n].msgStatus&&""==t.data.chatList[n].profilephoto&&(t.data.chatList[n].profilephoto="./images/Destroy.png");a.Textrecord=t.data.chatList,a.TextrecordTime=t.data.thedate.slice(0,10),0==a.Textrecord.length?$(".chat-record").css("background",'url("../images/noChat.png") center no-repeat'):$(".chat-record").css("background","none")}})):((n=new FormData).append("contactid",e.Id),n.append("socialaccountid",e.socialaccountId),n.append("pagesize",15),n.append("pageindex",a.Chatrecordpagenumber),t({method:"POST",url:e.link1+"/chatrecord/getchatrecordpage",data:n,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(t){if(200==t.code){a.Chatrecordpagenumber=t.data.pageindex,a.AllChatrecordpagenumber=t.data.pagesumcount;for(var n=0;n<t.data.chatList.length;n++)0==t.data.chatList[n].msgStatus?(t.data.chatList[n].contactNickname="我",t.data.chatList[n].profilephoto=e.WeChatownerHeader[t.data.chatList[n].socialaccountId]):1==t.data.chatList[n].msgStatus&&(t.data.chatList[n].profilephoto=e.ChatPhoto);a.Textrecord=t.data.chatList,a.TextrecordTime=t.data.thedate.slice(0,10),0==a.Textrecord.length?$(".chat-record").css("background",'url("../images/noChat.png") center no-repeat'):$(".chat-record").css("background","none")}}))},a.Getthenextpage=function(){var n;(a.Chatrecordpagenumber==a.AllChatrecordpagenumber?a.Chatrecordpagenumber=a.AllChatrecordpagenumber:a.Chatrecordpagenumber=a.Chatrecordpagenumber+1,1==e.type)?((n=new FormData).append("chatroomId",e.Id),n.append("socialaccountid",e.socialaccountId),n.append("pagesize",15),n.append("pageindex",a.Chatrecordpagenumber),t({method:"POST",url:e.link1+"/chatrecord/getChatroomChatrecordPage",data:n,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(t){if(200==t.code){a.Chatrecordpagenumber=t.data.pageindex,a.AllChatrecordpagenumber=t.data.pagesumcount;for(var n=0;n<t.data.chatList.length;n++)3==t.data.chatList[n].msgStatus?(t.data.chatList[n].contactNickname="我",t.data.chatList[n].profilephoto=e.WeChatownerHeader[t.data.chatList[n].socialaccountId]):10==t.data.chatList[n].msgStatus&&""==t.data.chatList[n].profilephoto&&(t.data.chatList[n].profilephoto="./images/Destroy.png");a.Textrecord=t.data.chatList,a.TextrecordTime=t.data.thedate.slice(0,10),0==a.Textrecord.length?$(".chat-record").css("background",'url("../images/noChat.png") center no-repeat'):$(".chat-record").css("background","none")}})):((n=new FormData).append("contactid",e.Id),n.append("socialaccountid",e.socialaccountId),n.append("pagesize",15),n.append("pageindex",a.Chatrecordpagenumber),t({method:"POST",url:e.link1+"/chatrecord/getchatrecordpage",data:n,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(t){if(200==t.code){a.Chatrecordpagenumber=t.data.pageindex,a.AllChatrecordpagenumber=t.data.pagesumcount;for(var n=0;n<t.data.chatList.length;n++)0==t.data.chatList[n].msgStatus?(t.data.chatList[n].contactNickname="我",t.data.chatList[n].profilephoto=e.WeChatownerHeader[t.data.chatList[n].socialaccountId]):1==t.data.chatList[n].msgStatus&&(t.data.chatList[n].profilephoto=e.ChatPhoto);a.Textrecord=t.data.chatList,a.TextrecordTime=t.data.thedate.slice(0,10),0==a.Textrecord.length?$(".chat-record").css("background",'url("../images/noChat.png") center no-repeat'):$(".chat-record").css("background","none")}}))},a.Getthebackpage=function(){var n;1==e.type?((n=new FormData).append("chatroomId",e.Id),n.append("socialaccountid",e.socialaccountId),n.append("pagesize",15),n.append("pageindex",a.AllChatrecordpagenumber),t({method:"POST",url:e.link1+"/chatrecord/getChatroomChatrecordPage",data:n,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(t){if(200==t.code){a.Chatrecordpagenumber=t.data.pageindex,a.AllChatrecordpagenumber=t.data.pagesumcount;for(var n=0;n<t.data.chatList.length;n++)3==t.data.chatList[n].msgStatus?(t.data.chatList[n].contactNickname="我",t.data.chatList[n].profilephoto=e.WeChatownerHeader[t.data.chatList[n].socialaccountId]):10==t.data.chatList[n].msgStatus&&""==t.data.chatList[n].profilephoto&&(t.data.chatList[n].profilephoto="./images/Destroy.png");a.Textrecord=t.data.chatList,a.TextrecordTime=t.data.thedate.slice(0,10),0==a.Textrecord.length?$(".chat-record").css("background",'url("../images/noChat.png") center no-repeat'):$(".chat-record").css("background","none")}})):((n=new FormData).append("contactid",e.Id),n.append("socialaccountid",e.socialaccountId),n.append("pagesize",15),n.append("pageindex",a.AllChatrecordpagenumber),t({method:"POST",url:e.link1+"/chatrecord/getchatrecordpage",data:n,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(t){if(200==t.code){a.Chatrecordpagenumber=t.data.pageindex,a.AllChatrecordpagenumber=t.data.pagesumcount;for(var n=0;n<t.data.chatList.length;n++)0==t.data.chatList[n].msgStatus?(t.data.chatList[n].contactNickname="我",t.data.chatList[n].profilephoto=e.WeChatownerHeader[t.data.chatList[n].socialaccountId]):1==t.data.chatList[n].msgStatus&&(t.data.chatList[n].profilephoto=e.ChatPhoto);a.Textrecord=t.data.chatList,a.TextrecordTime=t.data.thedate.slice(0,10),0==a.Textrecord.length?$(".chat-record").css("background",'url("../images/noChat.png") center no-repeat'):$(".chat-record").css("background","none")}}))},a.searchTextfocus=function(n){if(1==e.type){var i=$(n.target).prev().val();(s=new FormData).append("chatroomtid",e.Id),s.append("socialaccountid",e.socialaccountId),s.append("keyword",i),t({method:"POST",url:e.link1+"/chatrecord/getChatrecordChatroom",data:s,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){200==e.code&&(a.chatRecord=!1,$(".customer-record-table-div").css("display","none"),$(".customer-record-time").css("display","none"),a.SearchkeywordsHistory=!0,"success"==e.msg?(a.returnCon=e.data.chatList,e.data.thedate.length>10?a.returnConTime=e.data.thedate.slice(0,10):a.returnConTime="",a.returnConNum=e.data.chatListcount):(a.returnCon=[],a.returnConNum=0,a.returnConTime=""))})}else{var s;i=$(n.target).prev().val();(s=new FormData).append("contactid",e.Id),s.append("socialaccountid",e.socialaccountId),s.append("keyword",i),t({method:"POST",url:e.link1+"/chatrecord/getChatrecord",data:s,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){200==e.code&&(a.chatRecord=!1,$(".customer-record-table-div").css("display","none"),$(".customer-record-time").css("display","none"),a.SearchkeywordsHistory=!0,"success"==e.msg?(a.returnCon=e.data.chatList,e.data.thedate.length>10?a.returnConTime=e.data.thedate.slice(0,10):a.returnConTime="",a.returnConNum=e.data.chatListcount):(a.returnCon=[],a.returnConNum=0,a.returnConTime=""))})}},a.hidesHistory=function(){a.chatRecord=!0,$(".customer-record-table-div").css("display","flex"),$(".customer-record-time").css("display","block"),a.SearchkeywordsHistory=!1,$(".chat-record-search").val("")},a.delOneTag=function(n){if(""==n||null==n||null==n);else if(1==a.chatGroupOrFriend){var i=$(".page1-div3-content-name-Group-First").attr("data"),s=$(".page1-div3-content-name-Group-First").attr("data1");(d=new FormData).append("id",i),d.append("socialaccountid",s),d.append("tags",n),t({method:"POST",url:e.link+"/contact/delChatroomTags",data:d,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(n){if(200==n.code){var d=new FormData;d.append("socialaccountId",s),d.append("chatroomId",i),t({method:"POST",url:e.link+"/contact/getChatroomById",data:d,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){var t=e.data.tags;a.FriendTags=t.split(",")})}})}else{var d;(d=new FormData).append("id",e.Id),d.append("socialaccountid",e.socialaccountId),d.append("tags",n),t({method:"POST",url:e.link+"/contact/delContactTags",data:d,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(n){if(200==n.code){var i=new FormData;i.append("socialaccountId",e.socialaccountId),i.append("contactId",e.Id),t({method:"POST",url:e.link+"/contact/getContactById",data:i,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){var t=e.data.tags;a.FriendTags=t.split(",")})}})}},a.Addressbook=!1,a.TbsearchCon=!1,a.TbsearchCon=!1,a.dropdownSearchShow=!1,a.Addressbookdata=!1,a.Addressbookfriends=!1,$(".page1-Maindiv2-myfriends-search-input1").bind("input propertychange",function(){var n=$(this).val(),i=new FormData;i.append("accountId",e.myaccountId),i.append("message",n),t({method:"POST",url:e.link+"/socialaccount/getSocialaccountByName",data:i,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(t){if(200==t.code&&t.data.socialaccountList.length>0){for(var n=0;n<t.data.socialaccountList.length;n++)t.data.socialaccountList[n].profilePhoto=e.imgSrc+t.data.socialaccountList[n].profilePhoto;a.tponeListSEarch=t.data.socialaccountList,$(".pho-bo-list-search1").css("display","block")}else $(".pho-bo-list-search1").css("display","none")})}),a.getphoneBookList=function(n,i,s,d){$(".page1-Maindiv7-forPhone .klk").html(s);var l=[];l.push(n);var r=new FormData;r.append("ids",JSON.stringify(l)),r.append("accountId",e.myaccountId),t({method:"POST",url:e.link+"/socialaccount/getChatroomAndContact",data:r,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(t){a.Addressbook=!1,e.MaillistInitId=n,e.MaillistInitCId=i,$(".page1-Maindiv7").css("background",'url("./images/phonegroup.png") center no-repeat'),e.searchReturnList=[[{name:"群"},[]],[{name:"A"},[]],[{name:"B"},[]],[{name:"C"},[]],[{name:"D"},[]],[{name:"E"},[]],[{name:"F"},[]],[{name:"G"},[]],[{name:"H"},[]],[{name:"I"},[]],[{name:"J"},[]],[{name:"K"},[]],[{name:"L"},[]],[{name:"M"},[]],[{name:"N"},[]],[{name:"O"},[]],[{name:"P"},[]],[{name:"Q"},[]],[{name:"R"},[]],[{name:"S"},[]],[{name:"T"},[]],[{name:"U"},[]],[{name:"V"},[]],[{name:"W"},[]],[{name:"X"},[]],[{name:"Y"},[]],[{name:"Z"},[]],[{name:"#"},[]]];for(var s=0;s<t.data.contactList.length;s++)for(var d=0;d<e.searchReturnList.length;d++)t.data.contactList[s].fristWord==e.searchReturnList[d][0].name&&(""==t.data.contactList[s].profilePhoto||null==t.data.contactList[s].profilePhoto||null==t.data.contactList[s].profilePhoto?t.data.contactList[s].profilePhoto="./images/Destroy.png":t.data.contactList[s].profilePhoto=e.imgSrc+t.data.contactList[s].profilePhoto,e.searchReturnList[d][1].push(t.data.contactList[s]));var l=$(".moveFriendList-phone");for(s=0;s<l.length;s++)$(".moveFriendList-phone").eq(s).attr("data")==n&&l.eq(s).css("background-color","rgba(68, 186, 246, 0.05)").siblings().css("background-color","#FFFFFF")})},a.searchListOneTo="微信";$(".page1-Maindiv6").on("click",".newSelect",function(){if(a.searchListOneTo="分组","请选择"!=$(".page1-Maindiv6-myfriends-chose-wechat .newSelectTitle").find("span").html()){e.watchThis=$(".page1-Maindiv6-myfriends-chose-wechat .newSelectTitle").find("span").html();for(var n=$(".select1"),i="",s=0;s<n.length;s++)$(".select1").eq(s).html()==e.watchThis&&(i=$(".select1").eq(s).attr("data-value"));if(-1==i){var d=[];d.push(e.MaillistInitId),(l=new FormData).append("ids",JSON.stringify(d)),l.append("accountId",e.myaccountId),t({method:"POST",url:e.link+"/socialaccount/getChatroomAndContact",data:l,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){e.searchReturnList=[[{name:"群"},[]],[{name:"A"},[]],[{name:"B"},[]],[{name:"C"},[]],[{name:"D"},[]],[{name:"E"},[]],[{name:"F"},[]],[{name:"G"},[]],[{name:"H"},[]],[{name:"I"},[]],[{name:"J"},[]],[{name:"K"},[]],[{name:"L"},[]],[{name:"M"},[]],[{name:"N"},[]],[{name:"O"},[]],[{name:"P"},[]],[{name:"Q"},[]],[{name:"R"},[]],[{name:"S"},[]],[{name:"T"},[]],[{name:"U"},[]],[{name:"V"},[]],[{name:"W"},[]],[{name:"X"},[]],[{name:"Y"},[]],[{name:"Z"},[]],[{name:"#"},[]]];for(var t=0;t<a.data.contactList.length;t++)for(var n=0;n<e.searchReturnList.length;n++)a.data.contactList[t].fristWord==e.searchReturnList[n][0].name&&(""==a.data.contactList[t].profilePhoto||null==a.data.contactList[t].profilePhoto||null==a.data.contactList[t].profilePhoto?a.data.contactList[t].profilePhoto="./images/Destroy.png":a.data.contactList[t].profilePhoto=e.imgSrc+a.data.contactList[t].profilePhoto,e.searchReturnList[n][1].push(a.data.contactList[t]));var i=$(".moveFriendList-phone");for(t=0;t<i.length;t++)$(".moveFriendList-phone").eq(t).attr("data")==e.MaillistInitId&&i.eq(t).css("background-color","rgba(68, 186, 246, 0.05)").siblings().css("background-color","#FFFFFF")})}else{var l;(l=new FormData).append("groupId",i),l.append("id",e.MaillistInitaccountId),t({method:"POST",url:e.link+"/socialaccount/getChatroomAndContactById",data:l,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(t){if(a.DDorTop=[],0==t.data.contactList.length||t.data.contactList==[])$(".Phone-book-dropdown-Search-Show").css("display","none");else{for(var n=0;n<t.data.contactList.length;n++)""==t.data.contactList[n].profilePhoto||null==t.data.contactList[n].profilePhoto||null==t.data.contactList[n].profilePhoto?t.data.contactList[n].profilePhoto="./images/Destroy.png":t.data.contactList[n].profilePhoto=e.imgSrc+t.data.contactList[n].profilePhoto;$(".Phone-book-dropdown-Search-Show").css("display","block"),a.DDorTop=t.data.contactList}})}}else $(".Phone-book-dropdown-Search-Show").css("display","none"),a.DDorTop=[]}),$(".csi2-list-1").on("click","li",function(){if("tel_search_list"==$(this).attr("data1_nickname"))if(e.Searchhistory_Maillist.length>=5)if(e.Searchhistory_Maillist=e.Searchhistory_Maillist.slice(0,4),""==a.serach_Keyword||null==a.serach_Keyword);else{for(var n=!0,i=0;i<e.Searchhistory_Maillist.length;i++)if(i==a.serach_Keyword){n=!1;break}1==n&&e.Searchhistory_Maillist.unshift(a.serach_Keyword)}else if(0==e.Searchhistory_Maillist.length)e.Searchhistory_Maillist.push(a.serach_Keyword);else{for(n=!0,i=0;i<e.Searchhistory_Maillist.length;i++)if(e.Searchhistory_Maillist[i]==a.serach_Keyword){n=!1;break}1==n&&e.Searchhistory_Maillist.unshift(a.serach_Keyword)}$(".Phone-book-dropdown-Search-Show").css("display","none"),$(".page1-Maindiv7").css("background","none"),e.telephoneFirstWrold=$(this).attr("data1"),"群"==$(this).attr("data1")?(a.Identifygroupsandfriends=1,a.Addressbookfriends=!1,a.Addressbookdata=!0):(a.Identifygroupsandfriends=0,a.Addressbookfriends=!0,a.Addressbookdata=!1),a.Addressbook=!0,e.impPhoId=$(this).attr("data2"),e.impPhoCid=$(this).attr("data18"),e.impPhosocialaccountId=$(this).attr("data3"),e.impPhonickName=$(this).attr("data4"),e.impPhocontactNumber=$(this).attr("data5"),e.impPhonoteName=$(this).attr("data6"),$(".imponoteName").html(e.impPhonoteName),e.impPhoprofilePhoto=$(this).attr("data7"),e.impPhophone=$(this).attr("data8"),e.impPhoTalias=$(this).attr("data20"),$(".imponotePhoneNumber").val($(this).attr("data8"));var s=[];$(this).attr("data9").indexOf(",")>0?s=$(this).attr("data9").split(","):$(this).attr("data9").length>0?s.push($(this).attr("data9")):s=[],e.impPhotags=s,e.impPhosex=$(this).attr("data10"),e.impPhoprovince=$(this).attr("data11"),e.impPhocity=$(this).attr("data12"),e.impPhodescription=$(this).attr("data13"),e.impPhochatroomAnnouncement=$(this).attr("data14"),e.impPhomyNickName=$(this).attr("data15"),e.impPhomemberCount=$(this).attr("data16"),e.impPhogroupId=$(this).attr("data17"),e.impPhoTopNumber=$(this).attr("data19"),$(".page1-Maindiv7-whiteMeContent").val(e.impPhodescription),t({method:"POST",url:e.link+"/groups/getGroups",data:a.MyFrienddata,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(t){a.impPhoAllGroups=t.data.groupList;for(var n=0;n<a.impPhoAllGroups.length;n++)a.impPhoAllGroups[n].id==e.impPhogroupId&&n;setTimeout(function(){$(".second-select").find("option[value="+e.impPhogroupId+"]").attr("selected",!0)},50)})}),$(".select-first-1,.page1-Maindiv6-con,.page1-Maindiv,.page1-Maindiv7,.page1-Maindiv5,.page1-Maindiv6-title,page1-Maindiv1").click(function(){$(".Phone-book-dropdown-Search-Show").css("display","none")}),a.Alphabetretrieval=function(a){for(var t,n=0,i=0;i<a;i++)n+=e.searchReturnList[i][1].length;t=20*a+50*n,$(".Alphabeticalnavigation-list").scrollTop(t)},e.telephoneFirstWrold="",a.getPhoneData=function(n,i,s,d,l,r,o,c,p,h,g,m,u,f,v,w,y,b,C){if($(".klk1").html(e.WeChatowner[s]),e.telephoneFirstWrold=n,$(".page1-Maindiv7").css("background","none"),"群"==n){a.Identifygroupsandfriends=1,a.Addressbookfriends=!1,a.Addressbookdata=!0;var k=new FormData;k.append("socialaccountId",s),k.append("chatroomId",i),t({method:"POST",url:e.link+"/contact/getChatroomById",data:k,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(n){e.impPhoId=n.data.id,e.impPhoCid=n.data.cid,e.impPhosocialaccountId=n.data.socialaccountId,e.impPhonickName=n.data.chatroomName,e.impPhomyNickName=n.data.myNickName,e.impPhogroupId=n.data.groupId,e.impPhomemberCount=n.data.memberCount,e.impPhochatroomAnnouncement=n.data.chatroomAnnouncement,e.impPhoprofilePhoto=e.imgSrc+n.data.chatroomProfilePhoto,""==n.data.chatroomProfilePhoto?e.impPhoprofilePhoto="./images/Destroy.png":e.impPhoprofilePhoto=e.imgSrc+n.data.chatroomProfilePhoto,e.impPhodescription=n.data.chatroomDescription,e.impPhotags=n.data.tags,e.impPhoTopNumber=n.data.topNumber,t({method:"POST",url:e.link+"/groups/getGroups",data:a.MyFrienddata,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(t){a.impPhoAllGroups=[],a.impPhoAllGroups=t.data.groupList,setTimeout(function(){"0"==e.impPhogroupId?($(".sree-select option").removeAttr("selected"),$(".sree-select option[value=0]").attr("selected",!0)):($(".sree-select option").removeAttr("selected"),$(".sree-select option[value="+e.impPhogroupId+"]").attr("selected",!0))},50)}),$(".imponoteName").html(e.impPhonoteName),$(".imponotePhoneNumber").val(e.impPhophone),$(".page1-Maindiv7-whiteMeContent").val(e.impPhodescription);var i=[];e.impPhotags.indexOf(",")>0?i=e.impPhotags.split(","):e.impPhotags.length>0?i.push(e.impPhotags):i=[],e.impPhotags1=i})}else{a.Identifygroupsandfriends=0,a.Addressbookfriends=!0,a.Addressbookdata=!1;var I=new FormData;I.append("socialaccountId",s),I.append("contactId",i),t({method:"POST",url:e.link+"/contact/getContactById",data:I,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(n){e.impPhoId=n.data.id,e.impPhoCid=n.data.cid,e.impPhosocialaccountId=n.data.socialaccountId,e.impPhonoteName=n.data.noteName,e.impPhocontactNumber=n.data.contactNumber,e.impPhonickName=n.data.nickName,""==n.data.profilePhoto?e.impPhoprofilePhoto="./images/Destroy.png":e.impPhoprofilePhoto=e.imgSrc+n.data.profilePhoto,e.impPhophone=n.data.phone,e.impPhotags=n.data.tags,e.impPhosex=n.data.sex,e.impPhoprovince=n.data.province,e.impPhocity=n.data.city,e.impPhodescription=n.data.description,e.impPhogroupId=n.data.groupId,e.impPhoTopNumber=n.data.topNumber,e.impPhoTalias=n.data.alias,t({method:"POST",url:e.link+"/groups/getGroups",data:a.MyFrienddata,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(t){a.impPhoAllGroups=t.data.groupList,"0"==e.impPhogroupId?($(".second-select option").removeAttr("selected"),$(".second-select option[value=0]").attr("selected",!0)):($(".second-select option").removeAttr("selected"),$(".second-select option[value="+e.impPhogroupId+"]").attr("selected",!0)),setTimeout(function(){$(".second-select").find("option[value="+e.impPhogroupId+"]").attr("selected",!0)},10)}),$(".imponoteName").html(e.impPhonoteName),$(".imponotePhoneNumber").val(e.impPhophone),$(".page1-Maindiv7-whiteMeContent").val(e.impPhodescription);var i=[];e.impPhotags.indexOf(",")>0?i=e.impPhotags.split(","):e.impPhotags.length>0?i.push(e.impPhotags):i=[],e.impPhotags1=i})}a.Addressbook=!0},$(".select-first-1-1").bind("input propertychange",function(){var n=$(this).val(),i=new FormData;i.append("message",n),i.append("accountId",e.MaillistInitaccountId),t({method:"POST",url:e.link+"/socialaccount/getContactByName",data:i,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(t){if(200==t.code){a.searchListOneTo="搜索";for(var n=0;n<t.data.contactList.length;n++)""==t.data.contactList[n].profilePhoto||null==t.data.contactList[n].profilePhoto||null==t.data.contactList[n].profilePhoto?t.data.contactList[n].profilePhoto="./images/Destroy.png":t.data.contactList[n].profilePhoto=e.imgSrc+t.data.contactList[n].profilePhoto;a.DDorTop=t.data.contactList,$(".Phone-book-dropdown-Search-Show").css("display","block")}})}),$(".all-customer-search-logo-input").bind("input propertychange",function(){var n=$(this).val();if(""==n||null==n||null==n){var i=new FormData;i.append("chatroomId",e.Id),i.append("id",e.socialaccountId),t({method:"POST",url:e.link+"/contact/getChatroommenber",data:i,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(t){for(var n=0;n<t.data.chatroommemberList.length;n++)t.data.chatroommemberList[n].profilePhoto=e.imgSrc+t.data.chatroommemberList[n].profilePhoto;a.Listofallgroupmembers=t.data.chatroommemberList})}else{var s=new FormData;s.append("chatroomId",e.Id),s.append("message",n),s.append("id",e.socialaccountId),t({method:"POST",url:e.link+"/contact/getChatroommemberByName",data:s,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(t){if(200==t.code){for(var n=0;n<t.data.chatroommemberList.length;n++)""==t.data.chatroommemberList[n].profilePhoto?t.data.chatroommemberList[n].profilePhoto="./images/Destroy.png":t.data.chatroommemberList[n].profilePhoto=e.imgSrc+t.data.chatroommemberList[n].profilePhoto;a.Listofallgroupmembers=t.data.chatroommemberList}else a.Listofallgroupmembers=[]})}}),a.editWhitMe1=function(){$(".page1-Maindiv7-whiteMeContent").attr("disabled",!1).css("border","solid 1px #75aaff"),$(".page1-Maindiv7-whiteMeContent").focus()},$(".page1-Maindiv7-whiteMeContent").blur(function(){if($(".page1-Maindiv7-whiteMeContent").attr("disabled",!0).css("border","transparent"),1==a.Identifygroupsandfriends){var n=e.impPhoId,i=$(".sree-impPhomyNickName").html(),s=$(".sree-select").val(),d=$(".page1-Maindiv7-whiteMeContent").val();(l=new FormData).append("id",n),l.append("groupid",s),l.append("mynickname",i),l.append("chatroomDescription",d),t({method:"POST",url:e.link1+"/contact/modifyChatroomById",data:l,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){e.code})}else{$(".page1-Maindiv7-whiteMeContent").attr("disabled",!0).css({background:"#fff",border:"1px solid #EFEFEF"});n=e.impPhoId,i=$(".imponoteName").html();var l,r=$(".imponotePhoneNumber").val();s=$(".second-select").val(),d=$(".page1-Maindiv7-whiteMeContent").val();(l=new FormData).append("id",n),l.append("notename",i),l.append("phone",r),l.append("groupid",s),l.append("description",d),t({method:"POST",url:e.link+"/contact/modifyContactById",data:l,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){e.code})}}),a.editName1=function(){$(".imponoteName").attr("contenteditable",!0).css("border","solid 1px #75aaff"),$(".imponoteName").focus()},$(".imponoteName").blur(function(){$(".imponoteName").attr("contenteditable",!1).css("border"," 1px solid transparent");var a=e.impPhoId,n=$(".imponoteName").html(),i=$(".imponotePhoneNumber").val(),s=$(".second-select").val(),d=$(".page1-Maindiv7-whiteMeContent").val(),l=new FormData;l.append("id",a),l.append("notename",n),l.append("phone",i),l.append("groupid",s),l.append("description",d),t({method:"POST",url:e.link+"/contact/modifyContactById",data:l,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){e.code})}),a.editPhone1=function(){$(".imponotePhoneNumber").attr("readonly",!1).css("border","solid 1px #75aaff"),$(".imponotePhoneNumber").focus()},$(".imponotePhoneNumber").keyup(function(){this.value=this.value.replace(/[^0-9-]+/,"")}),$(".imponotePhoneNumber").blur(function(){$(this).attr("readonly",!0).css("border","1px solid transparent");var a=e.impPhoId,n=$(".imponoteName").html(),i=$(".imponotePhoneNumber").val(),s=$(".second-select").val(),d=$(".page1-Maindiv7-whiteMeContent").val(),l=new FormData;l.append("id",a),l.append("phone",i),l.append("notename",n),l.append("groupid",s),l.append("description",d),t({method:"POST",url:e.link+"/contact/modifyContactById",data:l,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){})}),$(".second-select").change(function(){var a=e.impPhoId,n=$(".imponoteName").html(),i=$(".imponotePhoneNumber").val(),s=$(".second-select").val(),d=$(".page1-Maindiv7-whiteMeContent").val(),l=new FormData;l.append("id",a),l.append("groupid",s),l.append("notename",n),l.append("phone",i),l.append("description",d),t({method:"POST",url:e.link1+"/contact/modifyContactById",data:l,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){e.code})}),$(".sree-select").change(function(){var a=e.impPhoId,n=$(".sree-impPhomyNickName").html(),i=$(".sree-select").val(),s=$(".page1-Maindiv7-whiteMeContent").val(),d=new FormData;d.append("id",a),d.append("groupid",i),d.append("mynickname",n),d.append("chatroomDescription",s),t({method:"POST",url:e.link1+"/contact/modifyChatroomById",data:d,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){e.code})}),a.editName3=function(){$(".sree-impPhomyNickName").attr("contenteditable",!0).css("border","solid 1px #75aaff"),$(".sree-impPhomyNickName").focus()},$(".sree-impPhomyNickName").blur(function(){$(".sree-impPhomyNickName").attr("contenteditable",!1).css("border"," 1px solid transparent");var a=e.impPhoId,n=$(".sree-impPhomyNickName").html(),i=$(".sree-select").val(),s=$(".page1-Maindiv7-whiteMeContent").val(),d=new FormData;d.append("id",a),d.append("groupid",i),d.append("mynickname",n),d.append("chatroomDescription",s),t({method:"POST",url:e.link1+"/contact/modifyChatroomById",data:d,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){e.code})}),a.tablePhoneFriendList=function(n,i){a.Addressbook=!1,$(".page1-Maindiv7").css("background",'url("../images/phonegroup.png") center no-repeat'),$(".Maillist-myfriends-li-bottom-line").find("li[data="+n+"]").css("background-color","rgba(68, 186, 246, 0.05)").siblings().css("background-color","#FFFFFF"),$(".pho-bo-list-search1").css("display","none");var s=[];s.push(n);var d=new FormData;d.append("ids",JSON.stringify(s)),d.append("accountId",e.myaccountId),t({method:"POST",url:e.link+"/socialaccount/getChatroomAndContact",data:d,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){e.MaillistInitId=n,e.MaillistInitcId=i,e.searchReturnList=[[{name:"群"},[]],[{name:"A"},[]],[{name:"B"},[]],[{name:"C"},[]],[{name:"D"},[]],[{name:"E"},[]],[{name:"F"},[]],[{name:"G"},[]],[{name:"H"},[]],[{name:"I"},[]],[{name:"J"},[]],[{name:"K"},[]],[{name:"L"},[]],[{name:"M"},[]],[{name:"N"},[]],[{name:"O"},[]],[{name:"P"},[]],[{name:"Q"},[]],[{name:"R"},[]],[{name:"S"},[]],[{name:"T"},[]],[{name:"U"},[]],[{name:"V"},[]],[{name:"W"},[]],[{name:"X"},[]],[{name:"Y"},[]],[{name:"Z"},[]],[{name:"#"},[]]];for(var t=0;t<a.data.contactList.length;t++)for(var s=0;s<e.searchReturnList.length;s++)a.data.contactList[t].fristWord==e.searchReturnList[s][0].name&&(""==a.data.contactList[t].profilePhoto||null==a.data.contactList[t].profilePhoto||null==a.data.contactList[t].profilePhoto?a.data.contactList[t].profilePhoto="./images/Destroy.png":a.data.contactList[t].profilePhoto=e.imgSrc+a.data.contactList[t].profilePhoto,e.searchReturnList[s][1].push(a.data.contactList[t]))})},$(".page1-Maindiv6,.page1-Maindiv1,.page1-Maindiv7,.wechatList-title,.Maillist-myfriends").click(function(){$(".pho-bo-list-search1").css("display","none"),$(".page1-Maindiv2-myfriends-search-input1").val("")}),$(".page1-Maindiv1,.page1-Maindiv7,.page1-Maindiv5,.newSelectTitle,.page1-Maindiv6-con").click(function(){$(".tel_history_list").css("display","none")}),a.delOneTag1=function(n){var i;""==n||null==n||null==n||(1==a.Identifygroupsandfriends?((i=new FormData).append("id",e.impPhoId),i.append("socialaccountid",e.impPhosocialaccountId),i.append("tags",n),t({method:"POST",url:e.link+"/contact/delChatroomTags",data:i,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){if(200==a.code){var n=new FormData;n.append("socialaccountId",e.impPhosocialaccountId),n.append("chatroomId",e.impPhoId),t({method:"POST",url:e.link+"/contact/getChatroomById",data:n,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){var t=a.data.tags;e.impPhotags1=t.split(",")})}})):((i=new FormData).append("id",e.impPhoId),i.append("socialaccountid",e.impPhosocialaccountId),i.append("tags",n),t({method:"POST",url:e.link+"/contact/delContactTags",data:i,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){if(200==a.code){var n=new FormData;n.append("socialaccountId",e.impPhosocialaccountId),n.append("contactId",e.impPhoId),t({method:"POST",url:e.link+"/contact/getContactById",data:n,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){var t=a.data.tags;e.impPhotags1=t.split(",")})}})))},a.addTagIsshow1=function(n){if(1==n)if(0==$(".page1-div3-content-title-edit-tag3").attr("data"))$(".page1-div3-content-title-edit-tag3").attr("data",1),$(".page1-div3-content-title-edit-tag3").html("完成"),$(".page1-div3-content-title-edit-tag3").css({display:"inline-block",right:"0px"}),$(".page1-div3-content-title-edit-tag1").css("display","none"),$(".add_tag_input_add1").css("display","block"),$(".tags-box").css("display","none"),$(".page1-div3-content-tags").css("height","134px");else if(""==$(".add_tag_input_add1").val()){$(".page1-div3-content-title-edit-tag3").attr("data",0),$(".page1-div3-content-title-edit-tag3").html("自定义"),$(".page1-div3-content-title-edit-tag3").css({display:"inline-block",right:"30px"}),$(".page1-div3-content-title-edit-tag1").css("display","inline-block"),$(".tags-box").css("display","block"),$(".page1-div3-content-tags").css("height","114px"),$(".add_tag_input_add1").css("display","none");var i=$(".add_tag_input_add1").val()}else{$(".page1-div3-content-title-edit-tag3").attr("data",0),$(".page1-div3-content-title-edit-tag3").html("自定义"),$(".page1-div3-content-title-edit-tag3").css({display:"inline-block",right:"30px"}),$(".page1-div3-content-title-edit-tag1").css("display","inline-block"),$(".tags-box").css("display","block"),$(".page1-div3-content-tags").css("height","114px"),$(".add_tag_input_add1").css("display","none");i=$(".add_tag_input_add1").val();var s=[],d=[];if(s.push(i.split("，")),0==s[0].length);else{for(var l=0;l<s[0].length;l++)""==s[0][l]||d.push(s[0][l]);$(".search-field");if("群"==e.telephoneFirstWrold)(p=new FormData).append("id",e.impPhoId),p.append("socialaccountid",e.impPhosocialaccountId),p.append("tags",d),t({method:"POST",url:e.link+"/contact/addChatroomTags",data:p,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(n){if(200==n.code){$(".add_tag_input_add1").val("");var i=new FormData;i.append("socialaccountId",e.impPhosocialaccountId),i.append("chatroomId",e.impPhoId),t({method:"POST",url:e.link+"/contact/getChatroomById",data:i,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){var t=e.data.tags;a.impPhotags1=t.split(",")})}});else(p=new FormData).append("id",e.impPhoId),p.append("socialaccountid",e.impPhosocialaccountId),p.append("tags",d),t({method:"POST",url:e.link+"/contact/addContactTags",data:p,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){if(200==a.code){$(".add_tag_input_add1").val("");var n=new FormData;n.append("socialaccountId",e.impPhosocialaccountId),n.append("contactId",e.impPhoId),t({method:"POST",url:e.link+"/contact/getContactById",data:n,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){var t=a.data.tags;e.impPhotags1=t.split(",")})}})}}else if(0==$(".page1-div3-content-title-edit-tag1").attr("data"))$(".page1-div3-content-title-edit-tag1").attr("data",1),$(".page1-div3-content-title-edit-tag1").html("完成"),$(".page1-div3-content-title-edit-tag3").css("display","none"),$(".tags-box").css("display","none"),$(".page1-div3-content-tags").css("height","134px"),$(".side-by-side").css("display","inline-block");else{$(".page1-div3-content-title-edit-tag1").html("选择"),$(".page1-div3-content-tags").css("height","114px"),$(".page1-div3-content-title-edit-tag3").css("display","inline-block"),$(".tags-box").css("display","block"),$(".side-by-side").css("display","none"),$(".page1-div3-content-title-edit-tag1").attr("data",0);for(var r=[],o=$(".search-choice"),c=0;c<o.length;c++)r.push(o.eq(c)[0].innerText);if(0==r.length);else{var p;$(".search-field");if("群"==e.telephoneFirstWrold)(p=new FormData).append("id",e.impPhoId),p.append("socialaccountid",e.impPhosocialaccountId),p.append("tags",r),t({method:"POST",url:e.link+"/contact/addChatroomTags",data:p,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){if(200==a.code){var n=new FormData;n.append("socialaccountId",e.impPhosocialaccountId),n.append("chatroomId",e.impPhoId),t({method:"POST",url:e.link+"/contact/getChatroomById",data:n,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){var t=a.data.tags;e.impPhotags1=t.split(",")})}});else(p=new FormData).append("id",e.impPhoId),p.append("socialaccountid",e.impPhosocialaccountId),p.append("tags",r),t({method:"POST",url:e.link+"/contact/addContactTags",data:p,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){if(200==a.code){var n=new FormData;n.append("socialaccountId",e.impPhosocialaccountId),n.append("contactId",e.impPhoId),t({method:"POST",url:e.link+"/contact/getContactById",data:n,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){var t=a.data.tags;e.impPhotags1=t.split(",")})}})}}},a.chatWithChose=function(){$(".page1-Maindiv2-listInit").css("display","none"),e.ChataddressbookswitchingBook=!1,e.ChataddressbookswitchingChat=!0,a.Addressbook=!1,$(".page1-Maindiv7").css("background",'url("../images/phonegroup.png") center no-repeat'),$(".page1-Maindiv1-msg").css("background",' url("./images/msg.png") center no-repeat'),$(".page1-Maindiv1-msg").next().css("background",' url("./images/telephone-book.png") center no-repeat'),o=-1,e.frienfList=[],$(".page1-Maindiv2 .newSelectTitle span").html("请选择"),e.watchThis=$(".page1-Maindiv2 .newSelectTitle span").html(),e.frienfList=e.Chatwithfriends[e.lplplpl];for(var n=0,i=0,d="",l=0,r=0,c=0,p="",h=!1,g=!1,m="",u=0,f=0,v=0;v<e.Chatwithfriends[-1].length;v++)e.Chatwithfriends[-1][v].cid==e.impPhoCid&&(n=v,d=e.Chatwithfriends[-1][v],h=!0),1==e.Chatwithfriends[-1][v].topNumber&&i++;for(v=0;v<e.Chatwithfriends[e.lplplpl].length;v++)e.Chatwithfriends[e.lplplpl][v].cid==e.impPhoCid&&(v,e.Chatwithfriends[e.lplplpl][v],m=e.Chatwithfriends[e.lplplpl][v].socialaccountId,g=!0,u=e.Chatwithfriends[-1][v].topNumber),1==e.Chatwithfriends[e.lplplpl][v].topNumber&&l++;if(""==m){var w=new FormData;w.append("Cid",e.impPhoCid),w.append("accountId",e.myaccountId),t({method:"POST",url:e.link+"/latelychat/getContactByNumber",data:w,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){var t="";a.data.contactList.length>1?(""==a.data.contactList[1].profilePhoto?a.data.contactList[1].profilePhoto="./images/Destroy.png":a.data.contactList[1].profilePhoto=e.imgSrc+a.data.contactList[1].profilePhoto,m=a.data.contactList[1].socialaccountId,t=a.data.contactList[1]):(""==a.data.contactList[0].profilePhoto?a.data.contactList[0].profilePhoto="./images/Destroy.png":a.data.contactList[0].profilePhoto=e.imgSrc+a.data.contactList[0].profilePhoto,m=a.data.contactList[0].socialaccountId,t=a.data.contactList[0]);for(var n=0;n<e.Chatwithfriends[m].length;n++)e.Chatwithfriends[m][n].cid==e.impPhoCid&&(r=n,p=e.Chatwithfriends[m][n]),1==e.Chatwithfriends[m][n].topNumber&&c++;e.Chatwithfriends[m].splice(c,0,t),e.Chatwithfriends[-1].splice(i,0,t)})}else{for(v=0;v<e.Chatwithfriends[m].length;v++)e.Chatwithfriends[m][v].cid==e.impPhoCid&&(r=v,p=e.Chatwithfriends[m][v],f=e.Chatwithfriends[m][v].topNumber),1==e.Chatwithfriends[m][v].topNumber&&c++;1==h&&1==g?1==u?(e.Chatwithfriends[-1].splice(n,1),e.Chatwithfriends[-1].splice(0,0,d),e.Chatwithfriends[m].splice(r,1),e.Chatwithfriends[m].splice(0,0,p)):(e.Chatwithfriends[-1].splice(n,1),e.Chatwithfriends[-1].splice(i,0,d),e.Chatwithfriends[m].splice(r,1),e.Chatwithfriends[m].splice(c,0,p)):1==h&&0==g&&-1!=e.lplplpl?1==u?(e.Chatwithfriends[-1].splice(n,1),e.Chatwithfriends[-1].splice(0,0,d),e.Chatwithfriends[e.lplplpl].splice(0,0,d)):(e.Chatwithfriends[-1].splice(n,1),e.Chatwithfriends[-1].splice(i,0,d),e.Chatwithfriends[e.lplplpl].splice(l,0,d)):1==h&&0==g&&-1==e.lplplpl?1==u?(e.Chatwithfriends[-1].splice(n,1),e.Chatwithfriends[-1].splice(0,0,d),e.Chatwithfriends[m].splice(0,0,d)):(e.Chatwithfriends[-1].splice(n,1),e.Chatwithfriends[-1].splice(i,0,d),e.Chatwithfriends[m].splice(l,0,d)):0==h&&1==g&&-1==e.lplplpl?1==f?(e.Chatwithfriends[-1].splice(0,0,p),e.Chatwithfriends[m].splice(r,1),e.Chatwithfriends[m].splice(0,0,p)):(e.Chatwithfriends[-1].splice(i,0,p),e.Chatwithfriends[m].splice(r,1),e.Chatwithfriends[m].splice(c,0,p)):0==h&&1==g&&-1!=e.lplplpl&&(1==f?(e.Chatwithfriends[-1].splice(0,0,p),e.Chatwithfriends[e.lplplpl].splice(r,1),e.Chatwithfriends[e.lplplpl].splice(0,0,p)):(e.Chatwithfriends[-1].splice(i,0,p),e.Chatwithfriends[e.lplplpl].splice(r,1),e.Chatwithfriends[e.lplplpl].splice(c,0,p)))}a.$watch(function(){e.frienfList=e.Chatwithfriends[e.lplplpl]}),setTimeout(function(){$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.impPhoCid+'"]').parent().addClass("click-background-color").siblings().removeClass("click-background-color"),$(".page1-Maindiv2-myfriends-search-con-ul1").find(".page1-Maindiv2-myfriends-search-con-ul-tagname1").html(""),$(".page1-Maindiv2-myfriends-search-con-ul1").find(".new-msg-number").css("display","none").html("");var n=e.Chatwithfriends[e.lplplpl].length;n>50&&(n=50);for(var i=0;i<n;i++){var d=e.Chatwithfriends[e.lplplpl][i].cid;if(""!=e.Chatwithfriends[e.lplplpl][i].newMessage&&$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.Chatwithfriends[e.lplplpl][i].cid+'"]').html(e.Chatwithfriends[e.lplplpl][i].newMessage),e.friendStorage.hasOwnProperty(d)){var l=e.friendStorage[d].split("Unread").length-1;l>0?$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+d+'"]').next().css("display","inline-block").html(l):$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+d+'"]').next().css("display","none").html("")}else $(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+d+'"]').next().css("display","none").html("")}$(".page1-Maindiv2-listInit").css("display","none"),a.page1Maindiv4Init=!1,a.Customerinformation=!0,a.quickReply=!1,a.customerRecord=!1,a.page1Maindiv4Init=!1,"群"==e.telephoneFirstWrold?(a.chatGroupOrFriend=1,a.myself1=!0,a.allCustomerList=!1,a.myself=!1,a.groupdata=new FormData,a.groupdata.append("socialaccountId",e.impPhosocialaccountId),a.groupdata.append("chatroomId",e.impPhoId),t({method:"POST",url:e.link+"/contact/getChatroomById",data:a.groupdata,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(n){var i=n.data.tags;a.FriendTags=i.split(","),a.Mygroupdata=n.data,a.GroupId=n.data.groupId,$(".whiteMeContent").val(n.data.chatroomDescription),$(".chzn-results li").css("display","block"),t({method:"POST",url:e.link+"/groups/getGroups",data:a.MyFrienddata,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){a.InformationGrouping=e.data.groupList,setTimeout(function(){$(".four-select").find("option[value="+a.GroupId+"]").attr("selected",!0)},10)})})):(a.chatGroupOrFriend=0,a.allCustomerList=!1,a.myself=!0,a.myself1=!1,a.MyFrienddata=new FormData,a.MyFrienddata.append("socialaccountId",e.impPhosocialaccountId),a.MyFrienddata.append("contactId",e.impPhoId),t({method:"POST",url:e.link+"/contact/getContactById",data:a.MyFrienddata,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(n){a.MyFrienddata1=n.data,$(".change-name").html(e.GetridoftheNbsp(n.data.noteName)),e.NameRecord=n.data.noteName,$(".change-phone").val(n.data.phone),$(".whiteMeContent").val(n.data.description);var i=n.data.tags;a.FriendTags=i.split(","),a.GroupId=n.data.groupId,$(".chzn-results li").css("display","block"),t({method:"POST",url:e.link+"/groups/getGroups",data:a.MyFrienddata,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){a.InformationGrouping=e.data.groupList,setTimeout(function(){$(".first-select").find("option[value="+a.GroupId+"]").attr("selected",!0)},10)})})),a.chatName=e.impPhonickName,e.chatId=e.impPhoCid,e.chatHead=e.WeChatownerHeader[e.impPhosocialaccountId],e.Id=e.impPhoId,e.socialaccountId=e.impPhosocialaccountId,"群"==e.telephoneFirstWrold?e.type=1:e.type=0,e.Topjudge=e.impPhoTopNumber,1==e.Topjudge?($(".chat-top-totop").css("background",'url("./images/Canceltop.png") center no-repeat'),$(".chat-top-totop").attr("data",1)):($(".chat-top-totop").css("background",'url("./images/toTop.png") center no-repeat'),$(".chat-top-totop").attr("data",0)),a.page1Maindiv4Init=!1;var r=!1;for(i=0;i<e.Judgingthesendingmessage.length;i++)if(e.socialaccountId==e.Judgingthesendingmessage[i]){r=!0;break}if(1==r?($(".Chat-layer").css("display","block"),$(".Chat-layer-say").css("display","block")):($(".Chat-layer").css("display","none"),$(".Chat-layer-say").css("display","none")),$(".page1-Maindiv3").css("background","none"),$(".newsList").html(""),$(".chat-top-title").html(e.impPhonickName),a.ChatModule=!0,$(".forPhone-content").find('span[class^="blue"]').html(e.WeChatowner[e.socialaccountId]),e.friendStorage.hasOwnProperty(e.chatId)){var o=e.friendStorage[e.chatId],c=o.match(/\[[^\]]+\]/g);if(null==c||0==c||null==c){o=o.replace(/<br>/g,"").replace(/undefined/g,"")}else{for(var p=[],h=[],g=0;g<c.length;g++)for(var m=0;m<s.length;m++)c[g]==s[m]&&(p.push('<img class="emoji_icon" src="images/qq/'+(m+1)+'.gif">'),h.push(s[m]));for(var u=0;u<p.length;u++)o=o.replace(h[u],p[u]);o=o.replace(/<br>/g,"").replace(/undefined/g,"")}$(".newsList").html(o)}else $(".newsList").html("");setTimeout(function(){if(1==e.Topjudge?$(".wechatList").animate({scrollTop:0},100):$(".wechatList").animate({scrollTop:74*$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.chatId+'"]').parent().attr("data-index")+9},100),$(".Newmessagereminding").css("display","none"),null==e.friendStorage[e.chatId]||null==e.friendStorage[e.chatId]?$(".ChatRecord").html("---------------- 更多消息请查看聊天记录 ----------------").css("cursor","default"):e.friendStorage[e.chatId].indexOf("initNone")>=0?$(".ChatRecord").html("-------------------- 查看更多消息 --------------------").css("cursor","pointer"):$(".ChatRecord").html("---------------- 更多消息请查看聊天记录 ----------------").css("cursor","default"),$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.chatId+'"]').next().css("display","none"),""==e.friendStorage[e.chatId]||null==e.friendStorage[e.chatId]);else{var a=e.friendStorage[e.chatId].replace(/Unread/g,"Read");e.friendStorage[e.chatId]=a}var t=$(".RightCont")[0].scrollHeight;$(".RightCont").animate({scrollTop:t},500)},50)},150)},a.AutomaticSwich=function(a){var n;1==$(a.target).attr("data")?((n=new FormData).append("accountname",e.localUserName),n.append("autoReply",!0),t({method:"POST",url:e.link1+"/message/autoReply",data:n,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){200==e.code&&($(a.target).css({background:'url("./images/open-1.png") center no-repeat'}),$(a.target).attr("data",2))})):((n=new FormData).append("accountname",e.localUserName),n.append("autoReply",!1),t({method:"POST",url:e.link1+"/message/autoReply",data:n,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){200==e.code&&($(a.target).css({background:'url("./images/off-1.png") center no-repeat'}),$(a.target).attr("data",1))}))},layui.use(["table"],function(){layui.laypage,layui.layer;var n,i=layui.table.render({elem:"#test",url:e.link+"/autoreply/getAllAutoreply",method:"post",limits:[10,20,30,50],cols:[[{field:"LAY_TABLE_INDEX",data:"id",title:"序号"},{field:"keyword",title:"关键词"},{field:"matchType",title:"匹配类型"},{field:"type",title:"回复内容"},{field:"id",title:"操作",toolbar:"#barDemo"}]],skin:"nob ",even:!0,page:!0,limit:10,height:500,done:function(e,a,t){var i=a;1==e.data.length&&(a=n>=2?n-1:n),n=a;var s=0,d=0;$("[data-field='LAY_TABLE_INDEX']").children().each(function(){1==++s||($(this).text(Number($(this).text())+1+10*(i-1)),$(this).attr("data",e.data[s-2].id))}),$("[data-field='matchType']").children().each(function(){1==$(this).text()?$(this).text("模糊"):0==$(this).text()&&$(this).text("完全")}),$("[data-field='type']").children().each(function(){0==$(this).text()?$(this).text("文本"):1==$(this).text()?$(this).text("图片"):2==$(this).text()&&$(this).text("文本+图片")}),$("[data-field='id']").children().each(function(){if(1==++d);else{var a=0;$(this).children().each(function(){a++,$(this).attr("data",e.data[d-2].id),1==a?$(this).addClass("editThis"):$(this).addClass("delThis")})}})}});a.suredelThisdata=function(){$(".sure-del").css("display","none");var a=new FormData;a.append("id",e.AutoreplyById),t({method:"POST",url:e.link+"/autoreply/deleteAutoreplyById",data:a,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){200==e.code&&i.reload({})})},a.SureAddmodifiedkeywords=function(){if(1==w){var a=$(".Addmodifiedkeywords-body-first-inpuit-imporant").val(),n=$(".Addmodifiedkeywords-body-three-text").val(),s=$("input[name='isY']:checked").val();null!=a&&null!=a||(a=""),null!=n&&null!=n||(n="");var d=new FormData;d.append("content",n),d.append("id",e.AutoreplyById),d.append("keyword",a),d.append("matchtype",s),""==e.pic1?(d.append("whether",1),d.append("file","")):(d.append("whether",0),d.append("file",e.pic1)),t({method:"POST",url:e.link+"/autoreply/modifyAutoreplyById",data:d,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){200==a.code&&i.reload({}),$(".Addmodifiedkeywords-body-first-inpuit-imporant").val(""),$(".Addmodifiedkeywords-body-three-text").val(""),$(".Addmodifiedkeywords-body-three-upImg-text").html("上传图片"),$(".Addmodifiedkeywords").css("display","none"),$(".last-Img").attr("src",""),e.pic1="",e.AutoreplyById=""})}else if(1==y){a=$(".Addmodifiedkeywords-body-first-inpuit-imporant").val(),n=$(".Addmodifiedkeywords-body-three-text").val(),s=$("input[name='isY']:checked").val();null!=a&&null!=a||(a=""),null!=n&&null!=n||(n="");var l=new FormData;l.append("content",n),l.append("keyword",a),l.append("matchtype",s),""==e.pic1?l.append("file",""):l.append("file",e.pic1),t({method:"POST",url:e.link+"/autoreply/adduploadimg",data:l,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){200==a.code&&i.reload({}),$(".Addmodifiedkeywords-body-first-inpuit-imporant").val(""),$(".Addmodifiedkeywords-body-three-text").val(""),$(".Addmodifiedkeywords-body-three-upImg-text").html("上传图片"),$(".Addmodifiedkeywords").css("display","none"),$(".last-Img").attr("src",""),e.pic1="",e.AutoreplyById=""})}}}),e.pic1="",e.AutoreplyById="";var g,m,u,f,v,w=!1,y=!1;function b(){t({method:"POST",url:e.link+"/tag/getTwoTagss",data:"",headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){200==a.code&&(e.SetUpTagGroup=a.data)})}function C(){t({method:"POST",url:e.link+"/groups/getGroups",data:"",headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){200==a.code&&(e.SetUpallthegroups=a.data.groupList)})}function k(){t({method:"POST",url:e.link+"/script/getTwoScripts",data:"",headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){200==e.code&&(a.AllShortcutphrasegroups=e.data,e.data==[]||0==e.data.length?(a.oneShortcutphrasegroups=[],a.page4FastChoseId=[]):(a.oneShortcutphrasegroups=e.data[0].scripts,a.page4FastChoseId=e.data[0].title.id),setTimeout(function(){$(".SettingInterface-body-Four-title ul").eq(0).find("input").css("color","#44baf6")},500))})}$(".Addmodifiedkeywords").css("display","none"),$(document).on("click",".editThis",function(){w=!0,$(".Addmodifiedkeywords").css("display","block"),$(".Addmodifiedkeywords-body-three-upImg-text").html("修改图片"),e.AutoreplyById=$(this).attr("data");var a=new FormData;a.append("id",e.AutoreplyById),t({method:"POST",url:e.link+"/autoreply/getAutoreplyById",data:a,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){200==e.code&&(e.data.autoreplyPath,$(".Addmodifiedkeywords-body-first-inpuit-imporant").val(e.data.keyword),$(".Addmodifiedkeywords-body-three-text").val(e.data.content),$(".last-Img").attr("src",e.data.autoreplyPath),0==e.data.matchType?($(".wanquan").prop("checked","checked"),$(".mohu").prop("checked",!1)):($(".mohu").prop("checked","checked"),$(".wanquan").prop("checked",!1)),0==e.data.type&&$(".Addmodifiedkeywords-body-three-upImg-text").html("上传图片"))})}),$(document).on("click",".delThis",function(){$(".sure-del").css("display","block"),e.AutoreplyById=$(this).attr("data")}),a.closesuredel=function(){$(".sure-del").css("display","none")},$(".Addmodifiedkeywords-body-three-text").html(""),a.AddmodifiedkeywordsShow=function(){y=!0,$(".Addmodifiedkeywords-body-three-upImg-text").html("上传图片"),$(".Addmodifiedkeywords").css("display","block")},a.closeAddmodifiedkeywords=function(){w=!1,y=!1,$(".Addmodifiedkeywords").css("display","none"),$(".Addmodifiedkeywords-body-first-inpuit-imporant").val(""),$(".Addmodifiedkeywords-body-three-text").val(""),$(".Addmodifiedkeywords-body-three-upImg-text").html("上传图片"),$(".last-Img").attr("src",""),e.pic1="",e.AutoreplyById=""},b(),a.editSetUpTags=function(a,n){$(".writeNewTag").css("display","none"),$(".writeNewTag-title-write").val(""),$(n.target).parent().parent().parent().parent().siblings().find('button[class^="SettingInterface-body-second-body-edit"]').attr("data",0).html("编辑").parent().prev().prev().find("input").attr("readonly","readonly").blur().css({border:"1px solid transparent","background-color":"transparent"});$(n.target).parent().prev().prev().find("input").val();if(0==$(n.target).attr("data"))$(n.target).html("保存"),$(n.target).parent().prev().prev().find("input").removeAttr("readonly").focus().css({border:"1px solid #d6d3d3","background-color":"#ffffff"}),$(n.target).attr("data","1");else{var i=$(n.target).parent().prev().prev().find("input").val(),s=new FormData;s.append("description",""),s.append("id",a),s.append("tagname",i),t({method:"POST",url:e.link+"/tag/modifyTagsById",data:s,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){200==e.code&&($(n.target).html("编辑"),$(n.target).parent().prev().prev().find("input").attr("readonly","readonly").blur().css({border:"1px solid transparent","background-color":"transparent"}),$(n.target).attr("data",0),b())})}},a.editSetUpTagsChild=function(a,n){$(".writeNewTag").css("display","none"),$(".writeNewTag-title-write").val(""),$(n.target).parent().parent().parent().parent().siblings().find('button[class^="SettingInterface-body-second-body-edit-child"]').attr("data",0).html("编辑").parent().prev().prev().find("input").removeAttr("readonly","readonly").blur().css({border:"1px solid transparent","background-color":"transparent"}),$(n.target).parent().parent().parent().siblings().find('button[class^="SettingInterface-body-second-body-edit-child"]').attr("data",0).html("编辑").parent().prev().prev().find("input").attr("readonly","readonly").blur().css({border:"1px solid transparent","background-color":"transparent"});$(n.target).parent().prev().prev().find("input").val();if(0==$(n.target).attr("data"))$(n.target).html("保存"),$(n.target).parent().prev().prev().find("input").removeAttr("readonly").focus().css({border:"1px solid #d6d3d3","background-color":"#ffffff"}),$(n.target).attr("data","1");else{var i=$(n.target).parent().prev().prev().find("input").val(),s=new FormData;s.append("description",""),s.append("id",a),s.append("tagname",i),t({method:"POST",url:e.link+"/tag/modifyTagById",data:s,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){200==e.code&&($(n.target).html("编辑"),$(n.target).parent().prev().prev().find("input").attr("readonly","readonly").blur().css({border:"1px solid transparent","background-color":"transparent"}),$(n.target).attr("data",0),b())})}},a.editSetUpAddTags=function(e){g=e,$(".writeNewTag").css("display","block"),$(".writeNewTag-title-write").val("")},a.closewriteNewTag=function(){$(".writeNewTag-title-write-error").css("display","none"),$(".writeNewTag").css("display","none"),$(".writeNewTag-title-write").val("")},a.openAddGroup=function(){$(".writeNewTag1-title-write").val(""),$(".writeNewTag1").css("display","block")},a.closewriteNewTagGroup=function(){$(".writeNewTag-title-write-error1").css("display","none"),$(".writeNewTag1").css("display","none"),$(".writeNewTag1-title-write").val("")},a.sureNewTag=function(){$(".writeNewTag1").css("display","none"),$(".writeNewTag1-title-write").val("");var a=$(".writeNewTag-title-write").val(),n=new FormData;n.append("id",g),n.append("tagname",a),t({method:"POST",url:e.link+"/tag/addTag",data:n,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){200==e.code?($(".writeNewTag").css("display","none"),$(".writeNewTag-title-write").val(""),b(),$(".writeNewTag-title-write-error").css("display","none")):$(".writeNewTag-title-write-error").css("display","block")})},a.surewriteNewTagGroup=function(){$(".writeNewTag").css("display","none"),$(".writeNewTag-title-write").val("");var a=$(".writeNewTag1-title-write").val(),n=new FormData;n.append("id",g),n.append("tagname",a),t({method:"POST",url:e.link+"/tag/addTags",data:n,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){200==e.code?($(".writeNewTag1").css("display","none"),$(".writeNewTag1-title-write").val(""),$(".writeNewTag-title-write-error1").css("display","none"),b()):$(".writeNewTag-title-write-error1").css("display","block")})},a.deltSetUpTags=function(a){$(".writeNewTag").css("display","none"),$(".writeNewTag-title-write").val("");var n=new FormData;n.append("id",a),t({method:"POST",url:e.link+"/tag/deleteTag",data:n,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){200==e.code&&b()})},C(),a.editAllGroupName=function(a,n){if($(n.target).parent().parent().siblings().find('button[class^="SettingInterface-body-three-body-con-btn-edit"]').attr("disabled","disabled").css({color:"grey"}),$(n.target).parent().parent().siblings().find('button[class^="SettingInterface-body-three-body-con-btn-del"]').attr("disabled","disabled").css({color:"grey"}),$(n.target).next().attr("disabled","disabled").css({color:"grey"}),0==$(n.target).attr("data"))m=$(n.target).parent().prev().prev().find("input").val(),$(n.target).html("保存"),$(n.target).attr("data",1),$(n.target).parent().prev().prev().find("input").removeAttr("readonly").focus().css({border:"1px solid #d6d3d3","background-color":"#ffffff"});else{var i=$(n.target).parent().prev().prev().find("input").val();if(i===m)$(n.target).html("编辑"),$(n.target).attr("data",0),$(n.target).parent().prev().prev().find("input").attr("readonly","readonly").blur().css({border:"1px solid transparent","background-color":"transparent"}),$(n.target).parent().prev().prev().prev().find('span[class^="three-body-tishi"]').css("display","none"),$(n.target).parent().parent().siblings().find('button[class^="SettingInterface-body-three-body-con-btn-edit"]').removeAttr("disabled").css({color:"#44baf6"}),$(n.target).parent().parent().siblings().find('button[class^="SettingInterface-body-three-body-con-btn-del"]').removeAttr("disabled").css({color:"#44baf6"}),$(n.target).next().removeAttr("disabled").css({color:"#44baf6"});else{var s=new FormData;s.append("description",""),s.append("id",a),s.append("name",i),t({method:"POST",url:e.link+"/groups/modifyGroupById",data:s,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){200==e.code?($(n.target).parent().parent().siblings().find('button[class^="SettingInterface-body-three-body-con-btn-edit"]').removeAttr("disabled").css({color:"#44baf6"}),$(n.target).parent().parent().siblings().find('button[class^="SettingInterface-body-three-body-con-btn-del"]').removeAttr("disabled").css({color:"#44baf6"}),$(n.target).next().removeAttr("disabled").css({color:"#44baf6"}),$(n.target).html("编辑"),$(n.target).attr("data",0),$(n.target).parent().prev().prev().find("input").attr("readonly","readonly").blur().css({border:"1px solid transparent","background-color":"transparent"}),$(n.target).parent().prev().prev().prev().find('span[class^="three-body-tishi"]').css("display","none"),C()):($(n.target).parent().prev().prev().prev().find('span[class^="three-body-tishi"]').css("display","inline-block"),$(n.target).parent().prev().prev().find("input").val(m))})}}},a.openAddGroup1=function(){$(".writeNewTag2-title-write").val(""),$(".writeNewTag2").css("display","block"),$(".writeNewTag2-title-write-error1").css("display","none").html("新分组已存在！")},a.closewriteNewAddGroup=function(){$(".writeNewTag2-title-write").val(""),$(".writeNewTag2").css("display","none"),$(".writeNewTag2-title-write-error1").css("display","none").html("新分组已存在！")},a.surewriteNewAddGroup=function(){var a=$(".writeNewTag2-title-write").val();if(""==a)$(".writeNewTag2-title-write-error1").css("display","block").html("分组名不能为空!");else{$(".writeNewTag2-title-write-error1").css("display","none").html("新分组已存在！");var n=new FormData;n.append("description",""),n.append("name",a),t({method:"POST",url:e.link+"/groups/addGroup",data:n,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){200==e.code?($(".writeNewTag2-title-write-error1").css("display","none").html("新分组已存在！"),$(".writeNewTag2-title-write").val(""),$(".writeNewTag2").css("display","none"),C()):$(".writeNewTag2-title-write-error1").css("display","block").html("新分组已存在！")})}},a.DelAllGroupName=function(e){u=e,$(".sure-del-1").css("display","block")},a.closePage3suredel=function(){$(".sure-del-1").css("display","none")},a.surePage3delThisdata=function(){var a=new FormData;a.append("id",u),t({method:"POST",url:e.link+"/groups/deleteGroupById",data:a,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){200==e.code&&($(".sure-del-1").css("display","none"),C())})},k(),a.splitSayName=function(e){return e.length>6?e.slice(0,6)+"...":e},a.splitSayName1=function(e){return e.length>9?e.slice(0,9)+"...":e},a.SwitchingShortcutphrase=function(n,i){a.page4FastChoseId=n;var s=new FormData;s.append("id",n),t({method:"POST",url:e.link+"/script/getScriptByParentId",data:s,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){200==e.code&&(a.oneShortcutphrasegroups=e.data.scriptList,$(i.target).css("color","#44baf6").parent().parent().siblings().find("input").css("color","#404040"))})},a.editbodyFourTitle=function(a,n){if($(".writeNewTag3").css("display","none"),$(n.target).parent().parent().siblings().find('button[class^="edit-body-Four-Title"]').attr("disabled","disabled").css({color:"grey"}),$(n.target).parent().parent().siblings().find('button[class^="del-tbody-Four-Title"]').attr("disabled","disabled").css({color:"grey"}),$(n.target).next().attr("disabled","disabled").css({color:"grey"}),$(n.target).next().next().css("display","none"),0==$(n.target).attr("data"))f=$(n.target).prev().val(),$(n.target).html("保存").prev().removeAttr("readonly").focus().css({border:"1px solid #d6d3d3","background-color":"#ffffff"}),$(n.target).attr("data",1);else{var i=$(n.target).prev().val();if(f===i)$(n.target).html("编辑").prev().attr("readonly","readonly").blur().css({border:"1px solid transparent","background-color":"transparent"}),$(n.target).attr("data",0),$(n.target).parent().parent().siblings().find('button[class^="edit-body-Four-Title"]').removeAttr("disabled").css({color:"#44baf6"}),$(n.target).parent().parent().siblings().find('button[class^="del-tbody-Four-Title"]').removeAttr("disabled").css({color:"#44baf6"}),$(n.target).next().removeAttr("disabled").css({color:"#44baf6"}),$(n.target).next().next().css("display","none");else{var s=new FormData;s.append("id",a),s.append("title",i),t({method:"POST",url:e.link+"/script/modifyScriptsById",data:s,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){200==e.code?($(n.target).attr("data",0),$(n.target).html("编辑").prev().attr("readonly","readonly").blur().css({border:"1px solid transparent","background-color":"transparent"}),$(n.target).parent().parent().siblings().find('button[class^="edit-body-Four-Title"]').removeAttr("disabled").css({color:"#44baf6"}),$(n.target).parent().parent().siblings().find('button[class^="del-tbody-Four-Title"]').removeAttr("disabled").css({color:"#44baf6"}),$(n.target).next().removeAttr("disabled").css({color:"#44baf6"}),$(n.target).next().next().css("display","none"),k()):($(n.target).next().next().css("display","block"),$(n.target).prev().val(f))})}}},a.deltbodyFourTitle=function(a){$(".writeNewTag3").css("display","none");var n=new FormData;n.append("id",a),t({method:"POST",url:e.link+"/script/deleteScriptsById",data:n,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){200==e.code&&(k(),$(".SettingInterface-body-Four-title ul").eq(0).find("input").css("color","#44baf6").parent().parent().siblings().find("input").css("color","#404040"))})},a.DelAllGroupName1=function(n){$(".writeNewTag3").css("display","none");var i=new FormData;i.append("id",n),t({method:"POST",url:e.link+"/script/deleteScriptsById",data:i,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(n){if(200==n.code){var i=new FormData;i.append("id",a.page4FastChoseId),t({method:"POST",url:e.link+"/script/getScriptByParentId",data:i,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){200==e.code&&(a.oneShortcutphrasegroups=e.data.scriptList)})}})},a.editAllGroupName1=function(n,i,s,d){if($(".writeNewTag3").css("display","none"),$(d.target).parent().parent().siblings().find('button[class^="editAllGroupName1-1"]').attr("disabled","disabled").css({color:"grey"}),$(d.target).parent().parent().siblings().find('button[class^="SettingInterface-body-three-body-con-btn-del"]').attr("disabled","disabled").css({color:"grey"}),$(d.target).next().attr("disabled","disabled").css({color:"grey"}),$(d.target).parent().prev().prev().prev().find('span[class^="SettingInterface-body-Four-table-body-error"]').css("display","none"),0==$(d.target).attr("data"))v=$(d.target).parent().prev().prev().find("input").val(),$(d.target).html("保存").parent().prev().prev().find("input").removeAttr("readonly").focus().css({border:"1px solid #d6d3d3","background-color":"#ffffff"}),$(d.target).attr("data",1);else{var l=$(d.target).parent().prev().prev().find("input").val();if(v===l)$(d.target).html("编辑").parent().prev().prev().find("input").attr("readonly","readonly").blur().css({border:"1px solid transparent","background-color":"transparent"}),$(d.target).attr("data",0),$(d.target).parent().parent().siblings().find('button[class^="editAllGroupName1-1"]').removeAttr("disabled").css({color:"#44baf6"}),$(d.target).parent().parent().siblings().find('button[class^="SettingInterface-body-three-body-con-btn-del"]').removeAttr("disabled").css({color:"#44baf6"}),$(d.target).next().removeAttr("disabled").css({color:"#44baf6"}),$(d.target).parent().prev().prev().prev().find('span[class^="SettingInterface-body-Four-table-body-error"]').css("display","none");else{var r=new FormData;r.append("id",n),r.append("content",l),r.append("parentid",i),t({method:"POST",url:e.link+"/script/modifyScriptById",data:r,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(n){if(200==n.code){$(d.target).attr("data",0),$(d.target).html("编辑").parent().prev().prev().find("input").attr("readonly","readonly").blur().css({border:"1px solid transparent","background-color":"transparent"}),$(d.target).parent().parent().siblings().find('button[class^="editAllGroupName1-1"]').removeAttr("disabled").css({color:"#44baf6"}),$(d.target).parent().parent().siblings().find('button[class^="SettingInterface-body-three-body-con-btn-del"]').removeAttr("disabled").css({color:"#44baf6"}),$(d.target).next().removeAttr("disabled").css({color:"#44baf6"}),$(d.target).parent().prev().prev().prev().find('span[class^="SettingInterface-body-Four-table-body-error"]').css("display","none");var i=new FormData;i.append("id",a.page4FastChoseId),t({method:"POST",url:e.link+"/script/getScriptByParentId",data:i,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){200==e.code&&(a.oneShortcutphrasegroups=e.data.scriptList)})}else $(d.target).parent().prev().prev().prev().find('span[class^="SettingInterface-body-Four-table-body-error"]').css("display","block"),$(d.target).parent().prev().prev().find("input").val(v)})}}},a.deltbodyFourTitle=function(a,n){var i=new FormData;i.append("id",a),i.append("title",n),t({method:"POST",url:e.link+"/script/deleteScriptsById",data:i,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){200==e.code&&k()})},a.openAddGroup2=function(){$(".writeNewTag3").css("display","block"),$(".writeNewTag3-title-write").val(""),$(".writeNewTag3-title-write-error1").css("display","none").html("新短语已存在！")},a.closewriteNewAddGroup1=function(){$(".writeNewTag3").css("display","none"),$(".writeNewTag3-title-write").val(""),$(".writeNewTag3-title-write-error1").css("display","none").html("新短语已存在！")},a.surewriteNewAddGroup1=function(){var n=$(".writeNewTag3-title-write").val();if(""==n)$(".writeNewTag3-title-write-error1").css("display","block").html("短语不能为空");else if(null==a.page4FastChoseId||null==a.page4FastChoseId||""==a.page4FastChoseId)$(".writeNewTag3-title-write-error1").css("display","block").html("请创建短语分组");else{var i=new FormData;i.append("id",a.page4FastChoseId),i.append("content",n),t({method:"POST",url:e.link+"/script/addScript",data:i,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(n){if(200==n.code){$(".writeNewTag3").css("display","none");var i=new FormData;i.append("id",a.page4FastChoseId),t({method:"POST",url:e.link+"/script/getScriptByParentId",data:i,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){200==e.code&&(a.oneShortcutphrasegroups=e.data.scriptList)})}else $(".writeNewTag3-title-write-error1").css("display","block").html("新短语已存在！")})}},a.openAddGroup3=function(){$(".writeNewTag4").css("display","block"),$(".writeNewTag4-title-write").val(""),$(".writeNewTag4-title-write-error1").css("display","none").html("新分组已存在！")},a.closewriteNewAddGroup2=function(){$(".writeNewTag4").css("display","none"),$(".writeNewTag4-title-write").val(""),$(".writeNewTag4-title-write-error1").css("display","none").html("新分组已存在！")},a.surewriteNewAddGroup2=function(){var a=$(".writeNewTag4-title-write").val();if(""==a)$(".writeNewTag4-title-write-error1").css("display","block").html("分组不能为空");else{var n=new FormData;n.append("title",a),t({method:"POST",url:e.link+"/script/addScripts",data:n,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){200==e.code?($(".writeNewTag4").css("display","none"),$(".writeNewTag4-title-write").val(""),$(".writeNewTag4-title-write-error1").css("display","none").html("新分组已存在！"),k()):$(".writeNewTag4-title-write-error1").css("display","block").html("新分组已存在！")})}},a.Downloadtemplate=function(){t.get(e.link+"/script/downfile").success(function(e){e.code})},a.openAddGroup4=function(){a.upFile1="",$(".Importphrase-con-second-donwload-input").val(""),$(".Importphrase").css("display","block"),$(".exselTextGra1").html("文件名"),$(".exselTextGray1").html("0kb"),$(".Importphrase-con-second-donwload-null").css("display","none").html(" 请上传文件")},a.closeAddGroup4=function(){$(".Importphrase-con-second-donwload-input").val(""),a.upFile1="",$(".Importphrase-con-second-donwload-null").css("display","none").html(" 请上传文件"),$(".Importphrase").css("display","none"),$(".exselTextGra1").html("文件名"),$(".exselTextGray1").html("0kb")},a.Startimporting=function(){if(""==a.upFile1)$(".Importphrase-con-second-donwload-null").css("display","block").html(" 请上传文件！");else{var n=new FormData;n.append("file",a.upFile1),t({method:"POST",url:e.link+"/script/uploading",data:n,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){200==e.code?($(".Importphrase").css("display","none"),$(".Importphrase-con-second-donwload-input").val(""),$(".Importphrase-con-second-donwload-null").css("display","none").html(" 请上传文件！"),k()):$(".Importphrase-con-second-donwload-null").css("display","block").html("上传文件出错！")})}},e.SetupClick=function(a){$(".Mongolialayer").css("display","block"),1==a?(1==$(".SettingInterface-body-first-off").attr("data")?$(".SettingInterface-body-first-off").css({background:'url("./images/off-1.png") center no-repeat'}):$(".SettingInterface-body-first-off").css({background:'url("./images/open-1.png") center no-repeat'}),$(".page1-Maindiv1-group").attr("data",0),e.Setup=!1,$(".SettingInterface").css("display","block"),$(".SettingInterface-body-first-table").css("display","block"),$(".SettingInterface-body-second-table").css("display","none"),$(".SettingInterface-body-three-table").css("display","none"),$(".SettingInterface-body-Four-table").css("display","none"),$(".SettingInterface-body-Five-table").css("display","none"),$(".SettingInterface-body-swith ul li").eq(0).css("color","#44baf6").find("span").css("background",' url("../images/setUpTable1-click.png") center no-repeat'),$(".SettingInterface-body-swith ul li").eq(1).css("color","#202020").find("span").css("background",' url("../images/setUpTable2.png") center no-repeat'),$(".SettingInterface-body-swith ul li").eq(2).css("color","#202020").find("span").css("background",' url("../images/setUpTable3.png") center no-repeat'),$(".SettingInterface-body-swith ul li").eq(3).css("color","#202020").find("span").css("background",' url("../images/setUpTable4.png") center no-repeat'),$(".SettingInterface-body-swith ul li").eq(4).css("color","#202020").find("span").css("background",' url("../images/setUpTable5.png") center no-repeat')):2==a?($(".page1-Maindiv1-group").attr("data",0),$(".SettingInterface-body-first-table").css("display","none"),$(".SettingInterface-body-second-table").css("display","block"),$(".SettingInterface-body-three-table").css("display","none"),$(".SettingInterface-body-Four-table").css("display","none"),$(".SettingInterface-body-Five-table").css("display","none"),e.Setup=!1,$(".SettingInterface").css("display","block"),$(".SettingInterface-body-swith ul li").eq(1).css("color","#44baf6").find("span").css("background",' url("../images/setUpTable2-click.png") center no-repeat'),$(".SettingInterface-body-swith ul li").eq(0).css("color","#202020").find("span").css("background",' url("../images/setUpTable1.png") center no-repeat'),$(".SettingInterface-body-swith ul li").eq(2).css("color","#202020").find("span").css("background",' url("../images/setUpTable3.png") center no-repeat'),$(".SettingInterface-body-swith ul li").eq(4).css("color","#202020").find("span").css("background",' url("../images/setUpTable5.png") center no-repeat'),$(".SettingInterface-body-swith ul li").eq(3).css("color","#202020").find("span").css("background",' url("../images/setUpTable4.png") center no-repeat')):3==a?($(".page1-Maindiv1-group").attr("data",0),$(".SettingInterface-body-first-table").css("display","none"),$(".SettingInterface-body-second-table").css("display","none"),$(".SettingInterface-body-three-table").css("display","block"),$(".SettingInterface-body-Four-table").css("display","none"),$(".SettingInterface-body-Five-table").css("display","none"),e.Setup=!1,$(".SettingInterface").css("display","block"),$(".SettingInterface-body-swith ul li").eq(2).css("color","#44baf6").find("span").css("background",' url("../images/setUpTable3-click.png") center no-repeat'),$(".SettingInterface-body-swith ul li").eq(1).css("color","#202020").find("span").css("background",' url("../images/setUpTable2.png") center no-repeat'),$(".SettingInterface-body-swith ul li").eq(0).css("color","#202020").find("span").css("background",' url("../images/setUpTable1.png") center no-repeat'),$(".SettingInterface-body-swith ul li").eq(3).css("color","#202020").find("span").css("background",' url("../images/setUpTable4.png") center no-repeat'),$(".SettingInterface-body-swith ul li").eq(4).css("color","#202020").find("span").css("background",' url("../images/setUpTable5.png") center no-repeat')):4==a?($(".page1-Maindiv1-group").attr("data",0),e.Setup=!1,$(".SettingInterface-body-first-table").css("display","none"),$(".SettingInterface-body-second-table").css("display","none"),$(".SettingInterface-body-three-table").css("display","none"),$(".SettingInterface-body-Five-table").css("display","none"),$(".SettingInterface-body-Four-table").css("display","block"),$(".SettingInterface").css("display","block"),$(".SettingInterface-body-swith ul li").eq(3).css("color","#44baf6").find("span").css("background",' url("../images/setUpTable4-click.png") center no-repeat'),$(".SettingInterface-body-swith ul li").eq(2).css("color","#202020").find("span").css("background",' url("../images/setUpTable3.png") center no-repeat'),$(".SettingInterface-body-swith ul li").eq(1).css("color","#202020").find("span").css("background",' url("../images/setUpTable2.png") center no-repeat'),$(".SettingInterface-body-swith ul li").eq(0).css("color","#202020").find("span").css("background",' url("../images/setUpTable1.png") center no-repeat'),$(".SettingInterface-body-swith ul li").eq(4).css("color","#202020").find("span").css("background",' url("../images/setUpTable5.png") center no-repeat')):($(".page1-Maindiv1-group").attr("data",0),$(".SettingInterface-body-first-table").css("display","none"),$(".SettingInterface-body-second-table").css("display","none"),$(".SettingInterface-body-three-table").css("display","none"),$(".SettingInterface-body-Four-table").css("display","none"),$(".SettingInterface-body-Five-table").css("display","block"),e.Setup=!1,$(".SettingInterface").css("display","block"),$(".SettingInterface-body-swith ul li").eq(4).css("color","#44baf6").find("span").css("background",' url("../images/setUpTable5-click.png") center no-repeat'),$(".SettingInterface-body-swith ul li").eq(0).css("color","#202020").find("span").css("background",' url("../images/setUpTable1.png") center no-repeat'),$(".SettingInterface-body-swith ul li").eq(2).css("color","#202020").find("span").css("background",' url("../images/setUpTable3.png") center no-repeat'),$(".SettingInterface-body-swith ul li").eq(3).css("color","#202020").find("span").css("background",' url("../images/setUpTable4.png") center no-repeat'),$(".SettingInterface-body-swith ul li").eq(1).css("color","#202020").find("span").css("background",' url("../images/setUpTable2.png") center no-repeat'))},a.closeSettingInterface=function(){$(".SettingInterface").css("display","none"),$(".Mongolialayer").css("display","none")},e.ettingInterfaceswith=function(e){1==e?(1==$(".SettingInterface-body-first-off").attr("data")?$(".SettingInterface-body-first-off").css({background:'url("./images/off-1.png") center no-repeat'}):$(".SettingInterface-body-first-off").css({background:'url("./images/open-1.png") center no-repeat'}),$(".SettingInterface-body-first-table").css("display","block"),$(".SettingInterface-body-second-table").css("display","none"),$(".SettingInterface-body-three-table").css("display","none"),$(".SettingInterface-body-Four-table").css("display","none"),$(".SettingInterface-body-Five-table").css("display","none"),$(".SettingInterface-body-swith ul li").eq(0).css("color","#44baf6").find("span").css("background",' url("../images/setUpTable1-click.png") center no-repeat'),$(".SettingInterface-body-swith ul li").eq(1).css("color","#202020").find("span").css("background",' url("../images/setUpTable2.png") center no-repeat'),$(".SettingInterface-body-swith ul li").eq(2).css("color","#202020").find("span").css("background",' url("../images/setUpTable3.png") center no-repeat'),$(".SettingInterface-body-swith ul li").eq(4).css("color","#202020").find("span").css("background",' url("../images/setUpTable5.png") center no-repeat'),$(".SettingInterface-body-swith ul li").eq(3).css("color","#202020").find("span").css("background",' url("../images/setUpTable4.png") center no-repeat')):2==e?($(".SettingInterface-body-first-table").css("display","none"),$(".SettingInterface-body-second-table").css("display","block"),$(".SettingInterface-body-three-table").css("display","none"),$(".SettingInterface-body-Four-table").css("display","none"),$(".SettingInterface-body-Five-table").css("display","none"),$(".SettingInterface").css("display","block"),$(".SettingInterface-body-swith ul li").eq(1).css("color","#44baf6").find("span").css("background",' url("../images/setUpTable2-click.png") center no-repeat'),$(".SettingInterface-body-swith ul li").eq(0).css("color","#202020").find("span").css("background",' url("../images/setUpTable1.png") center no-repeat'),$(".SettingInterface-body-swith ul li").eq(2).css("color","#202020").find("span").css("background",' url("../images/setUpTable3.png") center no-repeat'),$(".SettingInterface-body-swith ul li").eq(3).css("color","#202020").find("span").css("background",' url("../images/setUpTable4.png") center no-repeat'),$(".SettingInterface-body-swith ul li").eq(4).css("color","#202020").find("span").css("background",' url("../images/setUpTable5.png") center no-repeat'),b()):3==e?($(".page1-Maindiv1-group").attr("data",0),$(".SettingInterface-body-first-table").css("display","none"),$(".SettingInterface-body-second-table").css("display","none"),$(".SettingInterface-body-three-table").css("display","block"),$(".SettingInterface-body-Five-table").css("display","none"),$(".SettingInterface-body-Four-table").css("display","none"),$(".SettingInterface-body-swith ul li").eq(2).css("color","#44baf6").find("span").css("background",' url("../images/setUpTable3-click.png") center no-repeat'),$(".SettingInterface-body-swith ul li").eq(1).css("color","#202020").find("span").css("background",' url("../images/setUpTable2.png") center no-repeat'),$(".SettingInterface-body-swith ul li").eq(0).css("color","#202020").find("span").css("background",' url("../images/setUpTable1.png") center no-repeat'),$(".SettingInterface-body-swith ul li").eq(3).css("color","#202020").find("span").css("background",' url("../images/setUpTable4.png") center no-repeat'),$(".SettingInterface-body-swith ul li").eq(4).css("color","#202020").find("span").css("background",' url("../images/setUpTable5.png") center no-repeat'),C()):4==e?($(".SettingInterface-body-first-table").css("display","none"),$(".SettingInterface-body-second-table").css("display","none"),$(".SettingInterface-body-three-table").css("display","none"),$(".SettingInterface-body-Five-table").css("display","none"),$(".SettingInterface-body-Four-table").css("display","block"),$(".SettingInterface-body-swith ul li").eq(3).css("color","#44baf6").find("span").css("background",' url("../images/setUpTable4-click.png") center no-repeat'),$(".SettingInterface-body-swith ul li").eq(2).css("color","#202020").find("span").css("background",' url("../images/setUpTable3.png") center no-repeat'),$(".SettingInterface-body-swith ul li").eq(1).css("color","#202020").find("span").css("background",' url("../images/setUpTable2.png") center no-repeat'),$(".SettingInterface-body-swith ul li").eq(0).css("color","#202020").find("span").css("background",' url("../images/setUpTable1.png") center no-repeat'),$(".SettingInterface-body-swith ul li").eq(4).css("color","#202020").find("span").css("background",' url("../images/setUpTable5.png") center no-repeat'),k()):($(".SettingInterface-body-first-table").css("display","none"),$(".SettingInterface-body-second-table").css("display","none"),$(".SettingInterface-body-three-table").css("display","none"),$(".SettingInterface-body-Four-table").css("display","none"),$(".SettingInterface-body-Five-table").css("display","block"),$(".SettingInterface-body-swith ul li").eq(4).css("color","#44baf6").find("span").css("background",' url("../images/setUpTable5-click.png") center no-repeat'),$(".SettingInterface-body-swith ul li").eq(2).css("color","#202020").find("span").css("background",' url("../images/setUpTable3.png") center no-repeat'),$(".SettingInterface-body-swith ul li").eq(1).css("color","#202020").find("span").css("background",' url("../images/setUpTable2.png") center no-repeat'),$(".SettingInterface-body-swith ul li").eq(0).css("color","#202020").find("span").css("background",' url("../images/setUpTable1.png") center no-repeat'),$(".SettingInterface-body-swith ul li").eq(3).css("color","#202020").find("span").css("background",' url("../images/setUpTable4.png") center no-repeat'))},$(".chat-bottom-con-smile").mouseover(function(){$(".chat-bottom-con-smile-Explain").css("display","inline-block")}),$(".chat-bottom-con-smile").mouseout(function(){$(".chat-bottom-con-smile-Explain").css("display","none")}),$(".image-upfile").mouseover(function(){$(".chat-bottom-con-upimg-Explain").css("display","inline-block")}),$(".image-upfile").mouseout(function(){$(".chat-bottom-con-upimg-Explain").css("display","none")}),$(".chat-top-totop").mouseover(function(){1==$(this).attr("data")?$(".chat-top-totop-Explain").html("取消置顶"):$(".chat-top-totop-Explain").html("置顶"),$(".chat-top-totop-Explain").css("display","inline-block")}),$(".chat-top-totop").mouseout(function(){$(".chat-top-totop-Explain").css("display","none")}),e.close_img_wrp=function(){$(".J_Preview").css("display","none"),$("#img_preview").attr("src","")},$(document).on("click",".bigPicture",function(){var a=$(this).attr("data"),n=$(this).attr("data1");$(".J_Preview").css("display","block"),$(".load-waite-img-big").css("display","block"),$("#img_preview").attr("src",$(this).find('img[class^="up-Img-Add"]').attr("src"));var i=new FormData;i.append("msgId",a),i.append("accountName",e.localUserName),i.append("socialnumber",n),t({method:"POST",url:e.link+"/message/getImgHDByMsgId",data:i,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){200==e.code&&($(".load-waite-img-big").css("display","none"),$("#img_preview").attr("src",e.data.imagePath))})}),a.Picture_preview=function(e){$(".J_Preview").css("display","block"),$(".load-waite-img-big").css("display","none"),$("#img_preview").attr("src",e)},$(document).on("click",".bigPicture1",function(){var e=$(this).attr("data-imgSrc");$(this).attr("data1");$(".J_Preview").css("display","block"),$(".load-waite-img-big").css("display","none"),$("#img_preview").attr("src",e)}),a.asdpnn=function(){var n=new FormData;n.append("id",e.socialaccountId),t({method:"POST",url:e.link+"/socialaccount/getSocialaccountdetail",data:n,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(t){200==t.code&&(e.getSocialaccountdetailimg1=t.data.profilePhoto,t.data.profilePhoto=e.imgSrc+t.data.profilePhoto,a.getSocialaccountdetail=t.data,a.getSocialaccountdetaildeviceId=t.data.deviceId,a.getSocialaccountdetailSex="",a.getSocialaccountdetailSex=t.data.sex,1==a.getSocialaccountdetailSex?$(".personaldata-data-con-myself-3-span").html("男"):2==a.getSocialaccountdetailSex?$(".personaldata-data-con-myself-3-span").html("女"):$(".personaldata-data-con-myself-3-span").html("未知"),$(".personaldata").css("display","block").focus(),$(".personaldata-data-con-myself-1-input").val(t.data.nickName))})},a.editPersonaldata=function(n){if(0==$(n.target).attr("data"))$(".personaldata-data-con-myself-1-input").attr("disabled",!1).css("border","1px solid  #B5B5B5"),$(".personaldata-data-con-myself-3-span").css("display","none"),$(".personaldata-data-con-myself-3-select").css("display","inline-block"),$(".personaldata-data-con-myself-5-textarea-whiteMeContent").attr("disabled",!1).css("border","1px solid  #B5B5B5"),$(".edit-personaldata").html("完成"),$(n.target).attr("data",1);else{var i=$(".personaldata-data-con-myself-1-input").val(),s=$(".personaldata-data-con-myself-5-textarea-whiteMeContent").val(),d=$(".personaldata-data-con-myself-3-select").val(),l=$(".personaldata-data-con-myself-3-select").find("option:selected").text(),r=new FormData;r.append("id",e.socialaccountId),r.append("profilephoto",a.getSocialaccountdetailimg1),r.append("nickname",i),r.append("sex",d),r.append("deviceId",a.getSocialaccountdetaildeviceId),r.append("province",a.getSocialaccountdetail.province),r.append("city",a.getSocialaccountdetail.city),r.append("whatup",s),r.append("username",e.localUserName),t({method:"POST",url:e.link+"/socialaccount/modifySocialaccountById",data:r,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){200==a.code&&(e.WeChatowner[e.socialaccountId]=i,$(n.target).attr("data",0),$(".personaldata-data-con-myself-1-input").attr("disabled","disabled").css("border","1px solid transparent"),$(".personaldata-data-con-myself-3-select").css("display","none"),$(".personaldata-data-con-myself-3-span").html(l).css("display","inline-block"),$(".personaldata-data-con-myself-5-textarea-whiteMeContent").attr("disabled","disabled").css("border","1px solid  transparent"),$(".klk").html(i),$(".newOptions").find("li[data-value^="+e.socialaccountId+"]").html(i),$(".edit-personaldata").html("修改资料").attr("data",0),$(".personaldata").css("display","none"))})}},a.personaldataclose=function(){$(".personaldata-data-con-myself-1-input").attr("disabled","disabled").css("border","1px solid transparent"),$(".personaldata-data-con-myself-3-select").css("display","none"),$(".personaldata-data-con-myself-3-span").css("display","inline-block"),$(".personaldata-data-con-myself-5-textarea-whiteMeContent").attr("disabled","disabled").css("border","1px solid  transparent"),$(".edit-personaldata").html("修改资料").attr("data",0),$(".personaldata").css("display","none")},a.addOrSend=function(n,i,d,l,r){if(1==n){var o=e.WeChatownersocialNumber[e.socialaccountId]+","+i,c="";e.frienfList=e.Chatwithfriends[e.lplplpl];for(var p=0,h=0,g="",m=0,u=0,f=0,v="",w=!1,y=!1,b="",C=0,k=0,I=0;I<e.Chatwithfriends[-1].length;I++)e.Chatwithfriends[-1][I].cid==o&&(p=I,g=e.Chatwithfriends[-1][I],w=!0,b=e.Chatwithfriends[-1][I].socialaccountId),1==e.Chatwithfriends[-1][I].topNumber&&h++;for(I=0;I<e.Chatwithfriends[e.lplplpl].length;I++)e.Chatwithfriends[e.lplplpl][I].cid==o&&(I,e.Chatwithfriends[e.lplplpl][I],b=e.Chatwithfriends[e.lplplpl][I].socialaccountId,y=!0,C=e.Chatwithfriends[-1][I].topNumber),1==e.Chatwithfriends[e.lplplpl][I].topNumber&&m++;if(""==b){var T=new FormData;T.append("Cid",o),T.append("accountId",e.myaccountId),t({method:"POST",url:e.link+"/latelychat/getContactByNumber",data:T,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(n){if(200==n.code){var i="";n.data.contactList.length>1?(n.data.contactList[1].profilePhoto=e.imgSrc+n.data.contactList[1].profilePhoto,b=n.data.contactList[1].socialaccountId,i=n.data.contactList[1],c=n.data.contactList[1].id):(n.data.contactList[0].profilePhoto=e.imgSrc+n.data.contactList[0].profilePhoto,b=n.data.contactList[0].socialaccountId,c=n.data.contactList[0].id,i=n.data.contactList[0]);for(var d=0;d<e.Chatwithfriends[b].length;d++)e.Chatwithfriends[b][d].cid==o&&(u=d,v=e.Chatwithfriends[b][d]),1==e.Chatwithfriends[b][d].topNumber&&f++;e.Chatwithfriends[b].splice(f,0,i),e.Chatwithfriends[-1].splice(h,0,i),a.$watch(function(){e.frienfList=e.Chatwithfriends[e.lplplpl]}),a.MyFrienddata=new FormData,a.MyFrienddata.append("socialaccountId",e.socialaccountId),a.MyFrienddata.append("contactId",c),t({method:"POST",url:e.link+"/contact/getContactById",data:a.MyFrienddata,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(n){if(200==n.code){$(".page1-Maindiv2-myfriends-search-con-ul1 li").find('span[data^="'+o+'"]').parent().addClass("click-background-color").siblings().removeClass("click-background-color"),$(".page1-Maindiv2-myfriends-search-con-ul1").find(".page1-Maindiv2-myfriends-search-con-ul-tagname1").html(""),$(".page1-Maindiv2-myfriends-search-con-ul1").find(".new-msg-number").css("display","none").html("");var i=e.Chatwithfriends[e.lplplpl].length;i>50&&(i=50);for(var d=0;d<i;d++){var l=e.Chatwithfriends[e.lplplpl][d].cid;if(""!=e.Chatwithfriends[e.lplplpl][d].newMessage&&$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.Chatwithfriends[e.lplplpl][d].cid+'"]').html(e.Chatwithfriends[e.lplplpl][d].newMessage),e.friendStorage.hasOwnProperty(l)){var r=e.friendStorage[l].split("Unread").length-1;r>0?$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+l+'"]').next().css("display","inline-block").html(r):$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+l+'"]').next().css("display","none").html("")}else $(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+l+'"]').next().css("display","none").html("")}$(".page1-Maindiv2-listInit").css("display","none"),a.page1Maindiv4Init=!1,a.Customerinformation=!0,a.quickReply=!1,a.customerRecord=!1,a.page1Maindiv4Init=!1,a.Customerinformation=!0,a.quickReply=!1,a.customerRecord=!1,a.chatGroupOrFriend=0,a.allCustomerList=!1,a.myself=!0,a.myself1=!1,a.chatName=n.data.nickName,e.chatId=n.data.cid,e.chatHead=e.WeChatownerHeader[n.data.socialaccountId],e.Id=n.data.id,e.socialaccountId=n.data.socialaccountId,e.type=0,e.Topjudge=n.data.topNumber,1==e.Topjudge?($(".chat-top-totop").css("background",'url("./images/Canceltop.png") center no-repeat'),$(".chat-top-totop").attr("data",1)):($(".chat-top-totop").css("background",'url("./images/toTop.png") center no-repeat'),$(".chat-top-totop").attr("data",0)),a.MyFrienddata1=n.data,$(".change-name").html(e.GetridoftheNbsp(n.data.noteName)),e.NameRecord=n.data.noteName,$(".change-phone").val(n.data.phone),$(".whiteMeContent").val(n.data.description);var c=n.data.tags;a.FriendTags=c.split(","),a.GroupId=n.data.groupId,$(".chzn-results li").css("display","block"),t({method:"POST",url:e.link+"/groups/getGroups",data:a.MyFrienddata,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){200==e.code&&(a.InformationGrouping=e.data.groupList,setTimeout(function(){$(".first-select").find("option[value="+a.GroupId+"]").attr("selected",!0)},10))}),a.page1Maindiv4Init=!1;var p=!1;for(d=0;d<e.Judgingthesendingmessage.length;d++)if(e.socialaccountId==e.Judgingthesendingmessage[d]){p=!0;break}if(1==p?($(".Chat-layer").css("display","block"),$(".Chat-layer-say").css("display","block")):($(".Chat-layer").css("display","none"),$(".Chat-layer-say").css("display","none")),$(".page1-Maindiv3").css("background","none"),$(".newsList").html(""),$(".chat-top-title").html(a.chatName),a.ChatModule=!0,$(".forPhone-content").find('span[class^="blue"]').html(e.WeChatowner[e.socialaccountId]),e.friendStorage.hasOwnProperty(e.chatId)){var h=e.friendStorage[e.chatId],g=h.match(/\[[^\]]+\]/g);if(null==g||0==g||null==g){h=h.replace(/<br>/g,"").replace(/undefined/g,"")}else{for(var m=[],u=[],f=0;f<g.length;f++)for(var v=0;v<s.length;v++)g[f]==s[v]&&(m.push('<img class="emoji_icon" src="images/qq/'+(v+1)+'.gif">'),u.push(s[v]));for(var w=0;w<m.length;w++)h=h.replace(u[w],m[w]);h=h.replace(/<br>/g,"").replace(/undefined/g,"")}$(".newsList").html(h)}else $(".newsList").html("");setTimeout(function(){if(1==e.Topjudge?$(".wechatList").animate({scrollTop:0},100):$(".wechatList").animate({scrollTop:74*$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.chatId+'"]').parent().attr("data-index")+9},100),null==e.friendStorage[e.chatId]||null==e.friendStorage[e.chatId]?$(".ChatRecord").html("---------------- 更多消息请查看聊天记录 ----------------").css("cursor","default"):e.friendStorage[e.chatId].indexOf("initNone")>=0?$(".ChatRecord").html("-------------------- 查看更多消息 --------------------").css("cursor","pointer"):$(".ChatRecord").html("---------------- 更多消息请查看聊天记录 ----------------").css("cursor","default"),$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.chatId+'"]').next().css("display","none"),""==e.friendStorage[e.chatId]||null==e.friendStorage[e.chatId]);else{var a=e.friendStorage[e.chatId].replace(/Unread/g,"Read");e.friendStorage[e.chatId]=a}var t=$(".RightCont")[0].scrollHeight;$(".RightCont").animate({scrollTop:t},500)},50)}})}})}else{for(I=0;I<e.Chatwithfriends[b].length;I++)e.Chatwithfriends[b][I].cid==o&&(u=I,v=e.Chatwithfriends[b][I],k=e.Chatwithfriends[b][I].topNumber),1==e.Chatwithfriends[b][I].topNumber&&f++;1==w&&1==y?(c=v.id,1==C?(e.Chatwithfriends[-1].splice(p,1),e.Chatwithfriends[-1].splice(0,0,g),e.Chatwithfriends[b].splice(u,1),e.Chatwithfriends[b].splice(0,0,v)):(e.Chatwithfriends[-1].splice(p,1),e.Chatwithfriends[-1].splice(h,0,g),e.Chatwithfriends[b].splice(u,1),e.Chatwithfriends[b].splice(f,0,v))):1==w&&0==y&&-1!=e.lplplpl?(c=g.id,1==C?(e.Chatwithfriends[-1].splice(p,1),e.Chatwithfriends[-1].splice(0,0,g),e.Chatwithfriends[e.lplplpl].splice(0,0,g)):(e.Chatwithfriends[-1].splice(p,1),e.Chatwithfriends[-1].splice(h,0,g),e.Chatwithfriends[e.lplplpl].splice(m,0,g))):1==w&&0==y&&-1==e.lplplpl?(c=g.id,1==C?(e.Chatwithfriends[-1].splice(p,1),e.Chatwithfriends[-1].splice(0,0,g),e.Chatwithfriends[b].splice(0,0,g)):(e.Chatwithfriends[-1].splice(p,1),e.Chatwithfriends[-1].splice(h,0,g),e.Chatwithfriends[b].splice(m,0,g))):0==w&&1==y&&-1==e.lplplpl?(c=v.id,1==k?(e.Chatwithfriends[-1].splice(0,0,v),e.Chatwithfriends[b].splice(u,1),e.Chatwithfriends[b].splice(0,0,v)):(e.Chatwithfriends[-1].splice(h,0,v),e.Chatwithfriends[b].splice(u,1),e.Chatwithfriends[b].splice(f,0,v))):0==w&&1==y&&-1!=e.lplplpl&&(c=v.id,1==k?(e.Chatwithfriends[-1].splice(0,0,v),e.Chatwithfriends[e.lplplpl].splice(u,1),e.Chatwithfriends[e.lplplpl].splice(0,0,v)):(e.Chatwithfriends[-1].splice(h,0,v),e.Chatwithfriends[e.lplplpl].splice(u,1),e.Chatwithfriends[e.lplplpl].splice(f,0,v))),a.$watch(function(){e.frienfList=e.Chatwithfriends[e.lplplpl]}),a.MyFrienddata=new FormData,a.MyFrienddata.append("socialaccountId",e.socialaccountId),a.MyFrienddata.append("contactId",c),t({method:"POST",url:e.link+"/contact/getContactById",data:a.MyFrienddata,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(n){if(200==n.code){$(".page1-Maindiv2-myfriends-search-con-ul1 li").find('span[data^="'+o+'"]').parent().addClass("click-background-color").siblings().removeClass("click-background-color"),$(".page1-Maindiv2-myfriends-search-con-ul1").find(".page1-Maindiv2-myfriends-search-con-ul-tagname1").html(""),$(".page1-Maindiv2-myfriends-search-con-ul1").find(".new-msg-number").css("display","none").html("");var i=e.Chatwithfriends[e.lplplpl].length;i>50&&(i=50);for(var d=0;d<i;d++){var l=e.Chatwithfriends[e.lplplpl][d].cid;if(""!=e.Chatwithfriends[e.lplplpl][d].newMessage&&$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.Chatwithfriends[e.lplplpl][d].cid+'"]').html(e.Chatwithfriends[e.lplplpl][d].newMessage),e.friendStorage.hasOwnProperty(l)){var r=e.friendStorage[l].split("Unread").length-1;r>0?$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+l+'"]').next().css("display","inline-block").html(r):$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+l+'"]').next().css("display","none").html("")}else $(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+l+'"]').next().css("display","none").html("")}$(".page1-Maindiv2-listInit").css("display","none"),a.page1Maindiv4Init=!1,a.Customerinformation=!0,a.quickReply=!1,a.customerRecord=!1,a.page1Maindiv4Init=!1,a.Customerinformation=!0,a.quickReply=!1,a.customerRecord=!1,a.chatGroupOrFriend=0,a.allCustomerList=!1,a.myself=!0,a.myself1=!1,a.chatName=n.data.nickName,e.chatId=n.data.cid,e.chatHead=e.WeChatownerHeader[n.data.socialaccountId],e.Id=n.data.id,e.socialaccountId=n.data.socialaccountId,e.type=0,e.Topjudge=n.data.topNumber,a.MyFrienddata1=n.data,1==e.Topjudge?($(".chat-top-totop").css("background",'url("./images/Canceltop.png") center no-repeat'),$(".chat-top-totop").attr("data",1)):($(".chat-top-totop").css("background",'url("./images/toTop.png") center no-repeat'),$(".chat-top-totop").attr("data",0)),$(".change-name").html(e.GetridoftheNbsp(n.data.noteName)),e.NameRecord=n.data.noteName,$(".change-phone").val(n.data.phone),$(".whiteMeContent").val(n.data.description);var c=n.data.tags;a.FriendTags=c.split(","),a.GroupId=n.data.groupId,$(".chzn-results li").css("display","block"),t({method:"POST",url:e.link+"/groups/getGroups",data:a.MyFrienddata,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){200==e.code&&(a.InformationGrouping=e.data.groupList,setTimeout(function(){$(".first-select").find("option[value="+a.GroupId+"]").attr("selected",!0)},10))}),a.page1Maindiv4Init=!1;var p=!1;for(d=0;d<e.Judgingthesendingmessage.length;d++)if(e.socialaccountId==e.Judgingthesendingmessage[d]){p=!0;break}if(1==p?($(".Chat-layer").css("display","block"),$(".Chat-layer-say").css("display","block")):($(".Chat-layer").css("display","none"),$(".Chat-layer-say").css("display","none")),$(".page1-Maindiv3").css("background","none"),$(".newsList").html(""),$(".chat-top-title").html(a.chatName),a.ChatModule=!0,$(".forPhone-content").find('span[class^="blue"]').html(e.WeChatowner[e.socialaccountId]),e.friendStorage.hasOwnProperty(e.chatId)){var h=e.friendStorage[e.chatId],g=h.match(/\[[^\]]+\]/g);if(null==g||0==g||null==g){h=h.replace(/<br>/g,"").replace(/undefined/g,"")}else{for(var m=[],u=[],f=0;f<g.length;f++)for(var v=0;v<s.length;v++)g[f]==s[v]&&(m.push('<img class="emoji_icon" src="images/qq/'+(v+1)+'.gif">'),u.push(s[v]));for(var w=0;w<m.length;w++)h=h.replace(u[w],m[w]);h=h.replace(/<br>/g,"").replace(/undefined/g,"")}$(".newsList").html(h)}else $(".newsList").html("");setTimeout(function(){if(1==e.Topjudge?$(".wechatList").animate({scrollTop:0},100):$(".wechatList").animate({scrollTop:74*$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.chatId+'"]').parent().attr("data-index")+9},100),$(".Newmessagereminding").css("display","none"),null==e.friendStorage[e.chatId]||null==e.friendStorage[e.chatId]?$(".ChatRecord").html("---------------- 更多消息请查看聊天记录 ----------------").css("cursor","default"):e.friendStorage[e.chatId].indexOf("initNone")>=0?$(".ChatRecord").html("-------------------- 查看更多消息 --------------------").css("cursor","pointer"):$(".ChatRecord").html("---------------- 更多消息请查看聊天记录 ----------------").css("cursor","default"),$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.chatId+'"]').next().css("display","none"),""==e.friendStorage[e.chatId]||null==e.friendStorage[e.chatId]);else{var a=e.friendStorage[e.chatId].replace(/Unread/g,"Read");e.friendStorage[e.chatId]=a}var t=$(".RightCont")[0].scrollHeight;$(".RightCont").animate({scrollTop:t},500)},50)}})}}else{var M=new FormData;M.append("greeting",""),M.append("chatroomid",r),M.append("accountname",e.localUserName),M.append("chatroommemberwxid ",i),M.append("socialaccountid ",e.socialaccountId),t({method:"POST",url:e.link+"/message/addChatroommemberFriend",data:M,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){200==e.code&&$(l.target).css({cursor:"not-allowed"})})}},e.close_help_say=function(e){$(".gray-help").css("display","none"),$(".gray-help-say").css("display","none"),$(".gray-help-say-con-text").html(""),"重连"==$(e.target).html()?($(e.target).html("确定"),window.location.reload()):$(e.target).html("确定")},e.NotificationsChat=function(n,i,d,l,r,o,c){$(".personaldata-data-con-myself-1-input").attr("disabled","disabled").css("border","1px solid transparent"),$(".personaldata-data-con-myself-3-select").css("display","none"),$(".personaldata-data-con-myself-3-span").css("display","inline-block"),$(".personaldata-data-con-myself-5-textarea-whiteMeContent").attr("disabled","disabled").css("border","1px solid  transparent"),$(".edit-personaldata").html("修改资料").attr("data",0),$(".personaldata").css("display","none"),$(".chat-bottom-write").html("");var p=!1;$(".all-customer-search-logo-input").val("");for(var h=0;h<e.Judgingthesendingmessage.length;h++)if(r==e.Judgingthesendingmessage[h]){p=!0;break}$(".Newmessagereminding").css("display","none"),e.unreadMessages=0,1==p?($(".Chat-layer").css("display","block"),$(".Chat-layer-say").css("display","block")):($(".Chat-layer").css("display","none"),$(".Chat-layer-say").css("display","none")),$(".page1-div3-title-span1").css({color:"rgb(68, 186, 246)","border-bottom":"2px solid rgb(68, 186, 246)"}),$(".page1-div3-title-span2").css({color:"#444444",border:"none"}),$(".page1-div3-title-span3").css({color:"#444444",border:"none"}),$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]'),0==$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').attr("distinguish")?$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').addClass("click-background-color").siblings().removeClass("click-background-color"):$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').parent().addClass("click-background-color").siblings().removeClass("click-background-color"),$(".page1-Maindiv2-listInit").css("display","none"),1==c?($(".chat-top-totop").css("background",'url("./images/Canceltop.png") center no-repeat'),$(".chat-top-totop").attr("data",1)):($(".chat-top-totop").css("background",'url("./images/toTop.png") center no-repeat'),$(".chat-top-totop").attr("data",0)),a.page1Maindiv4Init=!1,a.Customerinformation=!0,a.quickReply=!1,a.customerRecord=!1,a.page1Maindiv4Init=!1,a.Customerinformation=!0,a.quickReply=!1,a.customerRecord=!1,1==o?(a.chatGroupOrFriend=1,a.myself1=!0,a.allCustomerList=!1,a.myself=!1,a.groupdata=new FormData,a.groupdata.append("socialaccountId",r),a.groupdata.append("chatroomId",l),t({method:"POST",url:e.link+"/contact/getChatroomById",data:a.groupdata,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(n){var i=n.data.tags;a.FriendTags=i.split(","),a.Mygroupdata=n.data,a.GroupId=n.data.groupId,$(".whiteMeContent").val(n.data.chatroomDescription),$(".chzn-results li").css("display","block"),t({method:"POST",url:e.link+"/groups/getGroups",data:a.MyFrienddata,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){a.InformationGrouping=e.data.groupList,setTimeout(function(){0==a.GroupId?($(".four-select option").removeAttr("selected"),$(".four-select option[value=0]").attr("selected",!0)):($(".four-select option").removeAttr("selected"),$(".four-select option[value="+a.GroupId+"]").attr("selected",!0))},50)})})):(a.chatGroupOrFriend=0,a.allCustomerList=!1,a.myself=!0,a.myself1=!1,a.MyFrienddata=new FormData,a.MyFrienddata.append("socialaccountId",r),a.MyFrienddata.append("contactId",l),t({method:"POST",url:e.link+"/contact/getContactById",data:a.MyFrienddata,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(n){a.MyFrienddata1=n.data,$(".change-name").html(e.GetridoftheNbsp(n.data.noteName)),e.NameRecord=n.data.noteName,$(".change-phone").val(n.data.phone),$(".whiteMeContent").val(n.data.description);var i=n.data.tags;a.FriendTags=i.split(","),a.GroupId=n.data.groupId;var s=n.data.groupId;$(".chzn-results li").css("display","block"),t({method:"POST",url:e.link+"/groups/getGroups",data:a.MyFrienddata,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){a.InformationGrouping=e.data.groupList,setTimeout(function(){0==a.GroupId?($(".first-select option").removeAttr("selected"),$(".first-select option[value=0]").attr("selected",!0)):($(".first-select option").removeAttr("selected"),$(".first-select option[value="+s+"]").attr("selected",!0))},50)})})),a.chatName=i,e.chatId=n,e.chatHead=e.WeChatownerHeader[r],e.Id=l,e.socialaccountId=r,e.type=o,e.Topjudge=c,a.page1Maindiv4Init=!1,$(".page1-Maindiv3").attr("data",n).css("background","none"),$(".newsList").html(""),$(".chat-top-title").html(i),a.ChatModule=!0,$(".forPhone-content").find('span[class^="blue"]').html(e.WeChatowner[e.socialaccountId]);var g=e.friendStorage[e.chatId];if(null==g||null==g);else{var m=g.match(/\[[^\]]+\]/g);if(null==m||0==m||null==m){g=g.replace(/<br>/g,"").replace(/undefined/g,"")}else{for(var u=[],f=[],v=0;v<m.length;v++)for(var w=0;w<s.length;w++)m[v]==s[w]&&(u.push('<img class="emoji_icon" src="images/qq/'+(w+1)+'.gif">'),f.push(s[w]));for(var y=0;y<u.length;y++)g=g.replace(f[y],u[y]);g=g.replace(/<br>/g,"").replace(/undefined/g,"")}}$(".newsList").html(g),setTimeout(function(){if(e.friendStorage[n].indexOf("initNone")>=0?$(".ChatRecord").html("-------------------- 查看更多消息 --------------------").css("cursor","pointer"):$(".ChatRecord").html("---------------- 更多消息请查看聊天记录 ----------------").css("cursor","default"),$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+n+'"]').next().css("display","none"),""==e.friendStorage[n]||null==e.friendStorage[n]);else{var a=e.friendStorage[n].replace(/Unread/g,"Read");e.friendStorage[n]=a}1==e.Topjudge?$(".wechatList").animate({scrollTop:0},100):$(".wechatList").animate({scrollTop:74*$(".page1-Maindiv2-myfriends-search-con-ul1").find('span[data^="'+e.chatId+'"]').parent().attr("data-index")+9},0);var t=$(".RightCont")[0].scrollHeight;$(".RightCont").animate({scrollTop:t},400)},50)},a.closeGraphiclink=function(){$(".Graphic-link-edit-html-footer-yes").attr("data",0),$(".placeholder_color").val(""),$(".Addmodifiedkeywords-body-three-upImg-input1").val(""),$(".Graphic-link-edit-html").css("display","none"),$(".Mongolialayer").css("display","none")},a.openGraphiclink=function(){e.upFile6="",$(".Graphic-link-edit-html").css("display","block"),$(".Mongolialayer").css("display","block"),$(".Graphic-link-edit-html-footer-yes").attr("data",0)},a.clean_Graphic_link_photo=function(){$(".Addmodifiedkeywords-body-three-upImg-input1").val(""),e.AllGraphiclink="",e.upFile6="",$(".Graphic-link-edit-html-con-con-div-4-part").css({background:'url("../images/upload-bg.png")center no-repeat',"background-size":"100% 100%"})},a.sureGraphiclink=function(){if(0==$(".Graphic-link-edit-html-footer-yes").attr("data")){var n=$(".Graphic-link_input1").val(),i=$(".Graphic-link_input2").val(),s=$(".Graphic-link_input3").val();if(""==n||null==n||null==n)$(".Graphic-link-tishi").css("display","block").html("图文链接标题为必填项请输入标题");else if(""==i||null==i||null==i||i.length<5)$(".Graphic-link-tishi").css("display","block").html("图文链接描述为必填项请输入正确描述（至少输入五个字符）");else if(""==s||null==s||null==s)$(".Graphic-link-tishi").css("display","block").html("链接为必填项请输入链接");else if(""==e.upFile6||null==e.upFile6||null==e.upFile6)$(".Graphic-link-tishi").css("display","block").html("图文链接图片为必填项请上传图片");else(d=new FormData).append("title",n),d.append("content",i),d.append("url",s),d.append("file",e.upFile6),t({method:"POST",url:e.link+"/imgandlink/addImgAndLink",data:d,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){200==a.code?(e.upFile6,$(".Graphic-link-tishi").css("display","none"),$(".Addmodifiedkeywords-body-three-upImg-input1").val(""),$(".Graphic-link-edit-html-con-con-div-4-part").css({background:'url("../images/upload-bg.png")center no-repeat',"background-size":"100% 100%"}),$(".placeholder_color").val(""),$(".Graphic-link-edit-html").css("display","none"),$(".Mongolialayer").css("display","none"),e.AllGraphiclink="",t({method:"POST",url:e.link+"/imgandlink/queryAllImgAndLink",data:"",headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){200==a.code?e.AllGraphiclink=a.data.imgAndLinkList:e.AllGraphiclink=""})):1001==a.code?$(".Graphic-link-tishi").css("display","block").html("图片大小<=10M"):1003==a.code?$(".Graphic-link-tishi").css("display","block").html("图片宽高比例应为1:1"):1004==a.code&&$(".Graphic-link-tishi").css("display","block").html("当前链接已存在")})}else{var d;n=$(".Graphic-link_input1").val(),i=$(".Graphic-link_input2").val(),s=$(".Graphic-link_input3").val();if(""==n||null==n||null==n)$(".Graphic-link-tishi").css("display","block").html("图文链接标题为必填项请输入标题");else if(""==i||null==i||null==i||i.length<5)$(".Graphic-link-tishi").css("display","block").html("图文链接描述为必填项请输入正确描述（至少输入五个字符）");else if(""==s||null==s||null==s)$(".Graphic-link-tishi").css("display","block").html("链接为必填项请输入链接");else if(""==e.upFile6||null==e.upFile6||null==e.upFile6)$(".Graphic-link-tishi").css("display","block").html("图文链接图片为必填项请上传图片");else(d=new FormData).append("id",a.Graphic_link_id),d.append("title",n),d.append("content",i),d.append("url",s),"Ishave"==e.upFile6?d.append("file",""):d.append("file",e.upFile6),t({method:"POST",url:e.link+"/imgandlink/updateImgAndLink",data:d,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){200==a.code?($(".Graphic-link-edit-html-footer-yes").attr("data",0),e.upFile6="",$(".Graphic-link-tishi").css("display","none"),$(".Addmodifiedkeywords-body-three-upImg-input1").val(""),$(".Graphic-link-edit-html-con-con-div-4-part").css({background:'url("../images/upload-bg.png")center no-repeat',"background-size":"100% 100%"}),$(".placeholder_color").val(""),$(".Graphic-link-edit-html").css("display","none"),$(".Mongolialayer").css("display","none"),e.AllGraphiclink="",t({method:"POST",url:e.link+"/imgandlink/queryAllImgAndLink",data:"",headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){200==a.code?e.AllGraphiclink=a.data.imgAndLinkList:e.AllGraphiclink=""})):1001==a.code?$(".Graphic-link-tishi").css("display","block").html("图片大小<=10M"):1003==a.code?$(".Graphic-link-tishi").css("display","block").html("图片宽高比例应为1:1"):1004==a.code&&$(".Graphic-link-tishi").css("display","block").html("当前链接已存在")})}},a.delGraphiclink=function(a){var n=new FormData;n.append("id",a),t({method:"POST",url:e.link+"/imgandlink/deleteImgAndLink",data:n,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){200==a.code&&(e.AllGraphiclink="",t({method:"POST",url:e.link+"/imgandlink/queryAllImgAndLink",data:"",headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){200==a.code?e.AllGraphiclink=a.data.imgAndLinkList:e.AllGraphiclink=""}))})},a.Graphic_link_id="",a.editGraphiclink=function(t,n,i,s,d){a.Graphic_link_id=t,$(".Graphic-link-edit-html").css("display","block"),$(".Mongolialayer").css("display","block"),$(".Graphic-link_input1").val(n),$(".Graphic-link_input2").val(i),$(".Graphic-link_input3").val(d),$(".Graphic-link-edit-html-con-con-div-4-part").css({background:"url("+s+")center no-repeat","background-size":"100% 100%"}),$(".Graphic-link-edit-html-footer-yes").attr("data",1),e.upFile6="Ishave"},a.Delete_and_exit=function(n){var i=new FormData;i.append("id",e.impPhoId),i.append("type",n),t({method:"POST",url:e.link+"/contact/delContactAndChatroom",data:i,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(t){if(200==t.code){$(".page1-Maindiv7").css("background",'url("../images/phonegroup.png") center no-repeat'),a.Addressbook=!1;for(var n=0,i=0,s=0;s<e.searchReturnList.length;s++)for(var d=0;d<e.searchReturnList[s][1].length;d++)if(e.searchReturnList[s][1][d].cid==e.impPhoCid){n=s,i=d;break}e.searchReturnList[n][1].splice(i,1)}})},a.AutoGroupMsg=!0,a.AutomaticSwich_GroupMsg=function(n){var i=!1,s=new FormData;s.append("accountName",e.localUserName),1==$(n.target).attr("data")?(s.append("isOpen",!1),i=!1):(s.append("isOpen",!0),i=!0),t({method:"POST",url:e.link1+"/message/receiveChatroomMsg",data:s,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){200==e.code?0==i?(a.AutoGroupMsg=!1,$(n.target).css({background:'url("./images/off-1.png") center no-repeat'}),$(n.target).attr("data",0),$(".SettingInterface-body-first-table-Explain1_tishi").css("display","none")):(a.AutoGroupMsg=!0,$(n.target).css({background:'url("./images/open-1.png") center no-repeat'}),$(n.target).attr("data",1),$(".SettingInterface-body-first-table-Explain1_tishi").css("display","none")):0==i?($(".SettingInterface-body-first-table-Explain1_tishi").css("display","block").html("关闭接收群聊消息失败，请稍后再试"),setTimeout(function(){$(".SettingInterface-body-first-table-Explain1_tishi").css("display","none")},1500)):($(".SettingInterface-body-first-table-Explain1_tishi").css("display","block").html("开启接收群聊消息失败，请稍后再试"),setTimeout(function(){$(".SettingInterface-body-first-table-Explain1_tishi").css("display","none")},1500))})},a.$on("ngRepeatFinished",function(e){var t="",n="",i="",s="",d="";$(".moveFriendList").contextMenu({width:110,itemHeight:30,bgColor:"#FFFFFF",color:"#000000",fontSize:12,hoverBgColor:"#DADADA",target:function(e){$(".ul-context-menu1").remove(),t=e.find('span[class^="page1-Maindiv2-myfriends-search-con-ul-tagname1"]').attr("data1"),e.attr("data-id"),n=e.find('span[class^="page1-Maindiv2-myfriends-search-con-ul-tagname1"]').attr("data2"),i=e.find('span[class^="page1-Maindiv2-myfriends-search-con-ul-tagname1"]').attr("data3"),s=e.find('span[class^="page1-Maindiv2-myfriends-search-con-ul-tagname1"]').attr("data4"),d=e.find('span[class^="page1-Maindiv2-myfriends-search-con-ul-tagname1"]').attr("data5"),1==t?$(".changeName0").html("取消置顶"):$(".changeName0").html("置顶")},menu:[{text:"置顶",icon:"img/add.png",callback:function(){a.chatFriendToTop(t,n,i,s)}},{text:"删除聊天",icon:"img/del.png",callback:function(){a.Delete_the_chatting(d,s,t)}}]})}),a.Delete_the_chatting=function(t,n,i){for(var s=0,d=0,l=!1,r=0;r<e.Chatwithfriends[-1].length;r++)if(e.Chatwithfriends[-1][r].cid==n){s=r,l=!0;break}1==l&&e.Chatwithfriends[-1].splice(s,1);for(var o=0;o<e.Chatwithfriends[t].length;o++)if(e.Chatwithfriends[t][o].cid==n){d=o;break}e.Chatwithfriends[t].splice(d,1),e.frienfList=e.Chatwithfriends[e.lplplpl],1===i&&(e.TotopNum=e.TotopNum-1),n===e.chatId&&a.CloseChatModule()};var I="";$(document).on("click",".up-file-Down",function(){if("false"==$(this).attr("isNew")){var a=e.WeChatownersocialNumber[e.socialaccountId];if(""==$(this).attr("file_path")){$(this).html("下载中");var n=$(this);I=$(this).attr("file_title"),(s=new FormData).append("accountName",e.localUserName),s.append("msgId",$(this).attr("file_id")),s.append("socialnumber",a),"false"==$(this).attr("isme")?s.append("flag",1):s.append("flag",0),t({method:"POST",url:e.link1+"/message/getFileByMsgId",data:s,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){200==e.code&&(""==e.data.imagePath?(n.html("点击重试"),n.addClass("errorColor")):download(e.data.imagePath,I,"text/plain"))})}else{I=$(this).attr("file_title");var i=$(this).attr("file_path");download(i,I,"text/plain")}}else{var s;n=$(this);I=$(this).attr("file_title"),(s=new FormData).append("accountName",e.localUserName),s.append("msgId",$(this).attr("file_id")),s.append("socialnumber",$(this).attr("file_number")),"false"==$(this).attr("isme")?s.append("flag",1):s.append("flag",0),t({method:"POST",url:e.link1+"/message/getFileByMsgId",data:s,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){200==e.code&&(""==e.data.imagePath?(n.html("点击重试"),n.addClass("errorColor")):(download(e.data.tempData,I,"text/plain"),n.html("下载"),n.removeClass("errorColor")))})}})}]),app.directive("renderingCompletion",["$timeout",function(e){return{restrict:"A",link:function(a,t,n){!0===a.$last&&e(function(){a.$emit("ngRepeatFinished")})}}}]),app.directive("uploadFile",function(){return{link:function(e,a){a.on("change",function(){e.upFile=this.files[0]})}}}),app.directive("uploadFile1",["$rootScope","$http",function(e,a){return{link:function(t,n,i,s){n.on("change",function(){console.log(this.files[0]);var i=new FormData;i.append("file",this.files[0]),a({method:"POST",url:e.link+"/picture/addPicture",data:i,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(i){if(200==i.code&&(n.val(""),200==i.code)){var s=new FormData;a({method:"POST",url:e.link+"/picture/getAllPicture",data:s,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){200==e.code&&(t.Picturelibrary=e.data.pictureList)})}})})}}}]),app.directive("uploadFile2",["$rootScope","$http",function(e,a){return{link:function(t,n,i,s){n.on("change",function(){var n=new FormData;n.append("file",this.files[0]),this.value="",a({method:"POST",url:e.link+"/script/uploading",data:n,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(n){var i=new FormData;a({method:"POST",url:e.link+"/script/getTwoScript",data:i,headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e){200==e.code&&(t.AllShortcutphrase=e.data,t.$watch("$viewContentLoaded",function(){$(".tree").treemenu({delay:300}).openActive()}))})})})}}}]),app.directive("uploadImage3",["$rootScope",function(e){return{link:function(a,t){t.on("change",function(){var t=this.files[0];if(!/image\/\w+/.test(t.type))return alert("文件必须为图片！"),!1;e.pic1=t;var n=function(e){var a=null;null!=window.createObjectURL?a=window.createObjectURL(e):null!=window.URL?a=window.URL.createObjectURL(e):null!=window.webkitURL&&(a=window.webkitURL.createObjectURL(e));return a}(this.files[0]);n&&($(".last-Img").attr("src",n),a.$apply())})}}}]),app.directive("uploadFile4",function(){return{link:function(e,a){a.on("change",function(){e.upFile1=this.files[0],e.upFile1.name.length>=6?$(".exselTextGra1").html(e.upFile1.name.slice(0,6)+"..."):$(".exselTextGra1").html(e.upFile1.name),$(".exselTextGray1").html((e.upFile1.size/1024).toFixed(2)+"kb"),$(".Importphrase-con-second-donwload-null").css("display","none").html(" 请上传文件")})}}}),app.directive("uploadFile5",["$rootScope",function(e){return{link:function(e,a){a.on("change",function(){e.upFile2=this.files[0]})}}}]),app.directive("uploadFile6",["$rootScope",function(e){return{link:function(a,t){t.on("change",function(){e.upFile6=this.files[0];var t,n,i=(t=this.files[0],n=null,null!=window.createObjectURL?n=window.createObjectURL(t):null!=window.URL?n=window.URL.createObjectURL(t):null!=window.webkitURL&&(n=window.webkitURL.createObjectURL(t)),n);i&&($(".Graphic-link-edit-html-con-con-div-4-part").css("background","url("+i+")center no-repeat"),a.$apply())})}}}]);